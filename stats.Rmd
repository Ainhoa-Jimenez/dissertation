---
title: "stats"
author: "Ainhoa"
date: "2024-03-06"
output: html_document
editor_options: 
  chunk_output_type: console
---

**WARNING: FIRST. RUN UNTIL 5.2 OF Code_calc_yield.Rmd OTHERWISE IT WON'T. WORK**

# 9. Run descriptive statistics

## 9.1. Austroplaca (X3)

### 1. Create columns for activity

```{r}
data_clean <- data_clean %>% 
  mutate(X3.Active = if_else(X3.chosen_yield > 0, TRUE, FALSE))  # If the yield is above 0 the plant is active = TRUE

data_clean_23 <- data_clean_23 %>% 
  mutate(X3.Active = if_else(X3.chosen_yield > 0, TRUE, FALSE)) 

summer_19_20 <- summer_19_20 %>% 
  mutate(X3.Active = if_else(X3.Y > 0, TRUE, FALSE)) 

summer_20_21 <- summer_20_21 %>% 
  mutate(X3.Active = if_else(X3.chosen_yield > 0, TRUE, FALSE)) 

summer_21_22 <- summer_21_22 %>% 
  mutate(X3.Active = if_else(X3.Y > 0, TRUE, FALSE)) 

summer_22_23 <- summer_22_23 %>% 
  mutate(X3.Active = if_else(X3.chosen_yield > 0, TRUE, FALSE)) 
```

### 2. Active time

```{r}
# Active total time

total_activetime_stats_X3 <- bind_rows(  # put both counts into one dataset
  data_clean %>% count(Condition = X3.chosen_yield > 0, name = "Count_data_clean"),  # Count rows with active time (1 row = 1 hour)
  data_clean_23 %>% count(Condition = X3.chosen_yield > 0, name = "Count_data_clean_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum) %>%  # join rows that have the same condition (True or False)
mutate(Total_time = Count_data_clean + Count_data_clean_23) # add both columns to get the total active time of the year
  
(total_active_hours_X3 <- total_activetime_stats_X3 %>% # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Total_time))

(Percentage_active_hours_X3 <- total_active_hours_X3/(nrow(data_clean) + nrow(data_clean_23)) * 100) # calculate the percentage 
```

```{r}
# Active time each summer

summer_activetime_stats_X3 <-bind_rows(
  summer_19_20 %>% count(Condition = X3.Y > 0, name = "Count_19_20"), # Count rows in summer 20_21 with active time (1 row = 1 hour) // no chosen yield  becaue didn't make any ajustments
  summer_20_21 %>% count(Condition = X3.chosen_yield > 0, name = "Count_20_21"), # Chosen yield because made ajustments
summer_21_22 %>% count(Condition = X3.Y > 0, name = "Count_21_22"),
summer_22_23 %>% count(Condition = X3.chosen_yield > 0, name = "Count_22_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum)  # join rows that have the same condition (True or False)

(total_active_hours_19_20_X3 <- summer_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20))

(total_active_hours_20_21_X3 <- summer_activetime_stats_X3 %>%
  filter(Condition == TRUE) %>%
  select(Count_20_21))

(total_active_hours_21_22_X3 <- summer_activetime_stats_X3 %>%
  filter(Condition == TRUE) %>%
  select(Count_21_22))

(total_active_hours_22_23_X3 <- summer_activetime_stats_X3 %>%
  filter(Condition == TRUE) %>%
  select(Count_22_23))

(Percentage_active_hours_19_20_X3 <- total_active_hours_19_20_X3 /nrow(summer_19_20) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_X3 <- total_active_hours_20_21_X3 /nrow(summer_20_21) * 100)

(Percentage_active_hours_21_22_X3 <- total_active_hours_21_22_X3 /nrow(summer_21_22) * 100)

(Percentage_active_hours_22_23_X3 <- total_active_hours_22_23_X3 /nrow(summer_22_23) * 100)
```

```{r}
# Active time each month

month_activetime_stats_X3 <- bind_rows(
  summer_19_20 %>% filter(Month == 11) %>% count(Condition = X3.Y > 0, name = "Count_19_20_nov"),
  summer_19_20 %>% filter(Month == 12) %>% count(Condition = X3.Y > 0, name = "Count_19_20_dec"),
  summer_19_20 %>% filter(Month == 1) %>% count(Condition = X3.Y > 0, name = "Count_19_20_jan"),
  summer_19_20 %>% filter(Month == 2) %>% count(Condition = X3.Y > 0, name = "Count_19_20_feb"),
  summer_20_21 %>% filter(Month == 11) %>% count(Condition = X3.chosen_yield > 0, name = "Count_20_21_nov"),
  summer_20_21 %>% filter(Month == 12) %>% count(Condition = X3.chosen_yield > 0, name = "Count_20_21_dec"),
  summer_20_21 %>% filter(Month == 1) %>% count(Condition = X3.chosen_yield > 0, name = "Count_20_21_jan"),
  summer_20_21 %>% filter(Month == 2) %>% count(Condition = X3.chosen_yield > 0, name = "Count_20_21_feb"),
  summer_21_22 %>% filter(Month == 11) %>% count(Condition = X3.Y > 0, name = "Count_21_22_nov"),
  summer_21_22 %>% filter(Month == 12) %>% count(Condition = X3.Y > 0, name = "Count_21_22_dec"),
  summer_21_22 %>% filter(Month == 1) %>% count(Condition = X3.Y > 0, name = "Count_21_22_jan"),
  summer_21_22 %>% filter(Month == 2) %>% count(Condition = X3.Y > 0, name = "Count_21_22_feb"),
  summer_22_23 %>% filter(Month == 11) %>% count(Condition = X3.chosen_yield > 0, name = "Count_22_23_nov"),
  summer_22_23 %>% filter(Month == 12) %>% count(Condition = X3.chosen_yield > 0, name = "Count_22_23_dec"),
  summer_22_23 %>% filter(Month == 1) %>% count(Condition = X3.chosen_yield > 0, name = "Count_22_23_jan"),
  summer_22_23 %>% filter(Month == 2) %>% count(Condition = X3.chosen_yield > 0, name = "Count_22_23_feb")) %>% 
  group_by(Condition) %>% 
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum)

(total_active_hours_19_20_nov_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_nov))

(total_active_hours_19_20_dec_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_dec))

(total_active_hours_19_20_jan_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_jan))

(total_active_hours_19_20_feb_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_feb))

(total_active_hours_20_21_nov_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_nov))

(total_active_hours_20_21_dec_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_dec))

(total_active_hours_20_21_jan_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_jan))

(total_active_hours_20_21_feb_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_feb))

(total_active_hours_21_22_nov_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_nov))

(total_active_hours_21_22_dec_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_dec))

(total_active_hours_21_22_jan_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_jan))

(total_active_hours_21_22_feb_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_feb))

(total_active_hours_22_23_nov_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_nov))

(total_active_hours_22_23_dec_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_nov))

(total_active_hours_22_23_jan_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_jan))

(total_active_hours_22_23_feb_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_feb))

(Percentage_active_hours_19_20_nov_X3 <- total_active_hours_19_20_nov_X3 /nrow(summer_19_20 %>% filter(Month == 11)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_dec_X3 <- total_active_hours_19_20_dec_X3 /nrow(summer_19_20 %>% filter(Month == 12)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_jan_X3 <- total_active_hours_19_20_nov_X3 /nrow(summer_19_20 %>% filter(Month == 1)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_feb_X3 <- total_active_hours_19_20_nov_X3 /nrow(summer_19_20 %>% filter(Month == 2)) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_nov_X3 <- total_active_hours_20_21_nov_X3 /nrow(summer_20_21 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_20_21_dec_X3 <- total_active_hours_20_21_dec_X3 /nrow(summer_20_21 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_20_21_jan_X3 <- total_active_hours_20_21_jan_X3 /nrow(summer_20_21 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_20_21_feb_X3 <- total_active_hours_20_21_feb_X3 /nrow(summer_20_21 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_21_22_nov_X3 <- total_active_hours_21_22_nov_X3 /nrow(summer_21_22 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_21_22_dec_X3 <- total_active_hours_21_22_dec_X3 /nrow(summer_21_22 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_21_22_jan_X3 <- total_active_hours_21_22_jan_X3 /nrow(summer_21_22 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_21_22_feb_X3 <- total_active_hours_21_22_feb_X3 /nrow(summer_21_22 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_22_23_nov_X3 <- total_active_hours_22_23_nov_X3 /nrow(summer_22_23 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_22_23_dec_X3 <- total_active_hours_22_23_dec_X3 /nrow(summer_22_23 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_22_23_jan_X3 <- total_active_hours_22_23_jan_X3 /nrow(summer_22_23 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_22_23_feb_X3 <- total_active_hours_22_23_feb_X3 /nrow(summer_22_23 %>% filter(Month == 2)) * 100)
```

### 3. Thallus Temperature

#### 3.1. Total measuring and active time

```{r}
# Mean temperature during the whole measuring period ------------------

(mean_Temp_X3_data <- bind_rows(  # Make into a single dataset
  data_clean,  # get the rows in data_clean where the lichen is active
  data_clean_23) %>% # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_temp = mean(X3.Temp)))  # calculate the mean Temp of the active period
   
       # Mean is Na, which means one of the values is NA

(which(is.na(data_clean$X3.Temp))) # the row 20762 is NA
(which(is.na(data_clean_23$X3.Temp))) # the row 2280 is NA

print(data_clean[20762, ]) # there are a lot of NA --> remove observation
data_clean <- na.omit(data_clean, cols = "X3.Temp") # code to remove it

print(data_clean_23[2280, ]) # change NA value in Temp to -5ºC
data_clean_23$X3.Temp <- replace(data_clean_23$X3.Temp, is.na(data_clean_23$X3.Temp), -5) # code to replace it

(mean_Temp_X3_data <- bind_rows(
  data_clean  %>% select(X3.Temp), 
  data_clean_23  %>% select(X3.Temp)) %>% 
  summarise(mean_temp = mean(X3.Temp),
            max_temp = max(X3.Temp),  # get the maximum temperature
            min_temp = min(X3.Temp)))  # get the minimum temperature

# Mean temperature whole active period -------------------

(mean_Temp_active_X3_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X3.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X3.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_temp = mean(X3.Temp),
    max_temp = max(X3.Temp),
    min_temp = min(X3.Temp)))  # calculate the mean Temp of the active period

(mean_Temp_active_X3 <- mean_Temp_active_X3_data %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_temp))


```

#### 3.2. Summer Temperature

```{r}
# Mean temperature summer 19-20

(mean_Temp_stats_X3_19_20 <- summer_19_20  %>%  # Mean Temp for 19-20
    select(X3.Temp) %>% 
  summarise(mean_temp = mean(X3.Temp),
            max_temp = max(X3.Temp),  # get the maximum temperature
            min_temp = min(X3.Temp)))  # get the minimum temperature


(mean_Temp_X3_19_20 <- mean_Temp_stats_X3_19_20 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X3_19_20 <- mean_Temp_stats_X3_19_20 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X3_19_20 <- mean_Temp_stats_X3_19_20 %>%  # extract the min Temp of the active period
    select(min_temp)) 
  
# Mean temperature active summer 19-20  
  
(mean_Temp_active_stats_X3_19_20 <- summer_19_20 %>% # Mean Temp for active 19-20
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X3.Temp),
    max_temp = max(X3.Temp),
    min_temp = min(X3.Temp)))

(mean_Temp_active_X3_19_20 <- mean_Temp_active_stats_X3_19_20 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X3_19_20 <- mean_Temp_active_stats_X3_19_20 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_temp))

(min_Temp_active_X3_19_20 <- mean_Temp_active_stats_X3_19_20 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( min_temp))


# Mean temperature summer 20-21

(mean_Temp_stats_X3_20_21 <- summer_20_21  %>%  # Mean Temp for 20-21
    select(X3.Temp) %>% 
  summarise(mean_temp = mean(X3.Temp),
            max_temp = max(X3.Temp),  # get the maximum temperature
            min_temp = min(X3.Temp)))  # get the minimum temperature

(mean_Temp_X3_20_21 <- mean_Temp_stats_X3_20_21 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X3_20_21 <- mean_Temp_stats_X3_20_21 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X3_20_21 <- mean_Temp_stats_X3_20_21 %>%  # extract the min Temp of the active period
    select(min_temp)) 

# Mean temperature active summer 20-21 

(mean_Temp_active_stats_X3_20_21 <- summer_20_21 %>% # Mean Temp for active 20-21
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X3.Temp),
    max_temp = max(X3.Temp),
    min_temp = min(X3.Temp)))

(mean_Temp_active_X3_20_21 <- mean_Temp_active_stats_X3_20_21 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X3_20_21 <- mean_Temp_active_stats_X3_20_21 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_temp))

(min_Temp_active_X3_20_21 <- mean_Temp_active_stats_X3_20_21 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( min_temp))

# Mean temperature summer 21-22

(mean_Temp_stats_X3_21_22 <- summer_21_22  %>%  # Mean Temp for 21-22
    select(X3.Temp) %>% 
  summarise(mean_temp = mean(X3.Temp),
            max_temp = max(X3.Temp),  # get the maximum temperature
            min_temp = min(X3.Temp)))  # get the minimum temperature

(mean_Temp_X3_21_22 <- mean_Temp_stats_X3_21_22 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X3_21_22 <- mean_Temp_stats_X3_21_22 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X3_21_22 <- mean_Temp_stats_X3_21_22 %>%  # extract the min Temp of the active period
    select(min_temp)) 

# Mean temperature summer 21-22 active

(mean_Temp_active_stats_X3_21_22 <- summer_21_22 %>% # Mean Temp for active 21-22
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X3.Temp),
    max_temp = max(X3.Temp),
    min_temp = min(X3.Temp)))

(mean_Temp_active_X3_21_22 <- mean_Temp_active_stats_X3_21_22 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X3_21_22 <- mean_Temp_active_stats_X3_21_22 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_temp))

(min_Temp_active_X3_21_22 <- mean_Temp_active_stats_X3_21_22 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( min_temp))

# Mean temperature summer 22-23

(mean_Temp_stats_X3_22_23 <- summer_22_23  %>%  # Mean Temp for 22-23
    select(X3.Temp) %>% 
  summarise(mean_temp = mean(X3.Temp),
            max_temp = max(X3.Temp),  # get the maximum temperature
            min_temp = min(X3.Temp)))  # get the minimum temperature

(mean_Temp_X3_22_23 <- mean_Temp_stats_X3_22_23 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X3_22_23 <- mean_Temp_stats_X3_22_23 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X3_22_23 <- mean_Temp_stats_X3_22_23 %>%  # extract the min Temp of the active period
    select(min_temp))

# Mean temperature summer 22-23 active

(mean_Temp_active_stats_X3_22_23 <- summer_22_23 %>% # Mean Temp for active 22-23
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X3.Temp),
    max_temp = max(X3.Temp),
    min_temp = min(X3.Temp)))

(mean_Temp_active_X3_22_23 <- mean_Temp_active_stats_X3_22_23 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X3_22_23 <- mean_Temp_active_stats_X3_22_23 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_temp))

(min_Temp_active_X3_22_23 <- mean_Temp_active_stats_X3_22_23 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( min_temp))
```

#### 3.3. Monthly temperature

```{r}

(month_temp_stats_X3 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X3.Temp),
            max_temp = max(X3.Temp),  # get the maximum temperature
            min_temp = min(X3.Temp)))

write.xlsx(month_temp_stats_X3, file = "stats/austroplaca/month_temp_stats_X3.xlsx") # save table

(month_active_temp_stats_X3 <- bind_rows(  # Monthly stats for active period
  summer_19_20 %>% filter(Month == 11, X1.Y > 0),
  summer_19_20 %>% filter(Month == 12, X1.Y > 0),
  summer_19_20 %>% filter(Month == 1, X1.Y > 0),
  summer_19_20 %>% filter(Month == 2, X1.Y > 0),
  summer_20_21 %>% filter(Month == 11, X1.Y > 0),
  summer_20_21 %>% filter(Month == 12, X1.Y > 0),
  summer_20_21 %>% filter(Month == 1, X1.Y > 0),
  summer_20_21 %>% filter(Month == 2, X1.Y > 0),
  summer_21_22 %>% filter(Month == 11, X1.Y > 0),
  summer_21_22 %>% filter(Month == 12, X1.Y > 0),
  summer_21_22 %>% filter(Month == 1, X1.Y > 0),
  summer_21_22 %>% filter(Month == 2, X1.Y > 0),
  summer_22_23 %>% filter(Month == 11, X1.Y > 0),
  summer_22_23 %>% filter(Month == 12, X1.Y > 0),
  summer_22_23 %>% filter(Month == 1, X1.Y > 0),
  summer_22_23 %>% filter(Month == 2, X1.Y > 0)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X3.Temp),
            max_temp = max(X3.Temp),  # get the maximum temperature
            min_temp = min(X3.Temp)))

write.xlsx(month_active_temp_stats_X3, file = "stats/austroplaca/month_active_temp_stats_X3.xlsx") # save table
```

### 4. PAR

#### 4.1. Active Period

```{r}
# Active period----

(mean_PAR_active_X3_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X3.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X3.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_PAR = mean(X3.PAR),
    max_PAR = max(X3.PAR),
    min_PAR = min(X3.PAR)))  # calculate the mean PAR of the active period


```

#### 4.2. Monthly PAR

```{r}
# Mean PAR summer 19-20

(mean_PAR_stats_X3_19_20 <- summer_19_20 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X3.PAR),
    max_PAR = max(X3.PAR),
    min_PAR = min(X3.PAR)))

(mean_PAR_active_X3_19_20 <- mean_PAR_stats_X3_19_20 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X3_19_20 <- mean_PAR_stats_X3_19_20 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X3_19_20 <- mean_PAR_stats_X3_19_20 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( min_PAR))

# Mean temperature summer 20-21

(mean_PAR_stats_X3_20_21 <- summer_20_21 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X3.PAR),
    max_PAR = max(X3.PAR),
    min_PAR = min(X3.PAR)))

(mean_PAR_active_X3_20_21 <- mean_PAR_stats_X3_20_21 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X3_20_21 <- mean_PAR_stats_X3_20_21 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X3_20_21 <- mean_PAR_stats_X3_20_21 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( min_PAR))

# Mean temperature summer 21-22

(mean_PAR_stats_X3_21_22 <- summer_21_22 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X3.PAR),
    max_PAR = max(X3.PAR),
    min_PAR = min(X3.PAR)))

(mean_PAR_active_X3_21_22 <- mean_PAR_stats_X3_21_22 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X3_21_22 <- mean_PAR_stats_X3_21_22 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X3_21_22 <- mean_PAR_stats_X3_21_22 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( min_PAR))

# Mean temperature summer 22-23

(mean_PAR_stats_X3_22_23 <- summer_22_23 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X3.PAR),
    max_PAR = max(X3.PAR),
    min_PAR = min(X3.PAR)))

(mean_PAR_active_X3_22_23 <- mean_PAR_stats_X3_22_23 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X3_22_23 <- mean_PAR_stats_X3_22_23 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X3_22_23 <- mean_PAR_stats_X3_22_23 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( min_PAR))
```

#### 4.3. Monthly PAR

```{r}
(month_PAR_stats_X3 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_PAR = mean(X3.PAR),
            max_PAR = max(X3.PAR),  # get the maximum temperature
            min_PAR = min(X3.PAR)))

write.xlsx(month_PAR_stats_X3, file = "stats/austroplaca/month_PAR_stats_X3.xlsx") # save table

```


### 5. YIELD and ETR

#### 5.1. Total Active period
```{r}
# Active period----

(mean_yield_active_X3_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X3.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X3.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_Y = mean(X3.chosen_yield),
    max_Y = max(X3.chosen_yield),
    min_Y = min(X3.chosen_yield)))  # calculate the mean yield of the active period

(mean_ETR_active_X3_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X3.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X3.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_ETR = mean(X3.chosen_ETR),
    max_ETR = max(X3.chosen_ETR),
    min_ETR = min(X3.chosen_ETR)))  # calculate the mean ETR of the active period

```

#### 5.2 Summerly yield/ ETR

```{r}
# Mean YIED/ETR summer 19-20

(mean_yield_stats_X3_19_20 <- summer_19_20 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X3.Y),
    max_Y = max(X3.Y),
    min_Y = min(X3.Y)))

(mean_Y_active_X3_19_20 <- mean_yield_stats_X3_19_20 %>%  # extract the mean yield of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X3_19_20 <- mean_yield_stats_X3_19_20 %>%  # extract the max yield of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X3_19_20 <- summer_19_20 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X3.ETR),
    max_ETR = max(X3.ETR),
    min_ETR = min(X3.ETR)))

(mean_ETR_active_X3_19_20 <- mean_ETR_stats_X3_19_20 %>%  # extract the mean ETR of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X3_19_20 <- mean_ETR_stats_X3_19_20 %>%  # extract the mean ETR of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIED/ETR summer 20-21

(mean_yield_stats_X3_20_21 <- summer_20_21 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X3.chosen_yield),
    max_Y = max(X3.chosen_yield),
    min_Y = min(X3.chosen_yield)))

(mean_Y_active_X3_20_21 <- mean_yield_stats_X3_20_21 %>%  # extract the mean yield of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X3_20_21 <- mean_yield_stats_X3_20_21 %>%  # extract the max yield of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X3_20_21 <- summer_20_21 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X3.chosen_ETR),
    max_ETR = max(X3.chosen_ETR),
    min_ETR = min(X3.chosen_ETR)))

(mean_ETR_active_X3_20_21 <- mean_ETR_stats_X3_20_21 %>%  # extract the mean ETR of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X3_20_21 <- mean_ETR_stats_X3_20_21 %>%  # extract the mean ETR of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIED/ETR summer 21-22

(mean_yield_stats_X3_21_22 <- summer_21_22 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X3.Y),
    max_Y = max(X3.Y),
    min_Y = min(X3.Y)))

(mean_Y_active_X3_21_22 <- mean_yield_stats_X3_21_22 %>%  # extract the mean yield of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X3_21_22 <- mean_yield_stats_X3_21_22 %>%  # extract the max yield of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X3_21_22 <- summer_21_22 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X3.ETR),
    max_ETR = max(X3.ETR),
    min_ETR = min(X3.ETR)))

(mean_ETR_active_X3_21_22 <- mean_ETR_stats_X3_21_22 %>%  # extract the mean ETR of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X3_21_22 <- mean_ETR_stats_X3_21_22 %>%  # extract the mean ETR of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIED/ETR summer 22-23

(mean_yield_stats_X3_22_23 <- summer_22_23 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X3.chosen_yield),
    max_Y = max(X3.chosen_yield),
    min_Y = min(X3.chosen_yield)))

(mean_Y_active_X3_22_23 <- mean_yield_stats_X3_22_23 %>%  # extract the mean yield of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X3_22_23 <- mean_yield_stats_X3_22_23 %>%  # extract the max yield of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X3_22_23 <- summer_22_23 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X3.chosen_ETR),
    max_ETR = max(X3.chosen_ETR),
    min_ETR = min(X3.chosen_ETR)))

(mean_ETR_active_X3_22_23 <- mean_ETR_stats_X3_22_23 %>%  # extract the mean ETR of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X3_22_23 <- mean_ETR_stats_X3_22_23 %>%  # extract the mean ETR of the active period
  filter( X3.Active == TRUE) %>% 
  select( max_ETR))
```

#### 5.3. Monthly yield

```{r}
(month_Y_stats_X3 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_Y= mean(X3.Y),
            max_Y = max(X3.Y),  # get the maximum temperature
            min_Y = min(X3.Y)))

write.xlsx(month_Y_stats_X3, file = "stats/austroplaca/month_Y_stats_X3.xlsx") # save table


(month_ETR_stats_X3 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_ETR= mean(X3.ETR),
            max_ETR = max(X3.ETR),  # get the maximum temperature
            min_ETR = min(X3.ETR)))

write.xlsx(month_ETR_stats_X3, file = "stats/austroplaca/month_ETR_stats_X3.xlsx") # save table
```

## 9.2. Bryum (X1)

### 1. Create columns for activity

```{r}
data_clean <- data_clean %>% 
  mutate(X1.Active = if_else(X1.Y > 0, TRUE, FALSE))  # If the yield is above 0 the plant is active = TRUE

data_clean_23 <- data_clean_23 %>% 
  mutate(X1.Active = if_else(X1.Y > 0, TRUE, FALSE)) 

summer_19_20 <- summer_19_20 %>% 
  mutate(X1.Active = if_else(X1.Y > 0, TRUE, FALSE)) 

summer_20_21 <- summer_20_21 %>% 
  mutate(X1.Active = if_else(X1.Y > 0, TRUE, FALSE)) 

summer_21_22 <- summer_21_22 %>% 
  mutate(X1.Active = if_else(X1.Y > 0, TRUE, FALSE)) 

summer_22_23 <- summer_22_23 %>% 
  mutate(X1.Active = if_else(X1.Y > 0, TRUE, FALSE)) 
```

### 2. Active time

#### 2.1. Active total time

```{r}
# Active total time

total_activetime_stats_X1 <- bind_rows(  # put both counts into one dataset
  data_clean %>% count(Condition = X1.Y > 0, name = "Count_data_clean"),  # Count rows with active time (1 row = 1 hour)
  data_clean_23 %>% count(Condition = X1.Y > 0, name = "Count_data_clean_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum) %>%  # join rows that have the same condition (True or False)
mutate(Total_time = Count_data_clean + Count_data_clean_23) # add both columns to get the total active time of the year
  
(total_active_hours_X1 <- total_activetime_stats_X1 %>% # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Total_time))

(Percentage_active_days_X1 <- total_active_hours_X1/(nrow(data_clean) + nrow(data_clean_23)) * 100) # calculate the percentage 
```

#### 2.2. Active time each summer

```{r}
# Active time each summer

summer_activetime_stats_X1 <-bind_rows(
  summer_19_20 %>% count(Condition = X1.Y > 0, name = "Count_19_20"), # Count rows in summer 20_21 with active time (1 row = 1 hour) // no chosen yield  becaue didn't make any ajustments
  summer_20_21 %>% count(Condition = X1.Y > 0, name = "Count_20_21"), # Chosen yield because made ajustments
summer_21_22 %>% count(Condition = X1.Y > 0, name = "Count_21_22"),
summer_22_23 %>% count(Condition = X1.Y > 0, name = "Count_22_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum)  # join rows that have the same condition (True or False)

# filter from the dataset the total number of active hours---

(total_active_hours_19_20_X1 <- summer_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20))

(total_active_hours_20_21_X1 <- summer_activetime_stats_X1 %>%
  filter(Condition == TRUE) %>%
  select(Count_20_21))

(total_active_hours_21_22_X1 <- summer_activetime_stats_X1 %>%
  filter(Condition == TRUE) %>%
  select(Count_21_22))

(total_active_hours_22_23_X1 <- summer_activetime_stats_X1 %>%
  filter(Condition == TRUE) %>%
  select(Count_22_23))

# put active hours as a percentage

(Percentage_active_hours_19_20_X1 <- total_active_hours_19_20_X1 /nrow(summer_19_20) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_X1 <- total_active_hours_20_21_X1 /nrow(summer_20_21) * 100)

(Percentage_active_hours_21_22_X1 <- total_active_hours_21_22_X1 /nrow(summer_21_22) * 100)

(Percentage_active_hours_22_23_X1 <- total_active_hours_22_23_X1 /nrow(summer_22_23) * 100)
```

#### 2.3. Active time each month

```{r}
# Active time each month

month_activetime_stats_X1 <- bind_rows(
  summer_19_20 %>% filter(Month == 11) %>% count(Condition = X1.Y > 0, name = "Count_19_20_nov"),
  summer_19_20 %>% filter(Month == 12) %>% count(Condition = X1.Y > 0, name = "Count_19_20_dec"),
  summer_19_20 %>% filter(Month == 1) %>% count(Condition = X1.Y > 0, name = "Count_19_20_jan"),
  summer_19_20 %>% filter(Month == 2) %>% count(Condition = X1.Y > 0, name = "Count_19_20_feb"),
  summer_20_21 %>% filter(Month == 11) %>% count(Condition = X1.Y > 0, name = "Count_20_21_nov"),
  summer_20_21 %>% filter(Month == 12) %>% count(Condition = X1.Y > 0, name = "Count_20_21_dec"),
  summer_20_21 %>% filter(Month == 1) %>% count(Condition = X1.Y > 0, name = "Count_20_21_jan"),
  summer_20_21 %>% filter(Month == 2) %>% count(Condition = X1.Y > 0, name = "Count_20_21_feb"),
  summer_21_22 %>% filter(Month == 11) %>% count(Condition = X1.Y > 0, name = "Count_21_22_nov"),
  summer_21_22 %>% filter(Month == 12) %>% count(Condition = X1.Y > 0, name = "Count_21_22_dec"),
  summer_21_22 %>% filter(Month == 1) %>% count(Condition = X1.Y > 0, name = "Count_21_22_jan"),
  summer_21_22 %>% filter(Month == 2) %>% count(Condition = X1.Y > 0, name = "Count_21_22_feb"),
  summer_22_23 %>% filter(Month == 11) %>% count(Condition = X1.Y > 0, name = "Count_22_23_nov"),
  summer_22_23 %>% filter(Month == 12) %>% count(Condition = X1.Y > 0, name = "Count_22_23_dec"),
  summer_22_23 %>% filter(Month == 1) %>% count(Condition = X1.Y > 0, name = "Count_22_23_jan"),
  summer_22_23 %>% filter(Month == 2) %>% count(Condition = X1.Y > 0, name = "Count_22_23_feb")) %>% 
  group_by(Condition) %>% 
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum)

# filter from the dataset the total number of active hours

(total_active_hours_19_20_nov_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_nov))

(total_active_hours_19_20_dec_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_dec))

(total_active_hours_19_20_jan_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_jan))

(total_active_hours_19_20_feb_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_feb))

(total_active_hours_20_21_nov_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_nov))

(total_active_hours_20_21_dec_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_dec))

(total_active_hours_20_21_jan_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_jan))

(total_active_hours_20_21_feb_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_feb))

(total_active_hours_21_22_nov_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_nov))

(total_active_hours_21_22_dec_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_dec))

(total_active_hours_21_22_jan_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_jan))

(total_active_hours_21_22_feb_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_feb))

(total_active_hours_22_23_nov_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_nov))

(total_active_hours_22_23_dec_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_nov))

(total_active_hours_22_23_jan_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_jan))

(total_active_hours_22_23_feb_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_feb))

# put active hours as a percentage

(Percentage_active_hours_19_20_nov_X1 <- total_active_hours_19_20_nov_X1 /nrow(summer_19_20 %>% filter(Month == 11)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_dec_X1 <- total_active_hours_19_20_dec_X1 /nrow(summer_19_20 %>% filter(Month == 12)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_jan_X1 <- total_active_hours_19_20_nov_X1 /nrow(summer_19_20 %>% filter(Month == 1)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_feb_X1 <- total_active_hours_19_20_nov_X1 /nrow(summer_19_20 %>% filter(Month == 2)) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_nov_X1 <- total_active_hours_20_21_nov_X1 /nrow(summer_20_21 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_20_21_dec_X1 <- total_active_hours_20_21_dec_X1 /nrow(summer_20_21 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_20_21_jan_X1 <- total_active_hours_20_21_jan_X1 /nrow(summer_20_21 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_20_21_feb_X1 <- total_active_hours_20_21_feb_X1 /nrow(summer_20_21 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_21_22_nov_X1 <- total_active_hours_21_22_nov_X1 /nrow(summer_21_22 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_21_22_dec_X1 <- total_active_hours_21_22_dec_X1 /nrow(summer_21_22 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_21_22_jan_X1 <- total_active_hours_21_22_jan_X1 /nrow(summer_21_22 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_21_22_feb_X1 <- total_active_hours_21_22_feb_X1 /nrow(summer_21_22 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_22_23_nov_X1 <- total_active_hours_22_23_nov_X1 /nrow(summer_22_23 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_22_23_dec_X1 <- total_active_hours_22_23_dec_X1 /nrow(summer_22_23 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_22_23_jan_X1 <- total_active_hours_22_23_jan_X1 /nrow(summer_22_23 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_22_23_feb_X1 <- total_active_hours_22_23_feb_X1 /nrow(summer_22_23 %>% filter(Month == 2)) * 100)
```

### 3. Thallus Temperature

#### 3.1. Total measuring and active time

```{r}
# Mean temperature during the whole measuring period ------------------

(mean_Temp_X1_data <- bind_rows(
  data_clean  %>% select(X1.Temp), 
  data_clean_23  %>% select(X1.Temp)) %>% 
  summarise(mean_temp = mean(X1.Temp),
            max_temp = max(X1.Temp),  # get the maximum temperature
            min_temp = min(X1.Temp)))  # get the minimum temperature

# Mean temperature whole active period-------------------

(mean_Temp_active_X1_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X1.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X1.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_temp = mean(X1.Temp),
    max_temp = max(X1.Temp),
    min_temp = min(X1.Temp)))  # calculate the mean Temp of the active period

(mean_Temp_active_X1 <- mean_Temp_active_X1_data %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))


```

#### 3.2. Summer Temperature

```{r}
# Mean temperature summer 19-20

(mean_Temp_stats_X1_19_20 <- summer_19_20  %>%  # Mean Temp for 19-20
    select(X1.Temp) %>% 
  summarise(mean_temp = mean(X1.Temp),
            max_temp = max(X1.Temp),  # get the maximum temperature
            min_temp = min(X1.Temp)))  # get the minimum temperature

(mean_Temp_X1_19_20 <- mean_Temp_stats_X1_19_20 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X1_19_20 <- mean_Temp_stats_X1_19_20 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X1_19_20 <- mean_Temp_stats_X1_19_20 %>%  # extract the min Temp of the active period
    select(min_temp)) 

# Mean temperature summer 19-20 active 

(mean_Temp_active_stats_X1_19_20 <- summer_19_20 %>%  # Mean Temp for active 19-20
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X1.Temp),
    max_temp = max(X1.Temp),
    min_temp = min(X1.Temp)))

(mean_Temp_active_X1_19_20 <- mean_Temp_active_stats_X1_19_20 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X1_19_20 <- mean_Temp_active_stats_X1_19_20 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_temp))

(min_Temp_active_X1_19_20 <- mean_Temp_active_stats_X1_19_20 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_temp))

# Mean temperature summer 20-21

(mean_Temp_stats_X1_20_21 <- summer_20_21  %>%  # Mean Temp for 20-21
    select(X1.Temp) %>% 
  summarise(mean_temp = mean(X1.Temp),
            max_temp = max(X1.Temp),  # get the maximum temperature
            min_temp = min(X1.Temp)))  # get the minimum temperature

(mean_Temp_X1_20_21 <- mean_Temp_stats_X1_20_21 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X1_20_21 <- mean_Temp_stats_X1_20_21 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X1_20_21 <- mean_Temp_stats_X1_20_21 %>%  # extract the min Temp of the active period
    select(min_temp))

# Mean temperature summer 20-21 active

(mean_Temp_active_stats_X1_20_21 <- summer_20_21 %>% # Mean Temp for active 20-21
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X1.Temp),
    max_temp = max(X1.Temp),
    min_temp = min(X1.Temp)))

(mean_Temp_active_X1_20_21 <- mean_Temp_active_stats_X1_20_21 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X1_20_21 <- mean_Temp_active_stats_X1_20_21 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

(min_Temp_active_X1_20_21 <- mean_Temp_active_stats_X1_20_21 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_temp))

# Mean temperature summer 21-22

(mean_Temp_stats_X1_21_22 <- summer_21_22  %>%  # Mean Temp for 21-22
    select(X1.Temp) %>% 
  summarise(mean_temp = mean(X1.Temp),
            max_temp = max(X1.Temp),  # get the maximum temperature
            min_temp = min(X1.Temp)))  # get the minimum temperature

(mean_Temp_X1_21_22 <- mean_Temp_stats_X1_21_22 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X1_21_22 <- mean_Temp_stats_X1_21_22 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X1_21_22 <- mean_Temp_stats_X1_21_22 %>%  # extract the min Temp of the active period
    select(min_temp))

# Mean temperature summer 21-22 active

(mean_Temp_active_stats_X1_21_22 <- summer_21_22 %>% # Mean Temp for active 21-22
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X1.Temp),
    max_temp = max(X1.Temp),
    min_temp = min(X1.Temp)))

(mean_Temp_active_X1_21_22 <- mean_Temp_active_stats_X1_21_22 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X1_21_22 <- mean_Temp_active_stats_X1_21_22 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

(min_Temp_active_X1_21_22 <- mean_Temp_active_stats_X1_21_22 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_temp))

# Mean temperature summer 22-23

(mean_Temp_stats_X1_22_23 <- summer_22_23  %>%  # Mean Temp for 22-23
    select(X1.Temp) %>% 
  summarise(mean_temp = mean(X1.Temp),
            max_temp = max(X1.Temp),  # get the maximum temperature
            min_temp = min(X1.Temp)))  # get the minimum temperature

(mean_Temp_X1_22_23 <- mean_Temp_stats_X1_22_23 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X1_22_23 <- mean_Temp_stats_X1_22_23 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X1_22_23 <- mean_Temp_stats_X1_22_23 %>%  # extract the min Temp of the active period
    select(min_temp))

# Mean temperature summer 22-23 active

(mean_Temp_active_stats_X1_22_23 <- summer_22_23 %>% # Mean Temp for active 22-23
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X1.Temp),
    max_temp = max(X1.Temp),
    min_temp = min(X1.Temp)))

(mean_Temp_active_X1_22_23 <- mean_Temp_active_stats_X1_22_23 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X1_22_23 <- mean_Temp_active_stats_X1_22_23 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

(min_Temp_active_X1_22_23 <- mean_Temp_active_stats_X1_22_23 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_temp))


```

#### 3.3. Monthly temperature

```{r}

(month_temp_stats_X1 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X1.Temp),
            max_temp = max(X1.Temp),  # get the maximum temperature
            min_temp = min(X1.Temp)))

write.xlsx(month_temp_stats_X1, file = "stats/bryum/month_temp_stats_X1.xlsx") # save table

(month_active_temp_stats_X1 <- bind_rows(  # Monthly stats for active period
  summer_19_20 %>% filter(Month == 11, X1.Active == TRUE),
  summer_19_20 %>% filter(Month == 12, X1.Active == TRUE),
  summer_19_20 %>% filter(Month == 1, X1.Active == TRUE),
  summer_19_20 %>% filter(Month == 2, X1.Active == TRUE),
  summer_20_21 %>% filter(Month == 11, X1.Active == TRUE),
  summer_20_21 %>% filter(Month == 12, X1.Active == TRUE),
  summer_20_21 %>% filter(Month == 1, X1.Active == TRUE),
  summer_20_21 %>% filter(Month == 2, X1.Active == TRUE),
  summer_21_22 %>% filter(Month == 11, X1.Active == TRUE),
  summer_21_22 %>% filter(Month == 12, X1.Active == TRUE),
  summer_21_22 %>% filter(Month == 1, X1.Active == TRUE),
  summer_21_22 %>% filter(Month == 2, X1.Active == TRUE),
  summer_22_23 %>% filter(Month == 11, X1.Active == TRUE),
  summer_22_23 %>% filter(Month == 12, X1.Active == TRUE),
  summer_22_23 %>% filter(Month == 1, X1.Active == TRUE),
  summer_22_23 %>% filter(Month == 2, X1.Active == TRUE)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X1.Temp),
            max_temp = max(X1.Temp),  # get the maximum temperature
            min_temp = min(X1.Temp)))

write.xlsx(month_active_temp_stats_X1, file = "stats/bryum/month_active_temp_stats_X1.xlsx") # save table

```

### 4. PAR

```{r}
# Active period----

(mean_PAR_active_X1_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X1.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X1.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_PAR = mean(X1.PAR),
    max_PAR = max(X1.PAR),
    min_PAR = min(X1.PAR)))  # calculate the mean PAR of the active period

```

#### 4.2. Summerly PAR

```{r}
# Mean PAR summer 19-20

(mean_PAR_stats_X1_19_20 <- summer_19_20 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X1.PAR),
    max_PAR = max(X1.PAR),
    min_PAR = min(X1.PAR)))

(mean_PAR_active_X1_19_20 <- mean_PAR_stats_X1_19_20 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X1_19_20 <- mean_PAR_stats_X1_19_20 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X1_19_20 <- mean_PAR_stats_X1_19_20 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_PAR))

# Mean PAR summer 20-21

(mean_PAR_stats_X1_20_21 <- summer_20_21 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X1.PAR),
    max_PAR = max(X1.PAR),
    min_PAR = min(X1.PAR)))

(mean_PAR_active_X1_20_21 <- mean_PAR_stats_X1_20_21 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X1_20_21 <- mean_PAR_stats_X1_20_21 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X1_20_21 <- mean_PAR_stats_X1_20_21 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_PAR))

# Mean PAR summer 21-22

(mean_PAR_stats_X1_21_22 <- summer_21_22 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X1.PAR),
    max_PAR = max(X1.PAR),
    min_PAR = min(X1.PAR)))

(mean_PAR_active_X1_21_22 <- mean_PAR_stats_X1_21_22 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X1_21_22 <- mean_PAR_stats_X1_21_22 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X1_21_22 <- mean_PAR_stats_X1_21_22 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_PAR))

# Mean PAR summer 22-23

(mean_PAR_stats_X1_22_23 <- summer_22_23 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X1.PAR),
    max_PAR = max(X1.PAR),
    min_PAR = min(X1.PAR)))

(mean_PAR_active_X1_22_23 <- mean_PAR_stats_X1_22_23 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X1_22_23 <- mean_PAR_stats_X1_22_23 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X1_22_23 <- mean_PAR_stats_X1_22_23 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_PAR))
```

#### 4.3. Monthly PAR

```{r}
(month_PAR_stats_X1 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_PAR = mean(X1.PAR),
            max_PAR = max(X1.PAR),  # get the maximum temperature
            min_PAR = min(X1.PAR)))

write.xlsx(month_PAR_stats_X1, file = "stats/bryum/month_PAR_stats_X1.xlsx") # save table

```


### 5. YIELD and ETR

```{r}
# Active period----

(mean_yield_active_X1_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X1.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X1.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_Y = mean(X1.Y),
    max_Y = max(X1.Y),
    min_Y = min(X1.Y)))  # calculate the mean yield of the active period

(mean_ETR_active_X1_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X1.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X1.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_ETR = mean(X1.ETR),
    max_ETR = max(X1.ETR),
    min_ETR = min(X1.ETR)))  # calculate the mean ETR of the active period

```

#### 5.2 Summer yield/ ETR

```{r}
# Mean YIED/ETR summer 19-20

(mean_yield_stats_X1_19_20 <- summer_19_20 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X1.Y),
    max_Y = max(X1.Y),
    min_Y = min(X1.Y)))

(mean_Y_active_X1_19_20 <- mean_yield_stats_X1_19_20 %>%  # extract the mean yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X1_19_20 <- mean_yield_stats_X1_19_20 %>%  # extract the max yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X1_19_20 <- summer_19_20 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X1.ETR),
    max_ETR = max(X1.ETR),
    min_ETR = min(X1.ETR)))

(mean_ETR_active_X1_19_20 <- mean_ETR_stats_X1_19_20 %>%  # extract the mean ETR of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X1_19_20 <- mean_ETR_stats_X1_19_20 %>%  # extract the mean ETR of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIED/ETR summer 20-21

(mean_yield_stats_X1_20_21 <- summer_20_21 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X1.Y),
    max_Y = max(X1.Y),
    min_Y = min(X1.Y)))

(mean_Y_active_X1_20_21 <- mean_yield_stats_X1_20_21 %>%  # extract the mean yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X1_20_21 <- mean_yield_stats_X1_20_21 %>%  # extract the max yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X1_20_21 <- summer_20_21 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X1.ETR),
    max_ETR = max(X1.ETR),
    min_ETR = min(X1.ETR)))

(mean_ETR_active_X1_20_21 <- mean_ETR_stats_X1_20_21 %>%  # extract the mean ETR of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X1_20_21 <- mean_ETR_stats_X1_20_21 %>%  # extract the mean ETR of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIED/ETR summer 21-22

(mean_yield_stats_X1_21_22 <- summer_21_22 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X1.Y),
    max_Y = max(X1.Y),
    min_Y = min(X1.Y)))

(mean_Y_active_X1_21_22 <- mean_yield_stats_X1_21_22 %>%  # extract the mean yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X1_21_22 <- mean_yield_stats_X1_21_22 %>%  # extract the max yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X1_21_22 <- summer_21_22 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X1.ETR),
    max_ETR = max(X1.ETR),
    min_ETR = min(X1.ETR)))

(mean_ETR_active_X1_21_22 <- mean_ETR_stats_X1_21_22 %>%  # extract the mean ETR of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X1_21_22 <- mean_ETR_stats_X1_21_22 %>%  # extract the mean ETR of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIED/ETR summer 22-23

(mean_yield_stats_X1_22_23 <- summer_22_23 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X1.Y),
    max_Y = max(X1.Y),
    min_Y = min(X1.Y)))

(mean_Y_active_X1_22_23 <- mean_yield_stats_X1_22_23 %>%  # extract the mean yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X1_22_23 <- mean_yield_stats_X1_22_23 %>%  # extract the max yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X1_22_23 <- summer_22_23 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X1.ETR),
    max_ETR = max(X1.ETR),
    min_ETR = min(X1.ETR)))

(mean_ETR_active_X1_22_23 <- mean_ETR_stats_X1_22_23 %>%  # extract the mean ETR of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X1_22_23 <- mean_ETR_stats_X1_22_23 %>%  # extract the mean ETR of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_ETR))
```

#### 5.3. Monthly

```{r}
(month_Y_stats_X1 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_Y= mean(X1.Y),
            max_Y = max(X1.Y),  # get the maximum temperature
            min_Y = min(X1.Y)))

write.xlsx(month_Y_stats_X1, file = "stats/bryum/month_Y_stats_X1.xlsx") # save table

(month_ETR_stats_X1 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_ETR= mean(X1.ETR),
            max_ETR = max(X1.ETR),  # get the maximum temperature
            min_ETR = min(X1.ETR)))

write.xlsx(month_ETR_stats_X1, file = "stats/bryum/month_ETR_stats_X1.xlsx") # save table
```
## 9.3. Bryum (X2)
### 1. Create columns activity



```{r}
data_clean <- data_clean %>% 
  mutate(X2.Active = if_else(X2.Y > 0, TRUE, FALSE))  # If the yield is above 0 the plant is active = TRUE

data_clean_23 <- data_clean_23 %>% 
  mutate(X2.Active = if_else(X2.Y > 0, TRUE, FALSE)) 

summer_19_20 <- summer_19_20 %>% 
  mutate(X2.Active = if_else(X2.Y > 0, TRUE, FALSE)) 

summer_20_21 <- summer_20_21 %>% 
  mutate(X2.Active = if_else(X2.Y > 0, TRUE, FALSE)) 

summer_21_22 <- summer_21_22 %>% 
  mutate(X2.Active = if_else(X2.Y > 0, TRUE, FALSE)) 

summer_22_23 <- summer_22_23 %>% 
  mutate(X2.Active = if_else(X2.Y > 0, TRUE, FALSE)) 
```

### 2. Active time

#### 2.1. Active total time

```{r}
# Active total time

(total_activetime_stats_X2 <- bind_rows(  # put both counts into one dataset
  data_clean %>% count(Condition = X2.Y > 0, name = "Count_data_clean"),  # Count rows with active time (1 row = 1 hour)
  data_clean_23 %>% count(Condition = X2.Y > 0, name = "Count_data_clean_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum) %>%  # join rows that have the same condition (True or False)
mutate(Total_time = Count_data_clean + Count_data_clean_23)) # add both columns to get the total active time of the year
  
(total_active_hours_X2 <- total_activetime_stats_X2 %>% # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Total_time))

(Percentage_active_days_X2 <- total_active_hours_X2/(nrow(data_clean) + nrow(data_clean_23)) * 100) # calculate the percentage 
```

#### 2.2. Active time each summer

```{r}
# Active time each summer

summer_activetime_stats_X2 <-bind_rows(
  summer_19_20 %>% count(Condition = X2.Y > 0, name = "Count_19_20"), # Count rows in summer 20_21 with active time (1 row = 1 hour) // no chosen yield  becaue didn't make any ajustments
  summer_20_21 %>% count(Condition = X2.Y > 0, name = "Count_20_21"), # Chosen yield because made ajustments
  summer_21_22 %>% count(Condition = X2.Y > 0, name = "Count_21_22"),
  summer_22_23 %>% count(Condition = X2.Y > 0, name = "Count_22_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum)  # join rows that have the same condition (True or False)

(total_active_hours_19_20_X2 <- summer_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20))

(total_active_hours_20_21_X2 <- summer_activetime_stats_X2 %>%
  filter(Condition == TRUE) %>%
  select(Count_20_21))

(total_active_hours_21_22_X2 <- summer_activetime_stats_X2 %>%
  filter(Condition == TRUE) %>%
  select(Count_21_22))

(total_active_hours_22_23_X2 <- summer_activetime_stats_X2 %>%
  filter(Condition == TRUE) %>%
  select(Count_22_23))

(Percentage_active_hours_19_20_X2 <- total_active_hours_19_20_X2 /nrow(summer_19_20) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_X2 <- total_active_hours_20_21_X2 /nrow(summer_20_21) * 100)

(Percentage_active_hours_21_22_X2 <- total_active_hours_21_22_X2 /nrow(summer_21_22) * 100)

(Percentage_active_hours_22_23_X2 <- total_active_hours_22_23_X2 /nrow(summer_22_23) * 100)
```

#### 2.3. Active time each month

```{r}
# Active time each month

(month_activetime_stats_X2 <- bind_rows(
  summer_19_20 %>% filter(Month == 11) %>% count(Condition = X2.Y > 0, name = "Count_19_20_nov"),
  summer_19_20 %>% filter(Month == 12) %>% count(Condition = X2.Y > 0, name = "Count_19_20_dec"),
  summer_19_20 %>% filter(Month == 1) %>% count(Condition = X2.Y > 0, name = "Count_19_20_jan"),
  summer_19_20 %>% filter(Month == 2) %>% count(Condition = X2.Y > 0, name = "Count_19_20_feb"),
  summer_20_21 %>% filter(Month == 11) %>% count(Condition = X2.Y > 0, name = "Count_20_21_nov"),
  summer_20_21 %>% filter(Month == 12) %>% count(Condition = X2.Y > 0, name = "Count_20_21_dec"),
  summer_20_21 %>% filter(Month == 1) %>% count(Condition = X2.Y > 0, name = "Count_20_21_jan"),
  summer_20_21 %>% filter(Month == 2) %>% count(Condition = X2.Y > 0, name = "Count_20_21_feb"),
  summer_21_22 %>% filter(Month == 11) %>% count(Condition = X2.Y > 0, name = "Count_21_22_nov"),
  summer_21_22 %>% filter(Month == 12) %>% count(Condition = X2.Y > 0, name = "Count_21_22_dec"),
  summer_21_22 %>% filter(Month == 1) %>% count(Condition = X2.Y > 0, name = "Count_21_22_jan"),
  summer_21_22 %>% filter(Month == 2) %>% count(Condition = X2.Y > 0, name = "Count_21_22_feb"),
  summer_22_23 %>% filter(Month == 11) %>% count(Condition = X2.Y > 0, name = "Count_22_23_nov"),
  summer_22_23 %>% filter(Month == 12) %>% count(Condition = X2.Y > 0, name = "Count_22_23_dec"),
  summer_22_23 %>% filter(Month == 1) %>% count(Condition = X2.Y > 0, name = "Count_22_23_jan"),
  summer_22_23 %>% filter(Month == 2) %>% count(Condition = X2.Y > 0, name = "Count_22_23_feb")) %>% 
  group_by(Condition) %>% 
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum) %>% 
   filter(Condition == TRUE))


(total_active_hours_19_20_nov_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_nov))

(total_active_hours_19_20_dec_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_dec))

(total_active_hours_19_20_jan_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_jan))

(total_active_hours_19_20_feb_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_feb))

(total_active_hours_20_21_nov_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_nov))

(total_active_hours_20_21_dec_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_dec))

(total_active_hours_20_21_jan_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_jan))

(total_active_hours_20_21_feb_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_feb))

(total_active_hours_21_22_nov_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_nov))

(total_active_hours_21_22_dec_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_dec))

(total_active_hours_21_22_jan_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  select(Count_21_22_jan))

(total_active_hours_21_22_feb_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  select(Count_21_22_feb))

(total_active_hours_22_23_nov_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_nov))

(total_active_hours_22_23_dec_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_nov))

(total_active_hours_22_23_jan_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_jan))

(total_active_hours_22_23_feb_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_feb))

(Percentage_active_hours_19_20_nov_X2 <- total_active_hours_19_20_nov_X2 /nrow(summer_19_20 %>% filter(Month == 11)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_dec_X2 <- total_active_hours_19_20_dec_X2 /nrow(summer_19_20 %>% filter(Month == 12)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_jan_X2 <- total_active_hours_19_20_nov_X2 /nrow(summer_19_20 %>% filter(Month == 1)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_feb_X2 <- total_active_hours_19_20_nov_X2 /nrow(summer_19_20 %>% filter(Month == 2)) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_nov_X2 <- total_active_hours_20_21_nov_X2 /nrow(summer_20_21 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_20_21_dec_X2 <- total_active_hours_20_21_dec_X2 /nrow(summer_20_21 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_20_21_jan_X2 <- total_active_hours_20_21_jan_X2 /nrow(summer_20_21 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_20_21_feb_X2 <- total_active_hours_20_21_feb_X2 /nrow(summer_20_21 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_21_22_nov_X2 <- total_active_hours_21_22_nov_X2 /nrow(summer_21_22 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_21_22_dec_X2 <- total_active_hours_21_22_dec_X2 /nrow(summer_21_22 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_21_22_jan_X2 <- total_active_hours_21_22_jan_X2 /nrow(summer_21_22 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_21_22_feb_X2 <- total_active_hours_21_22_feb_X2 /nrow(summer_21_22 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_22_23_nov_X2 <- total_active_hours_22_23_nov_X2 /nrow(summer_22_23 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_22_23_dec_X2 <- total_active_hours_22_23_dec_X2 /nrow(summer_22_23 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_22_23_jan_X2 <- total_active_hours_22_23_jan_X2 /nrow(summer_22_23 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_22_23_feb_X2 <- total_active_hours_22_23_feb_X2 /nrow(summer_22_23 %>% filter(Month == 2)) * 100)
```

### 3. Thallus Temperature

#### 3.1. Total measuring and active time

```{r}
# Mean temperature during the whole measuring period ------------------

(mean_Temp_X2_data <- bind_rows(
  data_clean  %>% select(X2.Temp), 
  data_clean_23  %>% select(X2.Temp)) %>% 
  summarise(mean_temp = mean(X2.Temp),
            max_temp = max(X2.Temp),  # get the maximum temperature
            min_temp = min(X2.Temp)))  # get the minimum temperature

# Mean temperature whole active period-------------------

(mean_Temp_active_X2_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X2.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X2.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_temp = mean(X2.Temp),
    max_temp = max(X2.Temp),
    min_temp = min(X2.Temp)))  # calculate the mean Temp of the active period

(mean_Temp_active_X2 <- mean_Temp_active_X2_data %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_temp))


```

#### 3.2. Summer Temperature

```{r}
# Mean temperature summer 19-20

(mean_Temp_stats_X2_19_20 <- summer_19_20  %>%  # Mean Temp for 19-20
    select(X2.Temp) %>% 
  summarise(mean_temp = mean(X2.Temp),
            max_temp = max(X2.Temp),  # get the maximum temperature
            min_temp = min(X2.Temp)))  # get the minimum temperature

(mean_Temp_X2_19_20 <- mean_Temp_stats_X2_19_20 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X2_19_20 <- mean_Temp_stats_X2_19_20 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X2_19_20 <- mean_Temp_stats_X2_19_20 %>%  # extract the min Temp of the active period
    select(min_temp)) 

# Mean temperature summer 19-20 active 

(mean_Temp_active_stats_X2_19_20 <- summer_19_20 %>%  # Mean Temp for active 19-20
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X2.Temp),
    max_temp = max(X2.Temp),
    min_temp = min(X2.Temp)))

(mean_Temp_active_X2_19_20 <- mean_Temp_active_stats_X2_19_20 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X2_19_20 <- mean_Temp_active_stats_X2_19_20 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( max_temp))

(min_Temp_active_X2_19_20 <- mean_Temp_active_stats_X2_19_20 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( min_temp))

# Mean temperature summer 20-21

(mean_Temp_stats_X2_20_21 <- summer_20_21  %>%  # Mean Temp for 20-21
    select(X2.Temp) %>% 
  summarise(mean_temp = mean(X2.Temp),
            max_temp = max(X2.Temp),  # get the maximum temperature
            min_temp = min(X2.Temp)))  # get the minimum temperature

(mean_Temp_X2_20_21 <- mean_Temp_stats_X2_20_21 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X2_20_21 <- mean_Temp_stats_X2_20_21 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X2_20_21 <- mean_Temp_stats_X2_20_21 %>%  # extract the min Temp of the active period
    select(min_temp))

# Mean temperature summer 20-21 active

(mean_Temp_active_stats_X2_20_21 <- summer_20_21 %>% # Mean Temp for active 20-21
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X2.Temp),
    max_temp = max(X2.Temp),
    min_temp = min(X2.Temp)))

(mean_Temp_active_X2_20_21 <- mean_Temp_active_stats_X2_20_21 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X2_20_21 <- mean_Temp_active_stats_X2_20_21 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_temp))

(min_Temp_active_X2_20_21 <- mean_Temp_active_stats_X2_20_21 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( min_temp))

# Mean temperature summer 21-22

(mean_Temp_stats_X2_21_22 <- summer_21_22  %>%  # Mean Temp for 21-22
    select(X2.Temp) %>% 
  summarise(mean_temp = mean(X2.Temp),
            max_temp = max(X2.Temp),  # get the maximum temperature
            min_temp = min(X2.Temp)))  # get the minimum temperature

(mean_Temp_X2_21_22 <- mean_Temp_stats_X2_21_22 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X2_21_22 <- mean_Temp_stats_X2_21_22 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X2_21_22 <- mean_Temp_stats_X2_21_22 %>%  # extract the min Temp of the active period
    select(min_temp))

# Mean temperature summer 21-22 active

(mean_Temp_active_stats_X2_21_22 <- summer_21_22 %>% # Mean Temp for active 21-22
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X2.Temp),
    max_temp = max(X2.Temp),
    min_temp = min(X2.Temp)))

(mean_Temp_active_X2_21_22 <- mean_Temp_active_stats_X2_21_22 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X2_21_22 <- mean_Temp_active_stats_X2_21_22 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_temp))

(min_Temp_active_X2_21_22 <- mean_Temp_active_stats_X2_21_22 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( min_temp))

# Mean temperature summer 22-23

(mean_Temp_stats_X2_22_23 <- summer_22_23  %>%  # Mean Temp for 22-23
    select(X2.Temp) %>% 
  summarise(mean_temp = mean(X2.Temp),
            max_temp = max(X2.Temp),  # get the maximum temperature
            min_temp = min(X2.Temp)))  # get the minimum temperature

(mean_Temp_X2_22_23 <- mean_Temp_stats_X2_22_23 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X2_22_23 <- mean_Temp_stats_X2_22_23 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X2_22_23 <- mean_Temp_stats_X2_22_23 %>%  # extract the min Temp of the active period
    select(min_temp))

# Mean temperature summer 22-23 active

(mean_Temp_active_stats_X2_22_23 <- summer_22_23 %>% # Mean Temp for active 22-23
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X2.Temp),
    max_temp = max(X2.Temp),
    min_temp = min(X2.Temp)))

(mean_Temp_active_X2_22_23 <- mean_Temp_active_stats_X2_22_23 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X2_22_23 <- mean_Temp_active_stats_X2_22_23 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_temp))

(min_Temp_active_X2_22_23 <- mean_Temp_active_stats_X2_22_23 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( min_temp))
```

#### 3.3. Monthly temperature

```{r}

(month_temp_stats_X2 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X2.Temp),
            max_temp = max(X2.Temp),  # get the maximum temperature
            min_temp = min(X2.Temp)))

write.xlsx(month_temp_stats_X2, file = "stats/bryum/month_temp_stats_X2.xlsx") # save table

(month_active_temp_stats_X2 <- bind_rows(  # Monthly stats for active period
  summer_19_20 %>% filter(Month == 11, X2.Y > 0),
  summer_19_20 %>% filter(Month == 12, X2.Y > 0),
  summer_19_20 %>% filter(Month == 1, X2.Y > 0),
  summer_19_20 %>% filter(Month == 2, X2.Y > 0),
  summer_20_21 %>% filter(Month == 11, X2.Y > 0),
  summer_20_21 %>% filter(Month == 12, X2.Y > 0),
  summer_20_21 %>% filter(Month == 1, X2.Y > 0),
  summer_20_21 %>% filter(Month == 2, X2.Y > 0),
  summer_21_22 %>% filter(Month == 11, X2.Y > 0),
  summer_21_22 %>% filter(Month == 12, X2.Y > 0),
  summer_21_22 %>% filter(Month == 1, X2.Y > 0),
  summer_21_22 %>% filter(Month == 2, X2.Y > 0),
  summer_22_23 %>% filter(Month == 11, X2.Y > 0),
  summer_22_23 %>% filter(Month == 12, X2.Y > 0),
  summer_22_23 %>% filter(Month == 1, X2.Y > 0),
  summer_22_23 %>% filter(Month == 2, X2.Y > 0)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X2.Temp),
            max_temp = max(X2.Temp),  # get the maximum temperature
            min_temp = min(X2.Temp)))

write.xlsx(month_active_temp_stats_X2, file = "stats/bryum/month_active_temp_stats_X2.xlsx") # save table
```

### 4. PAR

```{r}
# Active period----

(mean_PAR_active_X2_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X2.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X2.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_PAR = mean(X2.PAR),
    max_PAR = max(X2.PAR),
    min_PAR = min(X2.PAR)))  # calculate the mean PAR of the active period

```

#### 4.2. Summerly PAR

```{r}
# Mean PAR summer 19-20

(mean_PAR_stats_X2_19_20 <- summer_19_20 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X2.PAR),
    max_PAR = max(X2.PAR),
    min_PAR = min(X2.PAR)))

(mean_PAR_active_X2_19_20 <- mean_PAR_stats_X2_19_20 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X2_19_20 <- mean_PAR_stats_X2_19_20 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X2_19_20 <- mean_PAR_stats_X2_19_20 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( min_PAR))

# Mean PAR summer 20-21

(mean_PAR_stats_X2_20_21 <- summer_20_21 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X2.PAR),
    max_PAR = max(X2.PAR),
    min_PAR = min(X2.PAR)))

(mean_PAR_active_X2_20_21 <- mean_PAR_stats_X2_20_21 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X2_20_21 <- mean_PAR_stats_X2_20_21 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X2_20_21 <- mean_PAR_stats_X2_20_21 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( min_PAR))

# Mean PAR summer 21-22

(mean_PAR_stats_X2_21_22 <- summer_21_22 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X2.PAR),
    max_PAR = max(X2.PAR),
    min_PAR = min(X2.PAR)))

(mean_PAR_active_X2_21_22 <- mean_PAR_stats_X2_21_22 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X2_21_22 <- mean_PAR_stats_X2_21_22 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X2_21_22 <- mean_PAR_stats_X2_21_22 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( min_PAR))

# Mean PAR summer 22-23

(mean_PAR_stats_X2_22_23 <- summer_22_23 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X2.PAR),
    max_PAR = max(X2.PAR),
    min_PAR = min(X2.PAR)))

(mean_PAR_active_X2_22_23 <- mean_PAR_stats_X2_22_23 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X2_22_23 <- mean_PAR_stats_X2_22_23 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X2_22_23 <- mean_PAR_stats_X2_22_23 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( min_PAR))

```

#### 4.3. Monthly PAR

```{r}
(month_PAR_stats_X2 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_PAR = mean(X2.PAR),
            max_PAR = max(X2.PAR),  # get the maximum temperature
            min_PAR = min(X2.PAR)))

write.xlsx(month_PAR_stats_X2, file = "stats/bryum/month_PAR_stats_X2.xlsx") # save table
```


### 5. YIELD and ETR

```{r}
# Active period----

(mean_yield_active_X2_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X2.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X2.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_Y = mean(X2.Y),
    max_Y = max(X2.Y),
    min_Y = min(X2.Y)))  # calculate the mean yield of the active period

(mean_ETR_active_X2_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X2.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X2.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_ETR = mean(X2.ETR),
    max_ETR = max(X2.ETR),
    min_ETR = min(X2.ETR)))  # calculate the mean ETR of the active period

```

#### 5.2 Summer yield/ ETR

```{r}
# Mean YIED/ETR summer 19-20

(mean_yield_stats_X2_19_20 <- summer_19_20 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X2.Y),
    max_Y = max(X2.Y),
    min_Y = min(X2.Y)))

(mean_Y_active_X2_19_20 <- mean_yield_stats_X2_19_20 %>%  # extract the mean yield of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X2_19_20 <- mean_yield_stats_X2_19_20 %>%  # extract the max yield of the active period
  filter( X2.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X2_19_20 <- summer_19_20 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X2.ETR),
    max_ETR = max(X2.ETR),
    min_ETR = min(X2.ETR)))

(mean_ETR_active_X2_19_20 <- mean_ETR_stats_X2_19_20 %>%  # extract the mean ETR of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X2_19_20 <- mean_ETR_stats_X2_19_20 %>%  # extract the mean ETR of the active period
  filter( X2.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIED/ETR summer 20-21

(mean_yield_stats_X2_20_21 <- summer_20_21 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X2.Y),
    max_Y = max(X2.Y),
    min_Y = min(X2.Y)))

(mean_Y_active_X2_20_21 <- mean_yield_stats_X2_20_21 %>%  # extract the mean yield of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X2_20_21 <- mean_yield_stats_X2_20_21 %>%  # extract the max yield of the active period
  filter( X2.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X2_20_21 <- summer_20_21 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X2.ETR),
    max_ETR = max(X2.ETR),
    min_ETR = min(X2.ETR)))

(mean_ETR_active_X2_20_21 <- mean_ETR_stats_X2_20_21 %>%  # extract the mean ETR of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X2_20_21 <- mean_ETR_stats_X2_20_21 %>%  # extract the mean ETR of the active period
  filter( X2.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIED/ETR summer 21-22

(mean_yield_stats_X2_21_22 <- summer_21_22 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X2.Y),
    max_Y = max(X2.Y),
    min_Y = min(X2.Y)))

(mean_Y_active_X2_21_22 <- mean_yield_stats_X2_21_22 %>%  # extract the mean yield of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X2_21_22 <- mean_yield_stats_X2_21_22 %>%  # extract the max yield of the active period
  filter( X2.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X2_21_22 <- summer_21_22 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X2.ETR),
    max_ETR = max(X2.ETR),
    min_ETR = min(X2.ETR)))

(mean_ETR_active_X2_21_22 <- mean_ETR_stats_X2_21_22 %>%  # extract the mean ETR of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X2_21_22 <- mean_ETR_stats_X2_21_22 %>%  # extract the mean ETR of the active period
  filter( X2.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIED/ETR summer 22-23

(mean_yield_stats_X2_22_23 <- summer_22_23 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X2.Y),
    max_Y = max(X2.Y),
    min_Y = min(X2.Y)))

(mean_Y_active_X2_22_23 <- mean_yield_stats_X2_22_23 %>%  # extract the mean yield of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X2_22_23 <- mean_yield_stats_X2_22_23 %>%  # extract the max yield of the active period
  filter( X2.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X2_22_23 <- summer_22_23 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X2.ETR),
    max_ETR = max(X2.ETR),
    min_ETR = min(X2.ETR)))

(mean_ETR_active_X2_22_23 <- mean_ETR_stats_X2_22_23 %>%  # extract the mean ETR of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X2_22_23 <- mean_ETR_stats_X2_22_23 %>%  # extract the mean ETR of the active period
  filter( X2.Active == TRUE) %>% 
  select( max_ETR))

```

#### 5.3. Monthly

```{r}
(month_Y_stats_X2 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_Y= mean(X2.Y),
            max_Y = max(X2.Y),  # get the maximum temperature
            min_Y = min(X2.Y)))


write.xlsx(month_Y_stats_X2, file = "stats/bryum/month_Y_stats_X2.xlsx") # save table

(month_ETR_stats_X2 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_ETR= mean(X2.ETR),
            max_ETR = max(X2.ETR),  # get the maximum temperature
            min_ETR = min(X2.ETR)))


write.xlsx(month_ETR_stats_X2, file = "stats/bryum/month_ETR_stats_X2.xlsx") # save table
```

## 9.4. Bryum (X4)

### 1. Create columns for activity

```{r}
data_clean <- data_clean %>% 
  mutate(X4.Active = if_else(X4.chosen_yield > 0, TRUE, FALSE))  # If the yield is above 0 the plant is active = TRUE

data_clean_23 <- data_clean_23 %>% 
  mutate(X4.Active = if_else(X4.Y > 0, TRUE, FALSE)) 

summer_19_20 <- summer_19_20 %>% 
  mutate(X4.Active = if_else(X4.Y > 0, TRUE, FALSE)) 

summer_20_21 <- summer_20_21 %>% 
  mutate(X4.Active = if_else(X4.Y > 0, TRUE, FALSE)) 

summer_21_22 <- summer_21_22 %>% 
  mutate(X4.Active = if_else(X4.chosen_yield > 0, TRUE, FALSE)) 

summer_22_23 <- summer_22_23 %>% 
  mutate(X4.Active = if_else(X4.chosen_yield > 0, TRUE, FALSE)) 
```

### 2. Active time

#### 2.1. Active total time

```{r}
# Active total time

(total_activetime_stats_X4 <- bind_rows(  # put both counts into one dataset
  data_clean %>% count(Condition = X4.Active == TRUE, name = "Count_data_clean"),  # Count rows with active time (1 row = 1 hour)
  data_clean_23 %>% count(Condition = X4.Active == TRUE, name = "Count_data_clean_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum) %>%  # join rows that have the same condition (True or False)
mutate(Total_time = Count_data_clean + Count_data_clean_23)) # add both columns to get the total active time of the year
  
(total_active_hours_X4 <- total_activetime_stats_X4 %>% # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Total_time))

(Percentage_active_days_X4 <- total_active_hours_X4/(nrow(data_clean) + nrow(data_clean_23)) * 100) # calculate the percentage 
```

#### 2.2. Active time each summer

```{r}
# Active time each summer

(summer_activetime_stats_X4 <-bind_rows(
  summer_19_20 %>% count(Condition = X4.Active == TRUE, name = "Count_19_20"), # Count rows in summer 20_21 with active time (1 row = 1 hour) // no chosen yield  becaue didn't make any ajustments
  summer_20_21 %>% count(Condition = X4.Active == TRUE, name = "Count_20_21"), # Chosen yield because made ajustments
  summer_21_22 %>% count(Condition = X4.Active == TRUE, name = "Count_21_22"),
  summer_22_23 %>% count(Condition = X4.Active == TRUE, name = "Count_22_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum))  # join rows that have the same condition (True or False)

(total_active_hours_19_20_X4 <- summer_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20))

(total_active_hours_20_21_X4 <- summer_activetime_stats_X2 %>%
  filter(Condition == TRUE) %>%
  select(Count_20_21))

(total_active_hours_21_22_X4 <- summer_activetime_stats_X2 %>%
  filter(Condition == TRUE) %>%
  select(Count_21_22))

(total_active_hours_22_23_X4 <- summer_activetime_stats_X2 %>%
  filter(Condition == TRUE) %>%
  select(Count_22_23))

(Percentage_active_hours_19_20_X4 <- total_active_hours_19_20_X4 /nrow(summer_19_20) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_X4 <- total_active_hours_20_21_X4 /nrow(summer_20_21) * 100)

(Percentage_active_hours_21_22_X4 <- total_active_hours_21_22_X4 /nrow(summer_21_22) * 100)

(Percentage_active_hours_22_23_X4 <- total_active_hours_22_23_X4 /nrow(summer_22_23) * 100)
```

#### 2.3. Active time each month

```{r}
# Active time each month

(month_activetime_stats_X4 <- bind_rows(
  summer_19_20 %>% filter(Month == 11) %>% count(Condition = X4.Active == TRUE, name = "Count_19_20_nov"),
  summer_19_20 %>% filter(Month == 12) %>% count(Condition = X4.Active == TRUE, name = "Count_19_20_dec"),
  summer_19_20 %>% filter(Month == 1) %>% count(Condition = X4.Active == TRUE, name = "Count_19_20_jan"),
  summer_19_20 %>% filter(Month == 2) %>% count(Condition = X4.Active == TRUE, name = "Count_19_20_feb"),
  summer_20_21 %>% filter(Month == 11) %>% count(Condition = X4.Active == TRUE, name = "Count_20_21_nov"),
  summer_20_21 %>% filter(Month == 12) %>% count(Condition = X4.Active == TRUE, name = "Count_20_21_dec"),
  summer_20_21 %>% filter(Month == 1) %>% count(Condition = X4.Active == TRUE, name = "Count_20_21_jan"),
  summer_20_21 %>% filter(Month == 2) %>% count(Condition = X4.Active == TRUE, name = "Count_20_21_feb"),
  summer_21_22 %>% filter(Month == 11) %>% count(Condition = X4.Active == TRUE, name = "Count_21_22_nov"),
  summer_21_22 %>% filter(Month == 12) %>% count(Condition = X4.Active == TRUE, name = "Count_21_22_dec"),
  summer_21_22 %>% filter(Month == 1) %>% count(Condition = X4.Active == TRUE, name = "Count_21_22_jan"),
  summer_21_22 %>% filter(Month == 2) %>% count(Condition = X4.Active == TRUE, name = "Count_21_22_feb"),
  summer_22_23 %>% filter(Month == 11) %>% count(Condition = X4.Active == TRUE, name = "Count_22_23_nov"),
  summer_22_23 %>% filter(Month == 12) %>% count(Condition = X4.Active == TRUE, name = "Count_22_23_dec"),
  summer_22_23 %>% filter(Month == 1) %>% count(Condition = X4.Active == TRUE, name = "Count_22_23_jan"),
  summer_22_23 %>% filter(Month == 2) %>% count(Condition = X4.Active == TRUE, name = "Count_22_23_feb")) %>% 
  group_by(Condition) %>% 
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum) %>% 
   filter(Condition == TRUE))


(total_active_hours_19_20_nov_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_19_20_nov))

(total_active_hours_19_20_dec_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_19_20_dec))

(total_active_hours_19_20_jan_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_19_20_jan))

(total_active_hours_19_20_feb_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_19_20_feb))

(total_active_hours_20_21_nov_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_20_21_nov))

(total_active_hours_20_21_dec_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_20_21_dec))

(total_active_hours_20_21_jan_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_20_21_jan))

(total_active_hours_20_21_feb_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_20_21_feb))

(total_active_hours_21_22_nov_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_21_22_nov))

(total_active_hours_21_22_dec_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_21_22_dec))

(total_active_hours_21_22_jan_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_21_22_jan))

(total_active_hours_21_22_feb_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_21_22_feb))

(total_active_hours_22_23_nov_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_nov))

(total_active_hours_22_23_dec_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_nov))

(total_active_hours_22_23_jan_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_jan))

(total_active_hours_22_23_feb_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_feb))

(Percentage_active_hours_19_20_nov_X4 <- total_active_hours_19_20_nov_X4 /nrow(summer_19_20 %>% filter(Month == 11)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_dec_X4 <- total_active_hours_19_20_dec_X4 /nrow(summer_19_20 %>% filter(Month == 12)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_jan_X4 <- total_active_hours_19_20_nov_X4 /nrow(summer_19_20 %>% filter(Month == 1)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_feb_X4 <- total_active_hours_19_20_nov_X4 /nrow(summer_19_20 %>% filter(Month == 2)) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_nov_X4 <- total_active_hours_20_21_nov_X4 /nrow(summer_20_21 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_20_21_dec_X4 <- total_active_hours_20_21_dec_X4 /nrow(summer_20_21 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_20_21_jan_X4 <- total_active_hours_20_21_jan_X4 /nrow(summer_20_21 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_20_21_feb_X4 <- total_active_hours_20_21_feb_X4 /nrow(summer_20_21 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_21_22_nov_X4 <- total_active_hours_21_22_nov_X4 /nrow(summer_21_22 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_21_22_dec_X4 <- total_active_hours_21_22_dec_X4 /nrow(summer_21_22 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_21_22_jan_X4 <- total_active_hours_21_22_jan_X4 /nrow(summer_21_22 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_21_22_feb_X4 <- total_active_hours_21_22_feb_X4 /nrow(summer_21_22 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_22_23_nov_X4 <- total_active_hours_22_23_nov_X4 /nrow(summer_22_23 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_22_23_dec_X4 <- total_active_hours_22_23_dec_X4 /nrow(summer_22_23 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_22_23_jan_X4 <- total_active_hours_22_23_jan_X4 /nrow(summer_22_23 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_22_23_feb_X4 <- total_active_hours_22_23_feb_X4 /nrow(summer_22_23 %>% filter(Month == 2)) * 100)
```

### 3. Thallus Temperature

#### 3.1. Total measuring and active time

```{r}
# Mean temperature during the whole measuring period ------------------

(mean_Temp_X4_data <- bind_rows(
  data_clean  %>% select(X4.Temp), 
  data_clean_23  %>% select(X4.Temp)) %>% 
  summarise(mean_temp = mean(X4.Temp),
            max_temp = max(X4.Temp),  # get the maximum temperature
            min_temp = min(X4.Temp)))  # get the minimum temperature

# Mean temperature whole active period-------------------

(mean_Temp_active_X4_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X4.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X4.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_temp = mean(X4.Temp),
    max_temp = max(X4.Temp),
    min_temp = min(X4.Temp)))  # calculate the mean Temp of the active period

(mean_Temp_active_X4 <- mean_Temp_active_X4_data %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_temp))


```

#### 3.2. Summer Temperature

```{r}
# Mean temperature summer 19-20

(mean_Temp_stats_X4_19_20 <- summer_19_20  %>%  # Mean Temp for 19-20
    select(X4.Temp) %>% 
  summarise(mean_temp = mean(X4.Temp),
            max_temp = max(X4.Temp),  # get the maximum temperature
            min_temp = min(X4.Temp)))  # get the minimum temperature

(mean_Temp_X4_19_20 <- mean_Temp_stats_X4_19_20 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X4_19_20 <- mean_Temp_stats_X4_19_20 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X4_19_20 <- mean_Temp_stats_X4_19_20 %>%  # extract the min Temp of the active period
    select(min_temp)) 

# Mean temperature summer 19-20 active 

(mean_Temp_active_stats_X4_19_20 <- summer_19_20 %>%  # Mean Temp for active 19-20
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X4.Temp),
    max_temp = max(X4.Temp),
    min_temp = min(X4.Temp)))

(mean_Temp_active_X4_19_20 <- mean_Temp_active_stats_X4_19_20 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X4_19_20 <- mean_Temp_active_stats_X4_19_20 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( max_temp))

(min_Temp_active_X4_19_20 <- mean_Temp_active_stats_X4_19_20 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( min_temp))

# Mean temperature summer 20-21

(mean_Temp_stats_X4_20_21 <- summer_20_21  %>%  # Mean Temp for 20-21
    select(X4.Temp) %>% 
  summarise(mean_temp = mean(X4.Temp),
            max_temp = max(X4.Temp),  # get the maximum temperature
            min_temp = min(X4.Temp)))  # get the minimum temperature

(mean_Temp_X4_20_21 <- mean_Temp_stats_X4_20_21 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X4_20_21 <- mean_Temp_stats_X4_20_21 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X4_20_21 <- mean_Temp_stats_X4_20_21 %>%  # extract the min Temp of the active period
    select(min_temp))

# Mean temperature summer 20-21 active

(mean_Temp_active_stats_X4_20_21 <- summer_20_21 %>% # Mean Temp for active 20-21
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X4.Temp),
    max_temp = max(X4.Temp),
    min_temp = min(X4.Temp)))

(mean_Temp_active_X4_20_21 <- mean_Temp_active_stats_X4_20_21 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X4_20_21 <- mean_Temp_active_stats_X4_20_21 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_temp))

(min_Temp_active_X4_20_21 <- mean_Temp_active_stats_X4_20_21 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( min_temp))

# Mean temperature summer 21-22

(mean_Temp_stats_X4_21_22 <- summer_21_22  %>%  # Mean Temp for 21-22
    select(X4.Temp) %>% 
  summarise(mean_temp = mean(X4.Temp),
            max_temp = max(X4.Temp),  # get the maximum temperature
            min_temp = min(X4.Temp)))  # get the minimum temperature

(mean_Temp_X4_21_22 <- mean_Temp_stats_X4_21_22 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X4_21_22 <- mean_Temp_stats_X4_21_22 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X4_21_22 <- mean_Temp_stats_X4_21_22 %>%  # extract the min Temp of the active period
    select(min_temp))

# Mean temperature summer 21-22 active

(mean_Temp_active_stats_X4_21_22 <- summer_21_22 %>% # Mean Temp for active 21-22
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X4.Temp),
    max_temp = max(X4.Temp),
    min_temp = min(X4.Temp)))

(mean_Temp_active_X4_21_22 <- mean_Temp_active_stats_X4_21_22 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X4_21_22 <- mean_Temp_active_stats_X4_21_22 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_temp))

(min_Temp_active_X4_21_22 <- mean_Temp_active_stats_X4_21_22 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( min_temp))

# Mean temperature summer 22-23

(mean_Temp_stats_X4_22_23 <- summer_22_23  %>%  # Mean Temp for 22-23
    select(X4.Temp) %>% 
  summarise(mean_temp = mean(X4.Temp),
            max_temp = max(X4.Temp),  # get the maximum temperature
            min_temp = min(X4.Temp)))  # get the minimum temperature

(mean_Temp_X4_22_23 <- mean_Temp_stats_X4_22_23 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_X4_22_23 <- mean_Temp_stats_X4_22_23 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_X4_22_23 <- mean_Temp_stats_X4_22_23 %>%  # extract the min Temp of the active period
    select(min_temp))

# Mean temperature summer 22-23 active

(mean_Temp_active_stats_X4_22_23 <- summer_22_23 %>% # Mean Temp for active 22-23
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X4.Temp),
    max_temp = max(X4.Temp),
    min_temp = min(X4.Temp)))

(mean_Temp_active_X4_22_23 <- mean_Temp_active_stats_X4_22_23 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_X4_22_23 <- mean_Temp_active_stats_X4_22_23 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_temp))

(min_Temp_active_X4_22_23 <- mean_Temp_active_stats_X4_22_23 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( min_temp))
```

#### 3.3. Monthly temperature

```{r}

(month_temp_stats_X4 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X4.Temp),
            max_temp = max(X4.Temp),  # get the maximum temperature
            min_temp = min(X4.Temp)))

write.xlsx(month_temp_stats_X4, file = "stats/bryum/month_temp_stats_X4.xlsx") # save table

(month_active_temp_stats_X4 <- bind_rows(  # Monthly stats for active period
  summer_19_20 %>% filter(Month == 11, X4.Active == TRUE),
  summer_19_20 %>% filter(Month == 12, X4.Active == TRUE),
  summer_19_20 %>% filter(Month == 1, X4.Active == TRUE),
  summer_19_20 %>% filter(Month == 2, X4.Active == TRUE),
  summer_20_21 %>% filter(Month == 11, X4.Active == TRUE),
  summer_20_21 %>% filter(Month == 12, X4.Active == TRUE),
  summer_20_21 %>% filter(Month == 1, X4.Active == TRUE),
  summer_20_21 %>% filter(Month == 2, X4.Active == TRUE),
  summer_21_22 %>% filter(Month == 11, X4.Active == TRUE),
  summer_21_22 %>% filter(Month == 12, X4.Active == TRUE),
  summer_21_22 %>% filter(Month == 1, X4.Active == TRUE),
  summer_21_22 %>% filter(Month == 2, X4.Active == TRUE),
  summer_22_23 %>% filter(Month == 11, X4.Active == TRUE),
  summer_22_23 %>% filter(Month == 12, X4.Active == TRUE),
  summer_22_23 %>% filter(Month == 1, X4.Active == TRUE),
  summer_22_23 %>% filter(Month == 2, X4.Active == TRUE)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X4.Temp),
            max_temp = max(X4.Temp),  # get the maximum temperature
            min_temp = min(X4.Temp)))

write.xlsx(month_active_temp_stats_X4, file = "stats/bryum/month_active_temp_stats_X4.xlsx") # save table
```

### 4. PAR

```{r}
# Active period----

(mean_PAR_active_X4_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X4.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X4.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_PAR = mean(X4.PAR),
    max_PAR = max(X4.PAR),
    min_PAR = min(X4.PAR)))  # calculate the mean PAR of the active period

```

#### 4.2. Summerly PAR

```{r}
# Mean PAR summer 19-20

(mean_PAR_stats_X4_19_20 <- summer_19_20 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X4.PAR),
    max_PAR = max(X4.PAR),
    min_PAR = min(X4.PAR)))

(mean_PAR_active_X4_19_20 <- mean_PAR_stats_X4_19_20 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X4_19_20 <- mean_PAR_stats_X4_19_20 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X4_19_20 <- mean_PAR_stats_X4_19_20 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( min_PAR))

# Mean temperature summer 20-21

(mean_PAR_stats_X4_20_21 <- summer_20_21 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X4.PAR),
    max_PAR = max(X4.PAR),
    min_PAR = min(X4.PAR)))

(mean_PAR_active_X4_20_21 <- mean_PAR_stats_X4_20_21 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X4_20_21 <- mean_PAR_stats_X4_20_21 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X4_20_21 <- mean_PAR_stats_X4_20_21 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( min_PAR))

# Mean temperature summer 21-22

(mean_PAR_stats_X4_21_22 <- summer_21_22 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X4.PAR),
    max_PAR = max(X4.PAR),
    min_PAR = min(X4.PAR)))

(mean_PAR_active_X4_21_22 <- mean_PAR_stats_X4_21_22 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X4_21_22 <- mean_PAR_stats_X4_21_22 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X4_21_22 <- mean_PAR_stats_X4_21_22 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( min_PAR))

# Mean temperature summer 22-23

(mean_PAR_stats_X4_22_23 <- summer_22_23 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X4.PAR),
    max_PAR = max(X4.PAR),
    min_PAR = min(X4.PAR)))

(mean_PAR_active_X4_22_23 <- mean_PAR_stats_X4_22_23 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_X4_22_23 <- mean_PAR_stats_X4_22_23 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_X4_22_23 <- mean_PAR_stats_X4_22_23 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( min_PAR))

```

#### 4.3. Monthly PAR

```{r}
(month_PAR_stats_X4 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_PAR = mean(X4.PAR),
            max_PAR = max(X4.PAR),  # get the maximum temperature
            min_PAR = min(X4.PAR)))

write.xlsx(month_PAR_stats_X4, file = "stats/bryum/month_PAR_stats_X4.xlsx") # save table
```


### 5. YIELD and ETR

```{r}
# Active period----

(mean_yield_active_X4_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X4.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X4.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_Y = mean(X4.Y),
    max_Y = max(X4.Y),
    min_Y = min(X4.Y)))  # calculate the mean yield of the active period

(mean_ETR_active_X4_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X4.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X4.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_ETR = mean(X4.ETR),
    max_ETR = max(X4.ETR),
    min_ETR = min(X4.ETR)))  # calculate the mean ETR of the active period

```

#### 5.2 Summer yield/ ETR

```{r}
# Mean YIED/ETR summer 19-20

(mean_yield_stats_X4_19_20 <- summer_19_20 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X4.Y),
    max_Y = max(X4.Y),
    min_Y = min(X4.Y)))

(mean_Y_active_X4_19_20 <- mean_yield_stats_X4_19_20 %>%  # extract the mean yield of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X4_19_20 <- mean_yield_stats_X4_19_20 %>%  # extract the max yield of the active period
  filter( X4.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X4_19_20 <- summer_19_20 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X4.ETR),
    max_ETR = max(X4.ETR),
    min_ETR = min(X4.ETR)))

(mean_ETR_active_X4_19_20 <- mean_ETR_stats_X4_19_20 %>%  # extract the mean ETR of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X4_19_20 <- mean_ETR_stats_X4_19_20 %>%  # extract the mean ETR of the active period
  filter( X4.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIED/ETR summer 20-21

(mean_yield_stats_X4_20_21 <- summer_20_21 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X4.Y),
    max_Y = max(X4.Y),
    min_Y = min(X4.Y)))

(mean_Y_active_X4_20_21 <- mean_yield_stats_X4_20_21 %>%  # extract the mean yield of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X4_20_21 <- mean_yield_stats_X4_20_21 %>%  # extract the max yield of the active period
  filter( X4.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X4_20_21 <- summer_20_21 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X4.ETR),
    max_ETR = max(X4.ETR),
    min_ETR = min(X4.ETR)))

(mean_ETR_active_X4_20_21 <- mean_ETR_stats_X4_20_21 %>%  # extract the mean ETR of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X4_20_21 <- mean_ETR_stats_X4_20_21 %>%  # extract the mean ETR of the active period
  filter( X4.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIED/ETR summer 21-22

(mean_yield_stats_X4_21_22 <- summer_21_22 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X4.chosen_yield),
    max_Y = max(X4.chosen_yield),
    min_Y = min(X4.chosen_yield)))

(mean_Y_active_X4_21_22 <- mean_yield_stats_X4_21_22 %>%  # extract the mean yield of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X4_21_22 <- mean_yield_stats_X4_21_22 %>%  # extract the max yield of the active period
  filter( X4.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X4_21_22 <- summer_21_22 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X4.chosen_ETR),
    max_ETR = max(X4.chosen_ETR),
    min_ETR = min(X4.chosen_ETR)))

(mean_ETR_active_X4_21_22 <- mean_ETR_stats_X4_21_22 %>%  # extract the mean ETR of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X4_21_22 <- mean_ETR_stats_X4_21_22 %>%  # extract the mean ETR of the active period
  filter( X4.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIED/ETR summer 22-23

(mean_yield_stats_X4_22_23 <- summer_22_23 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X4.chosen_yield),
    max_Y = max(X4.chosen_yield),
    min_Y = min(X4.chosen_yield)))

(mean_Y_active_X4_22_23 <- mean_yield_stats_X4_22_23 %>%  # extract the mean yield of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_X4_22_23 <- mean_yield_stats_X4_22_23 %>%  # extract the max yield of the active period
  filter( X4.Active == TRUE) %>% 
  select( max_Y))


(mean_ETR_stats_X4_22_23 <- summer_22_23 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X4.chosen_ETR),
    max_ETR = max(X4.chosen_ETR),
    min_ETR = min(X4.chosen_ETR)))

(mean_ETR_active_X4_22_23 <- mean_ETR_stats_X4_22_23 %>%  # extract the mean ETR of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_X4_22_23 <- mean_ETR_stats_X4_22_23 %>%  # extract the mean ETR of the active period
  filter( X4.Active == TRUE) %>% 
  select( max_ETR))

```

#### 5.3. Monthly

```{r}
(month_Y_stats_X4 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_Y= mean(X4.Y),
            max_Y = max(X4.Y),  # get the maximum temperature
            min_Y = min(X4.Y)))

write.xlsx(month_Y_stats_X4, file = "stats/bryum/month_Y_stats_X4.xlsx") # save table

(month_ETR_stats_X4 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_ETR= mean(X4.ETR),
            max_ETR = max(X4.ETR),  # get the maximum temperature
            min_ETR = min(X4.ETR)))

write.xlsx(month_ETR_stats_X4, file = "stats/bryum/month_ETR_stats_X4.xlsx") # save table

```


## 9.5. Average Bryum

### 1. Active time

```{r}
(list_act_time <- list(total_activetime_stats_X1,total_activetime_stats_X2, total_activetime_stats_X4)) # put all datasets in a list
(total_activetime_stats_moss <- Reduce(`+`, list_act_time)/length(list_act_time)) # average them 

(total_active_hours_moss <- total_activetime_stats_moss %>% # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Total_time))

(percentage_active_days_moss <- total_active_hours_moss/(nrow(data_clean) + nrow(data_clean_23)) * 100)
```

#### 1.2 Active time each summer

```{r}
(list_act_time_summer <- list(summer_activetime_stats_X1,summer_activetime_stats_X2, summer_activetime_stats_X3)) # put all datasets in a list
(summer_activetime_stats_moss <- Reduce(`+`, list_act_time_summer)/length(list_act_time)) # average them 
```

#### 1.3 Active time each month

```{r}
(list_act_time_summer <- list(summer_activetime_stats_X1,summer_activetime_stats_X2, summer_activetime_stats_X3)) # put all datasets in a list
(summer_activetime_stats_moss <- Reduce(`+`, list_act_time_summer)/length(list_act_time)) # average them 

(total_active_hours_19_20_moss <- summer_activetime_stats_moss %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20))

(total_active_hours_20_21_moss <- summer_activetime_stats_moss %>%
  filter(Condition == TRUE) %>%
  select(Count_20_21))

(total_active_hours_21_22_moss <- summer_activetime_stats_moss %>%
  filter(Condition == TRUE) %>%
  select(Count_21_22))

(total_active_hours_22_23_moss <- summer_activetime_stats_moss %>%
  filter(Condition == TRUE) %>%
  select(Count_22_23))

(Percentage_active_hours_19_20_moss <- total_active_hours_19_20_moss /nrow(summer_19_20) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_moss <- total_active_hours_20_21_moss /nrow(summer_20_21) * 100)

(Percentage_active_hours_21_22_moss <- total_active_hours_21_22_moss /nrow(summer_21_22) * 100)

(Percentage_active_hours_22_23_moss <- total_active_hours_22_23_moss /nrow(summer_22_23) * 100)

```

### 3. Thallus Temperature

#### 3.1. Total measuring and active time

```{r}
# Mean temperature during the whole measuring period ------------------

(list_measuring_temp_moss <-list(mean_Temp_X1_data, mean_Temp_X2_data, mean_Temp_X4_data)) # put all datasets in a list
(mean_Temp_moss_data <- Reduce(`+`, list_measuring_temp_moss)/length(list_measuring_temp_moss)) # average them 

# Mean temperature whole active period-------------------

(list_active_temp_moss <-list(mean_Temp_active_X1_data, mean_Temp_active_X2_data, mean_Temp_active_X4_data)) # put all datasets in a list
(mean_Temp_active_moss_data <- Reduce(`+`, list_active_temp_moss)/length(list_active_temp_moss)) # average them 

```

#### 3.2. Summer Temperature

```{r}
# Mean temperature summer 19-20

(list_measuring_temp_moss_19_20 <-list(mean_Temp_stats_X1_19_20, mean_Temp_stats_X2_19_20, mean_Temp_stats_X4_19_20)) # put all measuring datasets in a list
(mean_Temp_moss_data_19_20 <- Reduce(`+`, list_measuring_temp_moss_19_20)/length(list_measuring_temp_moss_19_20)) # average them 

(mean_Temp_moss_19_20 <- mean_Temp_moss_data_19_20 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_moss_19_20 <- mean_Temp_moss_data_19_20 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_moss_19_20 <- mean_Temp_moss_data_19_20 %>%  # extract the min Temp of the active period
    select(min_temp))


(list_active_temp_moss_19_20 <-list(mean_Temp_active_stats_X1_19_20, mean_Temp_active_stats_X2_19_20, mean_Temp_active_stats_X4_19_20)) # put all active datasets in a list
(mean_active_Temp_moss_data_19_20 <- Reduce(`+`, list_active_temp_moss_19_20)/length(list_active_temp_moss_19_20)) # average them 

(mean_Temp_active_moss_19_20 <- mean_active_Temp_moss_data_19_20 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_moss_19_20 <- mean_active_Temp_moss_data_19_20 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_temp))

(min_Temp_active_moss_19_20 <- mean_active_Temp_moss_data_19_20 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_temp))


# Mean temperature summer 20-21

(list_measuring_temp_moss_20_21 <-list(mean_Temp_stats_X1_20_21, mean_Temp_stats_X2_20_21, mean_Temp_stats_X4_20_21)) # put all measuring datasets in a list
(mean_Temp_moss_data_20_21 <- Reduce(`+`, list_measuring_temp_moss_20_21)/length(list_measuring_temp_moss_20_21)) # average them 

(mean_Temp_moss_20_21 <- mean_Temp_moss_data_20_21 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_moss_20_21 <- mean_Temp_moss_data_20_21 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_moss_20_21 <- mean_Temp_moss_data_20_21 %>%  # extract the min Temp of the active period
    select(min_temp))


(list_active_temp_moss_20_21 <-list(mean_Temp_active_stats_X1_20_21, mean_Temp_active_stats_X2_20_21, mean_Temp_active_stats_X4_20_21)) # put all active datasets in a list
(mean_Temp_moss_data_20_21 <- Reduce(`+`, list_active_temp_moss_20_21)/length(list_active_temp_moss_20_21)) # average them 

(mean_Temp_active_moss_20_21 <- mean_Temp_moss_data_20_21 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_moss_20_21 <- mean_Temp_moss_data_20_21 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

(min_Temp_active_moss_20_21 <- mean_Temp_moss_data_20_21 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_temp))

# Mean temperature summer 21-22

(list_measuring_temp_moss_21_22 <-list(mean_Temp_stats_X1_21_22, mean_Temp_stats_X2_21_22, mean_Temp_stats_X4_21_22)) # put all measuring datasets in a list
(mean_Temp_moss_data_21_22 <- Reduce(`+`, list_measuring_temp_moss_21_22)/length(list_measuring_temp_moss_21_22)) # average them 

(mean_Temp_moss_21_22 <- mean_Temp_moss_data_21_22 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_moss_21_22 <- mean_Temp_moss_data_21_22 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_moss_21_22 <- mean_Temp_moss_data_21_22 %>%  # extract the min Temp of the active period
    select(min_temp))


(list_active_temp_moss_21_22 <-list(mean_Temp_active_stats_X1_21_22, mean_Temp_active_stats_X2_21_22, mean_Temp_active_stats_X4_21_22)) # put all active datasets in a list
(mean_Temp_moss_data_21_22 <- Reduce(`+`, list_active_temp_moss_21_22)/length(list_active_temp_moss_21_22)) # average them 

(mean_Temp_active_moss_21_22 <- mean_Temp_moss_data_21_22 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_moss_21_22 <- mean_Temp_moss_data_21_22 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

(min_Temp_active_moss_21_22 <- mean_Temp_moss_data_21_22 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_temp))

# Mean temperature summer 22-23

(list_measuring_temp_moss_22_23 <-list(mean_Temp_stats_X1_22_23, mean_Temp_stats_X2_22_23, mean_Temp_stats_X4_22_23)) # put all measuring datasets in a list
(mean_Temp_moss_data_22_23 <- Reduce(`+`, list_measuring_temp_moss_22_23)/length(list_measuring_temp_moss_22_23)) # average them 

(mean_Temp_moss_22_23 <- mean_Temp_moss_data_22_23 %>%  # extract the mean Temp of the measuring period
    select(mean_temp)) 
(max_Temp_moss_22_23 <- mean_Temp_moss_data_22_23 %>%  # extract the max Temp of the measuring period
    select(max_temp)) 
(min_Temp_moss_22_23 <- mean_Temp_moss_data_22_23 %>%  # extract the min Temp of the active period
    select(min_temp))

(list_active_temp_moss_22_23 <-list(mean_Temp_active_stats_X1_22_23, mean_Temp_active_stats_X2_22_23, mean_Temp_active_stats_X4_22_23)) # put all active datasets in a list
(mean_Temp_active_moss_data_22_23 <- Reduce(`+`, list_active_temp_moss_22_23)/length(list_active_temp_moss_22_23)) # average them 

(mean_Temp_active_moss_22_23 <- mean_Temp_active_moss_data_22_23 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

(max_Temp_active_moss_22_23 <- mean_Temp_active_moss_data_22_23 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

(min_Temp_active_moss_22_23 <- mean_Temp_active_moss_data_22_23 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_temp))
```

#### 3.3. Month Temperature

```{r}
(list_measuring_month_temp_moss <-list(month_temp_stats_X1, month_temp_stats_X2, month_temp_stats_X4)) # put all datasets in a list
(mean_measuring_Temp_moss_month_data <- Reduce(`+`, list_measuring_month_temp_moss)/length(list_measuring_month_temp_moss)) # average them 

write.xlsx(mean_measuring_Temp_moss_month_data, file = "stats/bryum/mean_measuring_Temp_moss_month_data.xlsx") # save table

(list_active_month_temp_moss <-list(month_active_temp_stats_X1, month_active_temp_stats_X2, month_active_temp_stats_X4)) # put all datasets in a list
# (mean_active_Temp_moss_month_data <- Reduce(`+`, list_active_month_temp_moss)/length(list_active_month_temp_moss)) # average them 

# Not all the samples are active at the same time, so not all the datasets have the same rows, so they cannot be averaged like this

# write.xlsx(mean_active_Temp_moss_month_data, file = "stats/bryum/mean_active_Temp_moss_month_data.xlsx") # save table
```

### 4.PAR

```{r}
(list_measuring_PAR_moss <-list(mean_PAR_active_X1_data, mean_PAR_active_X2_data, mean_PAR_active_X4_data)) # put all datasets in a list
(mean_measuring_PAR_moss <- Reduce(`+`, list_measuring_PAR_moss)/length(list_measuring_PAR_moss)) # average them 

```

#### 4.2. Summerly PAR

```{r}
(list_measuring_PAR_moss_19_20 <-list(mean_PAR_stats_X1_19_20, mean_PAR_stats_X2_19_20, mean_PAR_stats_X4_19_20)) # put all datasets in a list
(mean_measuring_PAR_moss_19_20 <- Reduce(`+`, list_measuring_PAR_moss_19_20)/length(list_measuring_PAR_moss_19_20)) # average them 

(mean_PAR_active_moss_19_20 <- mean_measuring_PAR_moss_19_20 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_moss_19_20 <- mean_measuring_PAR_moss_19_20 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_moss_19_20 <- mean_measuring_PAR_moss_19_20 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_PAR))

(list_measuring_PAR_moss_20_21 <-list(mean_PAR_stats_X1_20_21, mean_PAR_stats_X2_20_21, mean_PAR_stats_X4_20_21)) # put all datasets in a list
(mean_measuring_PAR_moss_20_21 <- Reduce(`+`, list_measuring_PAR_moss_20_21)/length(list_measuring_PAR_moss_20_21)) # average them 

(mean_PAR_active_moss_20_21 <- mean_measuring_PAR_moss_20_21 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_moss_20_21 <- mean_measuring_PAR_moss_20_21 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_moss_20_21 <- mean_measuring_PAR_moss_20_21 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_PAR))

(list_measuring_PAR_moss_21_22 <-list(mean_PAR_stats_X1_21_22, mean_PAR_stats_X2_21_22, mean_PAR_stats_X4_21_22)) # put all datasets in a list
(mean_measuring_PAR_moss_21_22 <- Reduce(`+`, list_measuring_PAR_moss_21_22)/length(list_measuring_PAR_moss_21_22)) # average them 

(mean_PAR_active_moss_21_22 <- mean_measuring_PAR_moss_21_22 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_moss_21_22 <- mean_measuring_PAR_moss_21_22 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_moss_21_22 <- mean_measuring_PAR_moss_21_22 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_PAR))

(list_measuring_PAR_moss_22_23 <-list(mean_PAR_stats_X1_22_23, mean_PAR_stats_X2_22_23, mean_PAR_stats_X4_22_23)) # put all datasets in a list
(mean_measuring_PAR_moss_22_23 <- Reduce(`+`, list_measuring_PAR_moss_22_23)/length(list_measuring_PAR_moss_22_23)) # average them 

(mean_PAR_active_moss_22_23 <- mean_measuring_PAR_moss_22_23 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_PAR))

(max_PAR_active_moss_22_23 <- mean_measuring_PAR_moss_22_23 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_PAR))

(min_PAR_active_moss_22_23 <- mean_measuring_PAR_moss_22_23 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( min_PAR))
```

#### 4.3. Monthly PAR

```{r}
(list_measuring_monthly_PAR_moss <-list(month_PAR_stats_X1, month_PAR_stats_X2, month_PAR_stats_X4)) # put all datasets in a list
(mean_measuring_monthly_PAR_moss <- Reduce(`+`, list_measuring_monthly_PAR_moss)/length(list_measuring_monthly_PAR_moss)) # average them 

write.xlsx(mean_measuring_monthly_PAR_moss, file = "stats/bryum/mean_measuring_monthly_PAR_moss.xlsx") # save table
```

### 5. YIELD and ETR

```{r}
# Active period----

(list_measuring_active_yield_moss <-list(mean_yield_active_X1_data, mean_yield_active_X2_data, mean_yield_active_X4_data)) # put all datasets in a list
(mean_measuring_active_yield_moss <- Reduce(`+`, list_measuring_active_yield_moss)/length(list_measuring_active_yield_moss)) # average them 

(list_measuring_active_ETR_moss <-list(mean_ETR_active_X1_data, mean_ETR_active_X2_data, mean_ETR_active_X4_data)) # put all datasets in a list
(mean_measuring_active_ETR_moss <- Reduce(`+`, list_measuring_active_yield_moss)/length(list_measuring_active_yield_moss)) # average them 

```

#### 5.2 Summer yield/ ETR

```{r}
# Mean YIED/ETR summer 19-20

(list_measuring_active_yield_moss_19_20 <-list(mean_yield_stats_X1_19_20, mean_yield_stats_X2_19_20, mean_yield_stats_X4_19_20)) # put all datasets in a list
(mean_measuring_active_yield_moss_19_20 <- Reduce(`+`, list_measuring_active_yield_moss_19_20)/length(list_measuring_active_yield_moss_19_20)) # average them 

(mean_Y_active_moss_19_20 <- mean_measuring_active_yield_moss_19_20 %>%  # extract the mean yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_moss_19_20 <- mean_measuring_active_yield_moss_19_20 %>%  # extract the max yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_Y))

(list_measuring_active_ETR_moss_19_20 <-list(mean_ETR_stats_X1_19_20, mean_ETR_stats_X2_19_20, mean_ETR_stats_X4_19_20)) # put all datasets in a list
(mean_measuring_active_ETR_moss_19_20 <- Reduce(`+`, list_measuring_active_ETR_moss_19_20)/length(list_measuring_active_ETR_moss_19_20)) # average them 

(mean_ETR_active_moss_19_20 <- mean_measuring_active_ETR_moss_19_20 %>%  # extract the mean yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_moss_19_20 <- mean_measuring_active_ETR_moss_19_20 %>%  # extract the max yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIELD/ETR summer 20-21

(list_measuring_active_yield_moss_20_21 <-list(mean_yield_stats_X1_20_21, mean_yield_stats_X2_20_21, mean_yield_stats_X4_20_21)) # put all datasets in a list
(mean_measuring_active_yield_moss_20_21 <- Reduce(`+`, list_measuring_active_yield_moss_20_21)/length(list_measuring_active_yield_moss_20_21)) # average them 

(mean_Y_active_moss_20_21 <- mean_measuring_active_yield_moss_20_21 %>%  # extract the mean yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_moss_20_21 <- mean_measuring_active_yield_moss_20_21 %>%  # extract the max yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_Y))

(list_measuring_active_ETR_moss_20_21 <-list(mean_ETR_stats_X1_20_21, mean_ETR_stats_X2_20_21, mean_ETR_stats_X4_20_21)) # put all datasets in a list
(mean_measuring_active_ETR_moss_20_21 <- Reduce(`+`, list_measuring_active_ETR_moss_20_21)/length(list_measuring_active_ETR_moss_20_21)) # average them 

(mean_ETR_active_moss_20_21 <- mean_measuring_active_ETR_moss_20_21 %>%  # extract the mean yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_moss_20_21 <- mean_measuring_active_ETR_moss_20_21 %>%  # extract the max yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIED/ETR summer 21-22

(list_measuring_active_yield_moss_21_22 <-list(mean_yield_stats_X1_21_22, mean_yield_stats_X2_21_22, mean_yield_stats_X4_21_22)) # put all datasets in a list
(mean_measuring_active_yield_moss_21_22 <- Reduce(`+`, list_measuring_active_yield_moss_21_22)/length(list_measuring_active_yield_moss_21_22)) # average them 

(mean_Y_active_moss_21_22 <- mean_measuring_active_yield_moss_21_22 %>%  # extract the mean yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_moss_21_22 <- mean_measuring_active_yield_moss_21_22 %>%  # extract the max yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_Y))

(list_measuring_active_ETR_moss_21_22 <-list(mean_ETR_stats_X1_21_22, mean_ETR_stats_X2_21_22, mean_ETR_stats_X4_21_22)) # put all datasets in a list
(mean_measuring_active_ETR_moss_21_22 <- Reduce(`+`, list_measuring_active_ETR_moss_21_22)/length(list_measuring_active_ETR_moss_21_22)) # average them 

(mean_ETR_active_moss_21_22 <- mean_measuring_active_ETR_moss_21_22 %>%  # extract the mean yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_moss_21_22 <- mean_measuring_active_ETR_moss_21_22 %>%  # extract the max yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_ETR))

# Mean YIED/ETR summer 22-23

(list_measuring_active_yield_moss_22_23 <-list(mean_yield_stats_X1_22_23, mean_yield_stats_X2_22_23, mean_yield_stats_X4_22_23)) # put all datasets in a list
(mean_measuring_active_yield_moss_22_23 <- Reduce(`+`, list_measuring_active_yield_moss_22_23)/length(list_measuring_active_yield_moss_22_23)) # average them 

(mean_Y_active_moss_22_23 <- mean_measuring_active_yield_moss_22_23 %>%  # extract the mean yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_Y))

(max_Y_active_moss_22_23 <- mean_measuring_active_yield_moss_22_23 %>%  # extract the max yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_Y))

(list_measuring_active_ETR_moss_22_23 <-list(mean_ETR_stats_X1_22_23, mean_ETR_stats_X2_22_23, mean_ETR_stats_X4_22_23)) # put all datasets in a list
(mean_measuring_active_ETR_moss_22_23 <- Reduce(`+`, list_measuring_active_ETR_moss_22_23)/length(list_measuring_active_ETR_moss_22_23)) # average them 

(mean_ETR_active_moss_22_23 <- mean_measuring_active_ETR_moss_22_23 %>%  # extract the mean yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_ETR))

(max_ETR_active_moss_22_23 <- mean_measuring_active_ETR_moss_22_23 %>%  # extract the max yield of the active period
  filter( X1.Active == TRUE) %>% 
  select( max_ETR))
```

### 5.3. Monthly

```{r}
# Yield
(list_measuring_active_yield_moss_monthly <-list(month_Y_stats_X1, month_Y_stats_X2, month_Y_stats_X4)) # put all datasets in a list
(mean_measuring_active_yield_moss_monthly <- Reduce(`+`, list_measuring_active_yield_moss_monthly)/length(list_measuring_active_yield_moss_monthly)) # average them 

write.xlsx(mean_measuring_active_yield_moss_monthly, file = "stats/bryum/mean_measuring_active_yield_moss_monthly.xlsx") # save table

# ETR

(list_measuring_active_ETR_moss_monthly <-list(month_ETR_stats_X1, month_ETR_stats_X2, month_ETR_stats_X4)) # put all datasets in a list
(mean_measuring_active_ETR_moss_monthly <- Reduce(`+`, list_measuring_active_ETR_moss_monthly)/length(list_measuring_active_ETR_moss_monthly)) # average them

write.xlsx(mean_measuring_active_ETR_moss_monthly, file = "stats/bryum/mean_measuring_active_ETR_moss_monthly.xlsx") # save table
```


## 9.6. Meteorological

1. Import and take a look at data
```{r}
data_met <- read_csv("data_meteorology_complete.csv")
skimr::skim(data_met)  # see a summary of the whole data
str(data_met)  # see the structure of each variable
tail(data_met)  # view the last 6 rows of data
head(data_met)  # view the first 6 rows of data
```
3. Structure data so it is useful

```{r}
# Clean Names and remove unnecessary columns

data_met$DateTime <- paste(data_met$Date.UTC, data_met$Time.UTC)

# Check whether there are NAs (affect calculations)

(colSums(is.na(data_met[, c("Tmean", "Tmax", "Tmin", "Rhmean")]))) # COunt number of NAs in each column
# remove NAs

# Some of the dates have data from 2 stations. Average both to get 1 useful value
data_met <- data_met %>% 
   filter(!is.na(Tmean) & !is.na(Tmax) & !is.na(Tmin) & !is.na(Rhmean)) %>% # remove NAs before grouping
  group_by(DateTime) %>% # Group by the measurements that have the same date and time
  summarise(Tmean = mean(Tmean),
            Tmax = mean(Tmax),
            Tmin = mean(Tmin),
            Rhmean = mean(Rhmean),
            Date.UTC = unique(as.Date(Date.UTC)),
            Time.UTC = unique(hms::as_hms(Time.UTC))) %>% 
  ungroup()

# check wether there are any NAs
(which(is.na(data_met$Tmean) | is.na(data_met$Tmax) | is.na(data_met$Tmin) | is.na(data_met$Rhmean))) # Gives row of NAs
# No more NAs

```

3.2. Create column for year and month

```{r}
data_met$DateTime <- as.POSIXct(data_met$DateTime, format="%d/%m/%Y %H:%M:%S", tz="UTC") # put the object as a date

data_met<- data_met %>%  # create new columns with month, year,
  mutate(Month = month(DateTime), # day, minute                     
         Year = year(DateTime),
         Day = day(DateTime),
         Hour = hour(DateTime), 
         Minute = minute(DateTime))

```

3.3. Mean temperature of the whole measuring period

```{r}
(mean_air_t_measuring_per <- data_met %>% 
  summarise(MeanT = mean(Tmean),
            MaxT =  max(Tmax),
            MinT = min(Tmin),
            Max_meanT = max(Tmean),
            Min_meanT = min(Tmean),
            mean_maxT = mean(Tmax),
            mean_minT = mean(Tmin)))

```

3.4. Mean temperature per summer

```{r}

data_met <- data_met %>% # Create a column specifying the summer
  mutate(Summer = case_when(
    Year == 2019 & Month %in% c(11,12) |  Year == 2020 & Month %in% c(1,2) ~ "Summer_19_20",
    Year == 2020 & Month %in% c(11,12) |  Year == 2021 & Month %in% c(1,2) ~ "Summer_20_21",
    Year == 2021 & Month %in% c(11,12) |  Year == 2022 & Month %in% c(1,2) ~ "Summer_21_22",
    Year == 2022 & Month %in% c(11,12) |  Year == 2023 & Month %in% c(1,2) ~ "Summer_22_23"))

(mean_air_t_summer <- data_met %>% 
  group_by(Summer) %>% 
  summarise(MeanT = mean(Tmean),
            MaxT =  max(Tmax),
            MinT = min(Tmin),
            Max_meanT = max(Tmean),
            Min_meanT = min(Tmean),
            mean_maxT = mean(Tmax),
            mean_minT = mean(Tmin)))
```

3.5. Mean temperature per month

```{r}

data_met <- data_met %>% # Create a column specifying the month-year
  mutate(Year_month = paste(Year, Month, sep = "-"))

mean_air_t_month <- data_met %>% 
  filter(!is.na(Summer)) %>%  # remove the values that are not in any summer. They aren't part of measuring period
 group_by(Year_month) %>% 
  summarise(MeanT = mean(Tmean),
            MaxT =  max(Tmax),
            MinT = min(Tmin),
            Max_meanT = max(Tmean),
            Min_meanT = min(Tmean),
            mean_maxT = mean(Tmax),
            mean_minT = mean(Tmin),
            Month = unique(Month),
            Year = unique(Year)) %>% 
  arrange(Year, Month, .by_group = TRUE) # arrange variables chronologically

write.xlsx(mean_air_t_month, file = "stats/met/mean_air_t_month.xlsx") # save table

```

3.6. Mean RH of the whole measuring period

```{r}
(mean_air_Rh_measuring_per <- data_met %>% 
  summarise(MeanRh = mean(Rhmean),
            Max_meanRh = max(Rhmean),
            Min_meanRh = min(Rhmean)))

```

3.4. Mean RH per summer

```{r}

data_met <- data_met %>% # Create a column specifying the summer
  mutate(Summer = case_when(
    Year == 2019 & Month %in% c(11,12) |  Year == 2020 & Month %in% c(1,2) ~ "Summer_19_20",
    Year == 2020 & Month %in% c(11,12) |  Year == 2021 & Month %in% c(1,2) ~ "Summer_20_21",
    Year == 2021 & Month %in% c(11,12) |  Year == 2022 & Month %in% c(1,2) ~ "Summer_21_22",
    Year == 2022 & Month %in% c(11,12) |  Year == 2023 & Month %in% c(1,2) ~ "Summer_22_23"))

(mean_air_rh_summer <- data_met %>% 
  group_by(Summer) %>% 
  summarise(MeanRh = mean(Rhmean),
            Max_meanRh = max(Rhmean),
            Min_meanRh = min(Rhmean)))
```

3.5. Mean RH per month

```{r}

data_met <- data_met %>% # Create a column specifying the month-year
  mutate(Year_month = paste(Year, Month, sep = "-"))

mean_air_rh_month <- data_met %>% 
  filter(!is.na(Summer)) %>%  # remove the values that are not in any summer. They aren't part of measuring period
 group_by(Year_month) %>% 
  summarise(MeanRh = mean(Rhmean),
            Max_meanRh = max(Rhmean),
            Min_meanRh = min(Rhmean),
            Month = unique(Month),
            Year = unique(Year)) %>% 
  arrange(Year, Month, .by_group = TRUE) # arrange variables chronologically

write.xlsx(mean_air_rh_month, file = "stats/met/mean_air_rh_month.xlsx") # save table
```

# 10. Create a table for the results

```{r}
# create a table with all the values of each summer to compare

table_2019_2020 <- data.frame(  
  Category = c(
    "Total active hours", "% active hours", "Average Thallus temp", "Min Thallus temp",
    "Max Thallus temp", "Average Thallus temp active", "Min Thallus temp active", 
    "Max Thallus temp active", "PAR", "Max Par", "MAX Yield", "Yield", "ETR", 
    "Max ETR", "mean air T", "min air T", "max air T", "RH (%)"
  ),
  Austroplaca_X3 = c(
    pull(total_active_hours_19_20_X3), pull(Percentage_active_hours_19_20_X3), # pull removes thee value from the tibble
    pull(mean_Temp_X3_19_20), pull(min_Temp_X3_19_20), pull(max_Temp_X3_19_20), 
    pull(mean_Temp_active_X3_19_20), pull(min_Temp_active_X3_19_20), 
    pull(max_Temp_active_X3_19_20), pull(mean_PAR_active_X3_19_20), 
    pull(max_PAR_active_X3_19_20), pull(max_Y_active_X3_19_20), 
    pull(mean_Y_active_X3_19_20), pull(mean_ETR_active_X3_19_20), 
    pull(max_ETR_active_X3_19_20), 0, 0, 0, 0
  ),
  Bryum_X1 = c(
    pull(total_active_hours_19_20_X1), pull(Percentage_active_hours_19_20_X1), 
    pull(mean_Temp_X1_19_20), pull(min_Temp_X1_19_20), pull(max_Temp_X1_19_20), 
    pull(mean_Temp_active_X1_19_20), pull(min_Temp_active_X1_19_20), 
    pull(max_Temp_active_X1_19_20), pull(mean_PAR_active_X1_19_20), 
    pull(max_PAR_active_X1_19_20), pull(max_Y_active_X1_19_20), 
    pull(mean_Y_active_X1_19_20), pull(mean_ETR_active_X1_19_20), 
    pull(max_ETR_active_X1_19_20), 0, 0, 0, 0
  ),
  Bryum_X2 = c(
    pull(total_active_hours_19_20_X2), pull(Percentage_active_hours_19_20_X2), 
    pull(mean_Temp_X2_19_20), pull(min_Temp_X2_19_20), pull(max_Temp_X2_19_20), 
    pull(mean_Temp_active_X2_19_20), pull(min_Temp_active_X2_19_20), 
    pull(max_Temp_active_X2_19_20), pull(mean_PAR_active_X2_19_20), 
    pull(max_PAR_active_X2_19_20), pull(max_Y_active_X2_19_20), 
    pull(mean_Y_active_X2_19_20), pull(mean_ETR_active_X2_19_20), 
    pull(max_ETR_active_X2_19_20), 0, 0, 0, 0
  ),
  Bryum_X4 = c(
    pull(total_active_hours_19_20_X4), pull(Percentage_active_hours_19_20_X4), 
    pull(mean_Temp_X4_19_20), pull(min_Temp_X4_19_20), pull(max_Temp_X4_19_20), 
    pull(mean_Temp_active_X4_19_20), pull(min_Temp_active_X4_19_20), 
    pull(max_Temp_active_X4_19_20), pull(mean_PAR_active_X4_19_20), 
    pull(max_PAR_active_X4_19_20), pull(max_Y_active_X4_19_20), 
    pull(mean_Y_active_X4_19_20), pull(mean_ETR_active_X4_19_20), 
    pull(max_ETR_active_X4_19_20), 0, 0, 0, 0
  ),
  Bryum_average = c(
    pull(total_active_hours_19_20_moss), pull(Percentage_active_hours_19_20_moss), 
    pull(mean_Temp_X4_19_20), pull(min_Temp_moss_19_20), pull(max_Temp_moss_19_20), 
    pull(mean_Temp_active_moss_19_20), pull(min_Temp_active_moss_19_20), 
    pull(max_Temp_active_moss_19_20), pull(mean_PAR_active_moss_19_20), 
    pull(max_PAR_active_moss_19_20), pull(max_Y_active_moss_19_20), 
    pull(mean_Y_active_moss_19_20), pull(mean_ETR_active_moss_19_20), 
    pull(max_ETR_active_moss_19_20), 0, 0, 0, 0
  ))

  write.xlsx(table_2019_2020, file = "stats/summers/table_2019_2020.xlsx") # save table
  
  
 table_2020_2021 <- data.frame(
  Category = c(
    "Total active hours", "% active hours", "Average Thallus temp", "Min Thallus temp",
    "Max Thallus temp", "Average Thallus temp active", "Min Thallus temp active", 
    "Max Thallus temp active", "PAR", "Max Par", "MAX Yield", "Yield", "ETR", 
    "Max ETR", "mean air T", "min air T", "max air T", "RH (%)"
  ),
  Austroplaca_X3 = c(
    pull(total_active_hours_20_21_X3), pull(Percentage_active_hours_20_21_X3), pull(mean_Temp_X3_20_21), 
    pull(min_Temp_X3_20_21), pull(max_Temp_X3_20_21), pull(mean_Temp_active_X3_20_21), 
    pull(min_Temp_active_X3_20_21), pull(max_Temp_active_X3_20_21), pull(mean_PAR_active_X3_20_21), 
    pull(max_PAR_active_X3_20_21), pull(max_Y_active_X3_20_21), pull(mean_Y_active_X3_20_21),
    pull(mean_ETR_active_X3_20_21), pull(max_ETR_active_X3_20_21), 0, 0, 0, 0
  ),
  Bryum_X1 = c(
    pull(total_active_hours_20_21_X1), pull(Percentage_active_hours_20_21_X1), pull(mean_Temp_X1_20_21), 
    pull(min_Temp_X1_20_21), pull(max_Temp_X1_20_21), pull(mean_Temp_active_X1_20_21), 
    pull(min_Temp_active_X1_20_21), pull(max_Temp_active_X1_20_21), pull(mean_PAR_active_X1_20_21), 
    pull(max_PAR_active_X1_20_21), pull(max_Y_active_X1_20_21), pull(mean_Y_active_X1_20_21),
    pull(mean_ETR_active_X1_20_21), pull(max_ETR_active_X1_20_21), 0, 0, 0, 0
  ),
  Bryum_X2 = c(
    pull(total_active_hours_20_21_X2), pull(Percentage_active_hours_20_21_X2), pull(mean_Temp_X2_20_21), 
    pull(min_Temp_X2_20_21), pull(max_Temp_X2_20_21), pull(mean_Temp_active_X2_20_21), 
    pull(min_Temp_active_X2_20_21), pull(max_Temp_active_X2_20_21), pull(mean_PAR_active_X2_20_21), 
    pull(max_PAR_active_X2_20_21), pull(max_Y_active_X2_20_21), pull(mean_Y_active_X2_20_21),
    pull(mean_ETR_active_X2_20_21), pull(max_ETR_active_X2_20_21), 0, 0, 0, 0
  ),
  Bryum_X4 = c(
    pull(total_active_hours_20_21_X4), pull(Percentage_active_hours_20_21_X4), pull(mean_Temp_X4_20_21), 
    pull(min_Temp_X4_20_21), pull(max_Temp_X4_20_21), pull(mean_Temp_active_X4_20_21), 
    pull(min_Temp_active_X4_20_21), pull(max_Temp_active_X4_20_21), pull(mean_PAR_active_X4_20_21), 
    pull(max_PAR_active_X4_20_21), pull(max_Y_active_X4_20_21), pull(mean_Y_active_X4_20_21),
    pull(mean_ETR_active_X4_20_21), pull(max_ETR_active_X4_20_21), 0, 0, 0, 0
  ),
  Bryum_average = c(
    pull(total_active_hours_20_21_moss), pull(Percentage_active_hours_20_21_moss), pull(mean_Temp_X4_20_21), 
    pull(min_Temp_moss_20_21), pull(max_Temp_moss_20_21), pull(mean_Temp_active_moss_20_21), 
    pull(min_Temp_active_moss_20_21), pull(max_Temp_active_moss_20_21), pull(mean_PAR_active_moss_20_21), 
    pull(max_PAR_active_moss_20_21), pull(max_Y_active_moss_20_21), pull(mean_Y_active_moss_20_21),
    pull(mean_ETR_active_moss_20_21), pull(max_ETR_active_moss_20_21), 0, 0, 0, 0
  ))


 write.xlsx(table_2020_2021, file = "stats/summers/table_2020_2021.xlsx") # save table 
 
  
table_2021_2022 <- data.frame(
  Category = c(
    "Total active hours", "% active hours", "Average Thallus temp", "Min Thallus temp",
    "Max Thallus temp", "Average Thallus temp active", "Min Thallus temp active", 
    "Max Thallus temp active", "PAR", "Max Par", "MAX Yield", "Yield", "ETR", 
    "Max ETR", "mean air T", "min air T", "max air T", "RH (%)"
  ),
  Austroplaca_X3 = c(
    pull(total_active_hours_21_22_X3), pull(Percentage_active_hours_21_22_X3), pull(mean_Temp_X3_21_22), 
    pull(min_Temp_X3_21_22), pull(max_Temp_X3_21_22), pull(mean_Temp_active_X3_21_22), 
    pull(min_Temp_active_X3_21_22), pull(max_Temp_active_X3_21_22), pull(mean_PAR_active_X3_21_22), 
    pull(max_PAR_active_X3_21_22), pull(max_Y_active_X3_21_22), pull(mean_Y_active_X3_21_22),
    pull(mean_ETR_active_X3_21_22), pull(max_ETR_active_X3_21_22), 0, 0, 0, 0
  ),
  Bryum_X1 = c(
    pull(total_active_hours_21_22_X1), pull(Percentage_active_hours_21_22_X1), pull(mean_Temp_X1_21_22), 
    pull(min_Temp_X1_21_22), pull(max_Temp_X1_21_22), pull(mean_Temp_active_X1_21_22), 
    pull(min_Temp_active_X1_21_22), pull(max_Temp_active_X1_21_22), pull(mean_PAR_active_X1_21_22), 
    pull(max_PAR_active_X1_21_22), pull(max_Y_active_X1_21_22), pull(mean_Y_active_X1_21_22),
    pull(mean_ETR_active_X1_21_22), pull(max_ETR_active_X1_21_22), 0, 0, 0, 0
  ),
  Bryum_X2 = c(
    pull(total_active_hours_21_22_X2), pull(Percentage_active_hours_21_22_X2), pull(mean_Temp_X2_21_22), 
    pull(min_Temp_X2_21_22), pull(max_Temp_X2_21_22), pull(mean_Temp_active_X2_21_22), 
    pull(min_Temp_active_X2_21_22), pull(max_Temp_active_X2_21_22), pull(mean_PAR_active_X2_21_22), 
    pull(max_PAR_active_X2_21_22), pull(max_Y_active_X2_21_22), pull(mean_Y_active_X2_21_22),
    pull(mean_ETR_active_X2_21_22), pull(max_ETR_active_X2_21_22), 0, 0, 0, 0
  ),
  Bryum_X4 = c(
    pull(total_active_hours_21_22_X4), pull(Percentage_active_hours_21_22_X4), pull(mean_Temp_X4_21_22), 
    pull(min_Temp_X4_21_22), pull(max_Temp_X4_21_22), pull(mean_Temp_active_X4_21_22), 
    pull(min_Temp_active_X4_21_22), pull(max_Temp_active_X4_21_22), pull(mean_PAR_active_X4_21_22), 
    pull(max_PAR_active_X4_21_22), pull(max_Y_active_X4_21_22), pull(mean_Y_active_X4_21_22),
    pull(mean_ETR_active_X4_21_22), pull(max_ETR_active_X4_21_22), 0, 0, 0, 0
  ),
  Bryum_average = c(
    pull(total_active_hours_21_22_moss), pull(Percentage_active_hours_21_22_moss), pull(mean_Temp_X4_21_22), 
    pull(min_Temp_moss_21_22), pull(max_Temp_moss_21_22), pull(mean_Temp_active_moss_21_22), 
    pull(min_Temp_active_moss_21_22), pull(max_Temp_active_moss_21_22), pull(mean_PAR_active_moss_21_22), 
    pull(max_PAR_active_moss_21_22), pull(max_Y_active_moss_21_22), pull(mean_Y_active_moss_21_22),
    pull(mean_ETR_active_moss_21_22), pull(max_ETR_active_moss_21_22), 0, 0, 0, 0
  )
)

  write.xlsx(table_2021_2022, file = "stats/summers/table_2021_2022.xlsx") # save table 

  
table_2022_2023 <- data.frame(
  Category = c(
    "Total active hours", "% active hours", "Average Thallus temp", "Min Thallus temp",
    "Max Thallus temp", "Average Thallus temp active", "Min Thallus temp active", 
    "Max Thallus temp active", "PAR", "Max Par", "MAX Yield", "Yield", "ETR", 
    "Max ETR", "mean air T", "min air T", "max air T", "RH (%)"
  ),
  Austroplaca_X3 = c(
    pull(total_active_hours_22_23_X3), pull(Percentage_active_hours_22_23_X3), pull(mean_Temp_X3_22_23), 
    pull(min_Temp_X3_22_23), pull(max_Temp_X3_22_23), pull(mean_Temp_active_X3_22_23), 
    pull(min_Temp_active_X3_22_23), pull(max_Temp_active_X3_22_23), pull(mean_PAR_active_X3_22_23), 
    pull(max_PAR_active_X3_22_23), pull(max_Y_active_X3_22_23), pull(mean_Y_active_X3_22_23),
    pull(mean_ETR_active_X3_22_23), pull(max_ETR_active_X3_22_23), 0, 0, 0, 0
  ),
  Bryum_X1 = c(
    pull(total_active_hours_22_23_X1), pull(Percentage_active_hours_22_23_X1), pull(mean_Temp_X1_22_23), 
    pull(min_Temp_X1_22_23), pull(max_Temp_X1_22_23), pull(mean_Temp_active_X1_22_23), 
    pull(min_Temp_active_X1_22_23), pull(max_Temp_active_X1_22_23), pull(mean_PAR_active_X1_22_23), 
    pull(max_PAR_active_X1_22_23), pull(max_Y_active_X1_22_23), pull(mean_Y_active_X1_22_23),
    pull(mean_ETR_active_X1_22_23), pull(max_ETR_active_X1_22_23), 0, 0, 0, 0
  ),
  Bryum_X2 = c(
    pull(total_active_hours_22_23_X2), pull(Percentage_active_hours_22_23_X2), pull(mean_Temp_X2_22_23), 
    pull(min_Temp_X2_22_23), pull(max_Temp_X2_22_23), pull(mean_Temp_active_X2_22_23), 
    pull(min_Temp_active_X2_22_23), pull(max_Temp_active_X2_22_23), pull(mean_PAR_active_X2_22_23), 
    pull(max_PAR_active_X2_22_23), pull(max_Y_active_X2_22_23), pull(mean_Y_active_X2_22_23),
    pull(mean_ETR_active_X2_22_23), pull(max_ETR_active_X2_22_23), 0, 0, 0, 0
  ),
  Bryum_X4 = c(
    pull(total_active_hours_22_23_X4), pull(Percentage_active_hours_22_23_X4), pull(mean_Temp_X4_22_23), 
    pull(min_Temp_X4_22_23), pull(max_Temp_X4_22_23), pull(mean_Temp_active_X4_22_23), 
    pull(min_Temp_active_X4_22_23), pull(max_Temp_active_X4_22_23), pull(mean_PAR_active_X4_22_23), 
    pull(max_PAR_active_X4_22_23), pull(max_Y_active_X4_22_23), pull(mean_Y_active_X4_22_23),
    pull(mean_ETR_active_X4_22_23), pull(max_ETR_active_X4_22_23), 0, 0, 0, 0
  ),
  Bryum_average = c(
    pull(total_active_hours_22_23_moss), pull(Percentage_active_hours_22_23_moss), pull(mean_Temp_X4_22_23), 
    pull(min_Temp_moss_22_23), pull(max_Temp_moss_22_23), pull(mean_Temp_active_moss_22_23), 
    pull(min_Temp_active_moss_22_23), pull(max_Temp_active_moss_22_23), pull(mean_PAR_active_moss_22_23), 
    pull(max_PAR_active_moss_22_23), pull(max_Y_active_moss_22_23), pull(mean_Y_active_moss_22_23),
    pull(mean_ETR_active_moss_22_23), pull(max_ETR_active_moss_22_23), 0, 0, 0, 0
  )
)

 write.xlsx(table_2022_2023, file = "stats/summers/table_2022_2023.xlsx") # save table 
 
```


