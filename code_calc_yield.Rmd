---
title: "code_data_changed_yield"
author: "Ainhoa"
date: "2023-12-18"
output: html_document
editor_options: 
  chunk_output_type: inline
---
##Index
1-3 set working directory, load packages and load data
4. Data formating for data 2019-2022
5. Subset data for summers 2019-2020, 2020-2021, 2021-2022
5.2 Format data set 2022-2023 and subset summer 2021-2022 and 2022-2023 
6. Make plots with yield, Calc_yield, Fm and Ft to see what is the correct measure

7. Make plots for PAR and Temperature in each summer, in each sample (check activity under snowcover). Different axis (use for characterising)




1.  Set working directory

```{r}
setwd("~/Library/CloudStorage/OneDrive-UniversityofEdinburgh/dissertation/dissertation/dissertation")
```

2.  Load packages

```{r, message=FALSE}
library(skimr)  # summary
library(tidyverse)
library(lubridate)  # dates management
library(gridExtra)  # arrange plots
library(patchwork)  # combine plots
library(hms)  # use function as.Time()
library(openxlsx) # write.xlsx 
```
2.2. Creates functions

- Function for graph asthetics

```{r, echo= TRUE, results="hide"}
theme_graphs_env_cond <- function(){
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90))+
   theme(axis.text = element_text(size = 11),  # Adjust the size as needed
          axis.title = element_text(size = 14),
        legend.text = element_text(size=14))
  }
```

3.  Load the data and see its structure

```{r}
data <- read_csv("Data_set_PAM_ScottBase_with_ calc_yield.csv") # load data until 22
data_23 <- read_csv("Datset_until_11-23_paste.csv") # load data until nov-23
skimr::skim(data)  # see a summary of the whole data
skimr::skim(data_23)
str(data)  # see the structure of each variable
str(data_23)
tail(data)  # view the last 6 rows of data
tail(data_23)
head(data)  # view the first 6 rows of data
head(data_23)
```

Data of sensors 1,2 and 4 are for the moss and 3 is for the lichen. Data is from Jan 2019 to Feb 2022. I am going to consider summer form 1 Nov to 15 Feb. I currently have data for 3 summers: 2019-2020, 2020-2021, 2021-2022.
20th-nov-2023
Added the data for summer 22-23. Find in section 5.2

## 4. Format data in a way that is going to be useful to me

4.1. Remove weird times and dates and divide the useful ones

```{r}
data_clean <- data[, -c(2:13)] %>%   # create a new data set without columns 2 to 13
  mutate(Day_cum = as.numeric(data$Date)) # maintain cumulative date but change column name to more informative one and make it numeric

data_clean <- data_clean %>% 
  mutate(Date = parse_date_time(Datetime, 'dmy HM'))   # indicate the format the date is wanted

print(data_clean[is.na(data_clean$Date), ])  # Check for rows with parsing issues\
#  Row 584 is problematic

data_clean[584, 1]<-"10/02/2019 10:08"  # Change the value to the correct one 

data_clean <- data_clean %>% 
  mutate(Date = parse_date_time(Datetime, 'dmy HM'))   # repeat with all the lines working

data_clean <- data_clean %>%  # create new columns with month, year,
  mutate(Month = month(Date), # day, minute                     
         Year = year(Date),
         Day = day(Date),
         Hour = hour(Date), 
         Minute = minute(Date))

data_clean[584,]  # check it worked

```

4.2. Check the new data

```{r, echo= TRUE, results='hide'}
str(data_clean)
skimr::skim(data_clean)
```

4.3. Rename coulmns so it is easy to use

```{r}

colnames(data_clean) <- if_else(grepl("^\\d", colnames(data_clean)), paste0("X", colnames(data_clean)), colnames(data_clean)) # Add an X in front of numeric columns so it is easier to type the names

data_clean <- data_clean %>%  # Rename certain columns to make them friendlier to use
  rename(X4.calc_yield = `:calc_yield`,
         X1.F = `X1:F`,
         X1.Fm = `X1.Fm'`,
         X2.Fm = `X2.Fm'`,
         X3.Fm =`X3.Fm'`,
         X4.Fm = `X4.Fm'`)

```
4.4. Need to change some variables of format

```{r, warning = FALSE, eval=FALSE}
# eval= False --> don't run this chunk --> no needed
 data_clean <- data_clean %>%
 mutate(X1.PAR = as.numeric(X1.PAR),  # Change PAR of X1, X2 and X3 to numeric
         X2.PAR = as.numeric(X2.PAR), 
         X3.PAR = as.numeric(X3.PAR), 
         X4.PAR = as.numeric(X4.PAR),
         X3.F = as.numeric(X3.F),  # Change F and Fm to numeric
         X3.Fm = as.numeric(X3.Fm),
         X3.Temp = as.numeric(X3.Temp),  # Change Temp 3 to numeric
         X1.diff = as.numeric(X1.diff),  # Change all diff to numeric
         X2.diff = as.numeric(X2.diff),
         X3.diff = as.numeric(X3.diff),
         X4.diff = as.numeric(X4.diff))
         #Month = as.factor(Month),  # Change day, month and year to categories -> is it a great idea?
         #Year = as.factor(Year), 
         #Day = as.factor(Day))
```

4.5. Create column for month (in letters) and day-month 

```{r}
data_clean <- data_clean %>% 
  mutate(Month_Name = as.factor(case_when(  # Make a column with the names of the months and make them a factor
  Month == 1 ~ "Jan",  # case_when from dplyr package
  Month == 2 ~ "Feb",
  Month == 3 ~ "Mar",
  Month == 4 ~ "Apr",
  Month == 5 ~ "May",
  Month == 6 ~ "Jun",
  Month == 7 ~ "Jul",
  Month == 8 ~ "Aug",
  Month == 9 ~ "Sep",
  Month == 10 ~ "Oct",
  Month == 11 ~ "Nov",
  Month == 12 ~ "Dec"))) %>% 
  mutate(Date_Combined = as.factor(  # Make a column with the day and month name separated by -
    paste(Month_Name, Day, sep = "-")))  # Make the column a factor

```

4.6. Fix Day_cum

```{r}
print(data_clean[is.na(data_clean$Day_cum), ])  # Check for rows with NAs in Day_cum

# From 25/01/2022 the date format changes and it is not cummulative anymore

data_clean <- data_clean %>%
  mutate(Date_no_time = paste(year(Date), month(Date), day(Date), sep = "-")) %>%  # Create acolumn with the date but without the time
  mutate(Day_cum = if_else(No. >= 26510, 44586 + as.numeric(difftime(Date_no_time, as.Date("2022-01-25"), units = "days")), Day_cum)) %>%  # Fix the format of Day_cum after the 25/01/2022
  # Difftime weeks the time passed between 2 days in the units indicated
  select(-Date_no_time)  # Remove Date_no_time from the data set
  
print(data_clean[is.na(data_clean$Day_cum), ])  # Check for rows with NAs in Day_cum

head(data_clean$Date_Combined)  # Check it worked
tail(data_clean$Date_Combined)


```

4.7. Create a column for average moss values of yield, PAR, F, Fm, Temp, ETR and diff

```{r}
data_clean <- data_clean %>% 
  mutate(av_moss_yield = rowMeans(data_clean[, c("X1.Y", "X2.Y", "X4.Y")]),  # rowMeans gets the mean of each row in the data frame and stores the result in a new column
         av_moss_PAR = rowMeans(data_clean[, c("X1.PAR", "X2.PAR", "X4.PAR")]),
         av_moss_F = rowMeans(data_clean[, c("X1.F", "X2.F", "X4.F")]),
         av_moss_Fm = rowMeans(data_clean[, c("X1.Fm", "X2.Fm", "X4.Fm")]),
         av_moss_temp = rowMeans(data_clean[, c("X1.Temp", "X2.Temp", "X4.Temp")]),
         av_moss_ETR = rowMeans(data_clean[, c("X1.ETR", "X2.ETR", "X4.ETR")]),
         av_moss_diff = rowMeans(data_clean[, c("X1.diff", "X2.diff", "X4.diff")]))
```


## 5. Subset data for summers 2019-2020, 2020-2021, 2021-2022

**Summer 2019-2020**

This includes the data from the 1-Nov 2019 to the 15 of Feb 2020

```{r}
summer_19_20 <- data_clean %>% 
  filter(Year == 2019 & Month %in% c(11,12) |  # Filter all data points in Nov, Dec 2019 and Jan, Feb 2020
           Year == 2020 & Month %in% c(1,2)) #%>% 
 # filter(!(Month == 2 & Day > 15))  # remove days over the 15th of Feb (removed 22nd feb)

# Check our data

head(summer_19_20)  # First 6 rows 
tail(summer_19_20)  # Last 6 rows

summer_19_20$Date_Combined <- reorder(summer_19_20$Date_Combined, summer_19_20$Day_cum)  # reorder the factors of Date_Combined according to the values of Day_cum. Do it for each subset individually because factors repeat for each year

levels(summer_19_20$Date_Combined)
```

**Summer 2020-2021**

This includes the data from the 1-Nov 2020 to the 15 of Feb 2021

```{r}
summer_20_21 <- data_clean %>% 
  filter(Year == 2020 & Month %in% c(11,12) |  # Filter all data points in Nov, Dec 2029 and Jan, Feb 2021
           Year == 2021 & Month %in% c(1,2))  #%>% 
  #filter(!(Month == 2 & Day > 15))  # remove days over the 15th of Feb (removed 22nd feb)

# Check our data

head(summer_20_21)  # First 6 rows 
tail(summer_20_21)  # Last 6 rows

summer_20_21$Date_Combined <- reorder(summer_20_21$Date_Combined, summer_20_21$Day_cum)  # reorder the factors of Date_Combined according to the values of Day_cum. Do it for each subset individually because factors repeat for each year

levels(summer_20_21$Date_Combined)
```

**Summer 2021-2022**

This includes the data from the 1-Nov 2021 to the 15 of Feb 2022.

\* I only have the data until the 3rd of Feb yet

```{r}
summer_21_22 <- data_clean %>% 
  filter(Year == 2021 & Month %in% c(11,12) |  # Filter all data points in Nov, Dec 2021 and Jan, Feb 2022
           Year == 2022 & Month %in% c(1,2)) #%>% 
  #filter(!(Month == 2 & Day > 15))  # remove days over the 15th of Feb (removed 22nd feb)

# Check our data

head(summer_21_22)  # First 6 rows 
tail(summer_21_22)  # Last 6 rows

summer_21_22$Date_Combined <- reorder(summer_21_22$Date_Combined, summer_21_22$Day_cum)  # reorder the factors of Date_Combined according to the values of Day_cum. Do it for each subset individually because factors repeat for each year

levels(summer_21_22$Date_Combined)
```

## 5.2 Format data set 2022-2023 and subset summer 2021-2022 and 2022-2023 

5.2.1 Remove the weird times and divide the useful ones

```{r}
data_clean_23 <- data_23[, -c(1:3,6,8,9)] %>%   # create a new data set without columns 1, 2, 3, 6, 8, 9
  mutate(Day_cum = floor(`Excel date`)) %>%  # maintain cumulative date but change column name to more informative one and truncate it to remove decimals (floor function)
  select(-`Excel date`)  # remove Excel date from the final product

data_clean_23<- data_clean_23 %>% 
  mutate(Date = parse_date_time(Date, 'dmy'))   # indicate the format the date is wanted

nrow(data_clean_23[is.na(data_clean_23$Date), ])  # Check for rows with parsing issues\

#  No problematic rows

data_clean_23 <- data_clean_23 %>%  # create new columns with month, year,
  mutate(Month = month(Date), # day, minute                     
         Year = year(Date),
         Day = day(Date),
         Hour = hour(Time), 
         Minute = minute(Time))

#---
# 21st- Jan -- Add Time (rel/ms)

data_clean_23 <- data_clean_23 %>% 
  mutate(time_rel = data_23$`Time (rel/ms)`)

# 16th feb -- Add 'date_time' that included date and time

data_clean_23$DateTime <- as.POSIXct(paste(data_clean_23$Date, data_clean_23$Time), format="%Y-%m-%d %H:%M:%S")
```

5.2.2. Check the new data

```{r, echo= TRUE, results='hide'}
str(data_clean_23)
skimr::skim(data_clean_23)
```
5.2.3. Rename columns so it is easy to use

```{r}

colnames(data_clean_23) <- if_else(grepl("^\\d", colnames(data_clean_23)), paste0("X", colnames(data_clean_23)), colnames(data_clean_23)) # Add an X in front of numeric columns so it is easier to type the names

data_clean_23 <- data_clean_23 %>%  # Rename certain columns to make them friendlier to use
  rename(X2.Y = X2.Y...23,
         X2.Y_calc = X2.Y...25)

```

5.2.4. Create column for month (in letters) and day-month 

```{r}
data_clean_23 <- data_clean_23 %>% 
  mutate(Month_Name = as.factor(case_when(  # Make a column with the names of the months and make them a factor
  Month == 1 ~ "Jan",  # case_when from dplyr package
  Month == 2 ~ "Feb",
  Month == 3 ~ "Mar",
  Month == 4 ~ "Apr",
  Month == 5 ~ "May",
  Month == 6 ~ "Jun",
  Month == 7 ~ "Jul",
  Month == 8 ~ "Aug",
  Month == 9 ~ "Sep",
  Month == 10 ~ "Oct",
  Month == 11 ~ "Nov",
  Month == 12 ~ "Dec"))) %>% 
  mutate(Date_Combined = as.factor(  # Make a column with the day and month name separated by -
    paste(Month_Name, Day, sep = "-")))  # Make the column a factor

```

5.2.5. Fix Day_cum

```{r}
nrow(data_clean_23[is.na(data_clean_23$Day_cum), ])   # Check for rows with NAs in Day_cum

# There is 0, so no need to check anything
```

5.2.6. Create difference columns

```{r}
data_clean_23 <- data_clean_23 %>% 
  mutate(X1.diff = X1.Fm - X1.F,
         X2.diff = X2.Fm - X2.F,
         X3.diff = X3.Fm - X3.F,
         X4.diff = X4.Fm - X4.F)
```

5.2.7. Create a column for average moss values of yield, PAR, F, Fm, Temp, ETR and diff

```{r}
data_clean_23 <- data_clean_23 %>% 
  mutate(av_moss_yield = rowMeans(data_clean_23[, c("X1.Y", "X2.Y", "X4.Y")]),  # rowMeans gets the mean of each row in the data frame and stores the result in a new column
         av_moss_PAR = rowMeans(data_clean_23[, c("X1.PAR", "X2.PAR", "X4.PAR")]),
         av_moss_F = rowMeans(data_clean_23[, c("X1.F", "X2.F", "X4.F")]),
         av_moss_Fm = rowMeans(data_clean_23[, c("X1.Fm", "X2.Fm", "X4.Fm")]),
         av_moss_temp = rowMeans(data_clean_23[, c("X1.Temp", "X2.Temp", "X4.Temp")]),
         av_moss_ETR = rowMeans(data_clean_23[, c("X1.ETR", "X2.ETR", "X4.ETR")]),
         av_moss_diff = rowMeans(data_clean_23[, c("X1.diff", "X2.diff", "X4.diff")]))
```

5.2.8. Subset **Summer 2022-2023**

```{r}
summer_22_23 <- data_clean_23 %>% 
  filter(Year == 2022 & Month %in% c(11,12) |  # Filter all data points in Nov, Dec 2022 and Jan, Feb 20223
           Year == 2023 & Month %in% c(1,2))# %>% 
 # filter(!(Month == 2 & Day > 15))  # remove days over the 15th of Feb(removed 22nd feb)

# Check our data

head(summer_22_23)  # First 6 rows 
tail(summer_22_23)  # Last 6 rows

summer_22_23$Date_Combined <- reorder(summer_22_23$Date_Combined, summer_22_23$Day_cum)  # reorder the factors of Date_Combined according to the values of Day_cum. Do it for each subset individually because factors repeat for each year

levels(summer_22_23$Date_Combined)
```

## 6. Make plots with yield, Calc_yield, Fm and Ft to see what is the correct measure---

1. Summer 2019-2020

Sample X1 (moss)

```{r}
(Yield_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Fm_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1800, by = 50)))  # Remove axis label and text for the graph

(Ft_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
         geom_hline(yintercept = 5, color = "red", linetype = "dashed") + # Added a line at 5. A suitable difference between Fm and Ft for it to be reliable is 5 (Allan)
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X1 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_19_20_X1 <- (Ft_plot_19_20_X1/Diff_plot_19_20_X1/Yield_plot_19_20_X1/Yield_calc_plot_19_20_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_19_20_X1.png", ana_yield_19_20_X1, device = "png")  # Save graph
```

Sample X2 (moss)

```{r}
(Yield_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Fm_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1800, by = 50)))  # Remove axis label and text for the graph

(Ft_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 5, color = "red", linetype = "dashed") + # Added a line at 5. A suitable difference between Fm and Ft for it to be reliable is 5 (Allan)
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X2 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_19_20_X2 <- (Fm_plot_19_20_X2/Ft_plot_19_20_X2/Diff_plot_19_20_X2/Yield_plot_19_20_X2/Yield_calc_plot_19_20_X2) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_19_20_X2.png", ana_yield_19_20_X2, device = "png")  # Save graph
```

Sample X3 (lichen)

```{r}
(Yield_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X3.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X3.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Fm_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X3.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1800, by = 50)))  # Remove axis label and text for the graph

(Ft_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X3.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X3.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
  geom_hline(yintercept = 5, color = "red", linetype = "dashed") + # Added a line at 5. A suitable difference between Fm and Ft for it to be reliable is 5 (Allan)
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nLichen X3 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_19_20_X3 <- (Fm_plot_19_20_X3/Ft_plot_19_20_X3/Diff_plot_19_20_X3/Yield_plot_19_20_X3/Yield_calc_plot_19_20_X3) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_19_20_X3.png", ana_yield_19_20_X3, device = "png")  # Save graph
```
Create a closeup in Feb from Sample X3 19-20. There is a clear trend that decreases on February but that disappears in Yield because machine shuts down

```{r}
## There is a clear trend that decreases on February but that disappears in Yield because machine shuts down. Make a close up look to it

# Close up with day

(Yield_closeup_19_20_X3 <- summer_19_20 %>% 
   filter(Day_cum > 43861 & Day_cum < 43870) %>% # filter days between Jan 31st and Feb 9th (when the difference isn't clear)
   ggplot(aes(Date, X3.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_closeup_19_20_X3 <- summer_19_20 %>% 
   filter(Day_cum > 43861 & Day_cum < 43870) %>% # filter days between Jan 31st and Feb 9th (when the difference isn't clear)
   ggplot(aes(Date, X3.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")) +
    scale_x_datetime(breaks = "1 day", labels = waiver()))

(Diff_closeup_19_20_X3 <- summer_19_20 %>% 
   filter(Day_cum > 43861 & Day_cum < 43870) %>% # filter days between Jan 31st and Feb 9th (when the difference isn't clear)
   ggplot(aes(Date, X3.diff)) +
   geom_point() +  # Add points for the data
   geom_line() +  # Add a line that joins the points
     geom_hline(yintercept = 5, color = "red", linetype = "dashed") + # Added a line at 5. A suitable difference between Fm and Ft for it to be reliable is 5 (Allan)
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nLichen X3 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 50, by = 2)))  # Define y scale

(closeup_yield_19_20_X3 <- (Diff_closeup_19_20_X3/Yield_closeup_19_20_X3/Yield_calc_closeup_19_20_X3) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/closeup_yield_19_20_X3.png", closeup_yield_19_20_X3, device = "png")  # Save graph
```

Sample X4 (moss)

```{r}
(Yield_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Fm_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1800, by = 50)))  # Remove axis label and text for the graph

(Ft_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X2 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_19_20_X4 <- (Fm_plot_19_20_X4/Ft_plot_19_20_X4/Diff_plot_19_20_X4/Yield_plot_19_20_X4/Yield_calc_plot_19_20_X4) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_19_20_X4.png", ana_yield_19_20_X4, device = "png")  # Save graph
```
2. Summer 2020-2021

Sample X1 (moss)

There is one row containing missing values in X1.diff and X1.yield_calc
```{r}
print(summer_20_21[is.na(summer_20_21$X1.diff),]) 
print(summer_20_21[is.na(summer_20_21$X1.calc_yield),]) 

# Solve line 2342 (6-feb)

summer_20_21[2342,8 ]<- 5  # Change the value to the correct one 
summer_20_21[2342,9 ]<- 5/67 # Change the value to the correct one 


# Check it is solved
print(summer_20_21[2342,])
```
Repeat Sample X1 (moss)

```{r}
(Yield_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1000, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X1 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_20_21_X1 <- (Fm_plot_20_21_X1/Ft_plot_20_21_X1/Diff_plot_20_21_X1/Yield_plot_20_21_X1/Yield_calc_plot_20_21_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_20_21_X1.png", ana_yield_20_21_X1, device = "png")  # Save graph

```
Sample X2 (moss)

```{r}
(Yield_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Fm_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1000, by = 50)))  # Remove axis label and text for the graph

(Ft_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X2 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_20_21_X2 <- (Fm_plot_20_21_X2/Ft_plot_20_21_X2/Diff_plot_20_21_X2/Yield_plot_20_21_X2/Yield_calc_plot_20_21_X2) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_20_21_X2.png", ana_yield_20_21_X2, device = "png")  # Save graph
```
Sample X3 (lichen)

```{r}
(Yield_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1000, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
  geom_hline(yintercept = 5, color = "red", linetype = "dashed") + # Added a line at 5. A suitable difference between Fm and Ft for it to be reliable is 5 (Allan)
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nLichen X3 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_20_21_X3 <- (Fm_plot_20_21_X3/Ft_plot_20_21_X3/Diff_plot_20_21_X3/Yield_plot_20_21_X3/Yield_calc_plot_20_21_X3) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_20_21_X3.png", ana_yield_20_21_X3, device = "png")  # Save graph
```
Generate closeup 20_21 Sample X3 end nov- beginning dec to see range increasing trend

```{r}
## There is a slight trend that increases on November-December but that disappears in Yield because machine shuts down. Make a close up look to it

# Close up with day

(Yield_closeup_20_21_X3 <- summer_20_21 %>% 
   filter(Day_cum > 44163 & Day_cum < 44173) %>% # filter days between Nov 28th and Dec 8th (when the difference isn't clear)
   ggplot(aes(Date, X3.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_closeup_20_21_X3 <- summer_20_21 %>% 
   filter(Day_cum > 44163 & Day_cum < 44173) %>% # filter days between Nov 28th and Dec 8th (when the difference isn't clear)
   ggplot(aes(Date, X3.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")) +
    scale_x_datetime(breaks = "1 day", labels = waiver()))

(Diff_closeup_20_21_X3 <- summer_20_21 %>% 
   filter(Day_cum > 44163 & Day_cum < 44173) %>% # filter days between Nov 28th and Dec 8th (when the difference isn't clear)
   ggplot(aes(Date, X3.diff)) +
   geom_point() +  # Add points for the data
   geom_line() +  # Add a line that joins the points
     geom_hline(yintercept = 5, color = "red", linetype = "dashed") + # Added a line at 5. A suitable difference between Fm and Ft for it to be reliable is 5 (Allan)
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nLichen X3 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 50, by = 2)))  # Define y scale

(closeup_yield_20_21_X3 <- (Diff_closeup_20_21_X3/Yield_closeup_20_21_X3/Yield_calc_closeup_20_21_X3) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/closeup_yield_20_21_X3.png", closeup_yield_20_21_X3, device = "png")  # Save graph
```


Sample X4 (moss)

```{r}
(Yield_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1000, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X4 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_20_21_X4 <- (Fm_plot_20_21_X4/Ft_plot_20_21_X4/Diff_plot_20_21_X4/Yield_plot_20_21_X4/Yield_calc_plot_20_21_X4) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_20_21_X4.png", ana_yield_20_21_X4, device = "png")  # Save graph
```
3. Summer 2021-2022

Sample X1 (moss)

```{r}
(Yield_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X1 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_21_22_X1 <- (Fm_plot_21_22_X1/Ft_plot_21_22_X1/Diff_plot_21_22_X1/Yield_plot_21_22_X1/Yield_calc_plot_21_22_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_21_22_X1.png", ana_yield_21_22_X1, device = "png")  # Save graph
```
Sample X2 (moss)

```{r}
(Yield_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X2 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_21_22_X2 <- (Fm_plot_21_22_X2/Ft_plot_21_22_X2/Diff_plot_21_22_X2/Yield_plot_21_22_X2/Yield_calc_plot_21_22_X2) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_21_22_X2.png", ana_yield_21_22_X2, device = "png")  # Save graph
```

Sample X3 (Lichen)

```{r}
(Yield_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nLichen X3") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nLichen X3") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nLichen X3 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_21_22_X3 <- (Fm_plot_21_22_X3/Ft_plot_21_22_X3/Diff_plot_21_22_X3/Yield_plot_21_22_X3/Yield_calc_plot_21_22_X3) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_21_22_X3.png", ana_yield_21_22_X3, device = "png")  # Save graph
```

Sample X4 (moss)

```{r}
(Yield_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X4") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X4") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X4") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1000, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X4 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_21_22_X4 <- (Fm_plot_21_22_X4/Ft_plot_21_22_X4/Diff_plot_21_22_X4/Yield_plot_21_22_X4/Yield_calc_plot_21_22_X4) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_21_22_X4.png", ana_yield_21_22_X4, device = "png")  # Save graph
```

4. Summer 2022-2023

Sample X1 (moss)

```{r}
(Yield_plot_22_23_X1 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_22_23_X1 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X1.Y_calc)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_22_23_X1 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X1.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_22_23_X1 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X1.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_22_23_X1 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X1.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X1 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_22_23_X1 <- (Fm_plot_22_23_X1/Ft_plot_22_23_X1/Diff_plot_22_23_X1/Yield_plot_22_23_X1/Yield_calc_plot_22_23_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_22_23_X1.png", ana_yield_22_23_X1, device = "png")  # Save graph
```
Difference between yield and yield calculated is weird in November. Make a close up look to it

```{r}
## Difference between yield and yield calculated is weird in November and early december. Make a close up look to it

# Close up with day

(Yield_closeup_22_23_X1 <- summer_22_23 %>% 
   filter(Day_cum < 44905) %>% # filter days before the 10th of December (when the difference isn't clear)
   ggplot(aes(Date_Combined, X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_closeup_22_23_X1 <- summer_22_23 %>% 
    filter(Day_cum < 44905) %>% # filter days before the 10th of December (when the difference isn't clear)
   ggplot(aes(Date_Combined, X1.Y_calc)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Diff_closeup_22_23_X1 <- summer_22_23 %>% 
    filter(Day_cum < 44905) %>% # filter days before the 10th of December (when the difference isn't clear)
   ggplot(aes(Date_Combined, X1.diff)) +
   geom_point() +  # Add points for the data
   geom_line() +  # Add a line that joins the points
     geom_hline(yintercept = 5, color = "red", linetype = "dashed") + # Added a line at 5. A suitable difference between Fm and Ft for it to be reliable is 5 (Allan)
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X1 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 10, by = 1)))  # Define y scale

(closeup_yield_22_23_X1 <- (Diff_closeup_22_23_X1/Yield_closeup_22_23_X1/Yield_calc_closeup_22_23_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/closeup_yield_22_23_X1.png", closeup_yield_22_23_X1, device = "png")  # Save graph

# Close up with time

(Yield_closeupn_22_23_X1 <- summer_22_23 %>% 
   filter(Day_cum < 44905) %>% # filter days before the 10th of December (when the difference isn't clear)
   ggplot(aes(No., X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_closeupn_22_23_X1 <- summer_22_23 %>% 
    filter(Day_cum < 44905) %>% # filter days before the 10th of December (when the difference isn't clear)
   ggplot(aes(DateTime, X1.Y_calc)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")) +
      scale_x_datetime(breaks = "1 day", labels = waiver()))

(Diff_closeupn_22_23_X1 <- summer_22_23 %>% 
    filter(Day_cum < 44905) %>% # filter days before the 10th of December (when the difference isn't clear)
   ggplot(aes(DateTime, X1.diff)) +
   geom_point() +  # Add points for the data
   geom_line() +  # Add a line that joins the points
     geom_hline(yintercept = 5, color = "red", linetype = "dashed") + # Added a line at 5. A suitable difference between Fm and Ft for it to be reliable is 5 (Allan)
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X1 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 10, by = 1)))  # Add breaks for every measurement (every hour)

(closeupn_yield_22_23_X1 <- (Diff_closeupn_22_23_X1/Yield_closeupn_22_23_X1/Yield_calc_closeupn_22_23_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/closeupn_yield_22_23_X1.png", closeup_yield_22_23_X1, device = "png")  # Save graph


```

There seems to be a daily pattern fairly constant on how the difference changes abve or below 5. Make a closer lookup to see if it follows a daily pattern.
Take 3 days to be able to see it hour per hour (13th to 16th nov) arbitrary

```{r}
# Close up with time

(Yield_closeupn_times_22_23_X1 <- summer_22_23 %>% 
   filter(Day_cum > 44877 & Day_cum < 44882) %>% # filter days between 13th and 16th nov (when the difference isn't clear)
   ggplot(aes(No., X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_closeupn_times_22_23_X1 <- summer_22_23 %>% 
  filter(Day_cum > 44877 & Day_cum < 44882) %>% # filter days between 13th and 16th nov (when the difference isn't clear)
   ggplot(aes(DateTime, X1.Y_calc)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray"))+
    scale_x_datetime(breaks = unique(summer_22_23$DateTime)))

(Diff_closeupn_times_22_23_X1 <- summer_22_23 %>% 
  filter(Day_cum > 44877 & Day_cum < 44882) %>% # filter days between 13th and 16th nov (when the difference isn't clear)
   ggplot(aes(DateTime, X1.diff)) +
   geom_point() +  # Add points for the data
   geom_line() +  # Add a line that joins the points
     geom_hline(yintercept = 5, color = "red", linetype = "dashed") + # Added a line at 5. A suitable difference between Fm and Ft for it to be reliable is 5 (Allan)
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X1 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 10, by = 1)))  # Add breaks for every measurement (every hour)

(closeupn_times_yield_22_23_X1 <- (Diff_closeupn_times_22_23_X1/Yield_closeupn_times_22_23_X1/Yield_calc_closeupn_times_22_23_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/closeupn_times_yield_22_23_X1.png", closeupn_times_yield_22_23_X1, width = 54,height = 18, units = "cm", device = "png")  # Save graph


```

Second close up from the 17th to the 20th of november to see if there is a pattern
```{r}
# Close up with time

(Yield_closeupn_times_22_23_X1_2 <- summer_22_23 %>% 
   filter(Day_cum > 44881 & Day_cum < 44886) %>% # filter days between 13th and 16th nov (when the difference isn't clear)
   ggplot(aes(No., X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_closeupn_times_22_23_X1_2 <- summer_22_23 %>% 
  filter(Day_cum > 44881 & Day_cum < 44886) %>% # filter days between 13th and 16th nov (when the difference isn't clear)
   ggplot(aes(DateTime, X1.Y_calc)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray"))+
    scale_x_datetime(breaks = unique(summer_22_23$DateTime)))

(Diff_closeupn_times_22_23_X1_2 <- summer_22_23 %>% 
  filter(Day_cum > 44881 & Day_cum < 44886) %>% # filter days between 13th and 16th nov (when the difference isn't clear)
   ggplot(aes(DateTime, X1.diff)) +
   geom_point() +  # Add points for the data
   geom_line() +  # Add a line that joins the points
     geom_hline(yintercept = 5, color = "red", linetype = "dashed") + # Added a line at 5. A suitable difference between Fm and Ft for it to be reliable is 5 (Allan)
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X1 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 10, by = 1)))  # Add breaks for every measurement (every hour)

(closeupn_times_yield_22_23_X1_2 <- (Diff_closeupn_times_22_23_X1_2/Yield_closeupn_times_22_23_X1_2/Yield_calc_closeupn_times_22_23_X1_2) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/closeupn_times_yield_22_23_X1_2.png", closeupn_times_yield_22_23_X1_2, width = 54,height = 18, units = "cm", device = "png")  # Save graph


```

Sample X2 (moss)

```{r}
(Yield_plot_22_23_X2 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X2.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_22_23_X2 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X2.Y_calc)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X2") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_22_23_X2 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X2.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_22_23_X2 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X2.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_22_23_X2 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X2.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X2 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_22_23_X2 <- (Fm_plot_22_23_X2/Ft_plot_22_23_X2/Diff_plot_22_23_X2/Yield_plot_22_23_X2/Yield_calc_plot_22_23_X2) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_22_23_X2.png", ana_yield_22_23_X2, device = "png")  # Save graph
```

Sample X3 (Lichen)

There is one row containing NA value in Y_calc

```{r}
print(which(is.na(summer_22_23$X3.Y_calc))) 


# Solve line 2280 (3-feb)

## There is no temperature measurement for that line either--> It is a better approach to remove it

summer_22_23 <- summer_22_23[summer_22_23$No. != 1848, ]
  
```

Repeat Sample X3 (lichen)

```{r}
(Yield_plot_22_23_X3 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X3.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_22_23_X3 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X3.Y_calc)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_22_23_X3 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X3.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_22_23_X3 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X3.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_22_23_X3 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X3.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
     geom_hline(yintercept = 5, color = "red", linetype = "dashed") + # Added a line at 5. A suitable difference between Fm and Ft for it to be reliable is 5 (Allan)
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nLichen X3") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 100, by = 5)))


(ana_yield_22_23_X3 <- (Fm_plot_22_23_X3/Ft_plot_22_23_X3/Diff_plot_22_23_X3/Yield_plot_22_23_X3/Yield_calc_plot_22_23_X3) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_22_23_X3.png", ana_yield_22_23_X3, device = "png")  # Save graph
```
Sample X4 (moss)

```{r}
(Yield_plot_22_23_X4 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X4.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_22_23_X4 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X4.Y_calc)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_22_23_X4 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X4.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_22_23_X4 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X4.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_22_23_X4 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X4.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X4") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_22_23_X4 <- (Fm_plot_22_23_X4/Ft_plot_22_23_X4/Diff_plot_22_23_X4/Yield_plot_22_23_X4/Yield_calc_plot_22_23_X4) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_22_23_X4.png", ana_yield_22_23_X4, device = "png")  # Save graph
```

Make a close-up of Sample X4 22-23 until Deccember 3rd. The yield is positive but the values of Ft, Fm and differnece are very low. Check whether there is actual activity

```{r}
## Difference between yield and yield calculated is weird in November and early december. Make a close up look to it

# Close up with day

(Yield_closeup_22_23_X4 <- summer_22_23 %>% 
   filter(Day_cum < 44898) %>% # filter days before the 3rd of December (when the difference isn't clear)
   ggplot(aes(Date_Combined, X4.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_closeup_22_23_X4 <- summer_22_23 %>% 
    filter(Day_cum < 44898) %>% # filter days before the 3rd of December (when the difference isn't clear)
   ggplot(aes(Date_Combined, X4.Y_calc)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_closeup_22_23_X4 <- summer_22_23 %>% 
    filter(Day_cum < 44898) %>% # filter days before the 3rd of December (when the difference isn't clear)
   ggplot(aes(Date_Combined, X4.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1500, by = 50)))  # Remove axis label and text for the graph

(Fm_closeup_22_23_X4 <- summer_22_23 %>% 
    filter(Day_cum < 44898) %>% # filter days before the 3rd of December (when the difference isn't clear)
   ggplot(aes(Date_Combined, X4.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1500, by = 50)))  # Remove axis label and text for the graph

(Diff_closeup_22_23_X4 <- summer_22_23 %>% 
    filter(Day_cum < 44898) %>% # filter days before the 3rd of December (when the difference isn't clear)
   ggplot(aes(Date_Combined, X4.diff)) +
   geom_point() +  # Add points for the data
   geom_line() +  # Add a line that joins the points
     geom_hline(yintercept = 5, color = "red", linetype = "dashed") + # Added a line at 5. A suitable difference between Fm and Ft for it to be reliable is 5 (Allan)
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X4 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 10, by = 1)))  # Define y scale

(closeup_yield_22_23_X4 <- (Ft_closeup_22_23_X4/Diff_closeup_22_23_X4/Yield_closeup_22_23_X4/Yield_calc_closeup_22_23_X4) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/closeup_yield_22_23_X4.png", closeup_yield_22_23_X4, device = "png")  # Save graph
```

## 7. Create Chosen_yield and Chosen_ETR column in the plots that require a change in the yield: summer_20_21 X3, summer_22_23 X3, summer_22_23 X4 (2 lichens one moss)


```{r}
# summer_20_21 X3 yield

summer_20_21 <- summer_20_21 %>% 
  mutate(X3.chosen_yield = case_when( # summer_20_21 X3 yield
    Day_cum < 44165 ~ X3.Y,  # Days before the 30th of Nov stay with machine yield
    Day_cum >= 44165 & Day_cum <= 44173 ~ X3.calc_yield,  # Days between the 30th of Nov and 8th of Dec change to calc_yield
    Day_cum > 44173 ~ X3.Y),  # Days after the 8th of December stay with machine yield
    X3.chosen_ETR = X3.chosen_yield * X3.PAR )  # summer_20_21 X3 ETR

# summer_20_21 X3 yield in data_clean

data_clean <- data_clean %>% 
  mutate(X3.chosen_yield = case_when( # summer_20_21 X3 yield
    Day_cum < 44165 ~ X3.Y,  # Days before the 30th of Nov stay with machine yield
    Day_cum >= 44165 & Day_cum <= 44173 ~ X3.calc_yield,  # Days between the 30th of Nov and 8th of Dec change to calc_yield
    Day_cum > 44173 ~ X3.Y),  # Days after the 8th of December stay with machine yield
    X3.chosen_ETR = X3.chosen_yield * X3.PAR )  # summer_20_21 X3 ETR

# Summer 22_23 yield X3 and X4

summer_22_23 <- summer_22_23 %>% 
  mutate(X3.chosen_yield = case_when(  # X3 yield
    Day_cum <= 44905 ~ X3.Y,  # Days before the 10th of Dec stay with machine yield
    Day_cum > 44905 & Day_cum <= 44913 ~ X3.Y_calc,  # Days between the 11th of Dec and the 18th of Dec stay with machine yield
    Day_cum > 44913 & Day_cum <= 44918 ~ X3.Y, # Days between the 19th of Dec and the 23th of Dec stay with machine yield
    Day_cum > 44918 & Day_cum < 44921 ~ X3.Y_calc, # Days between the 23th of Dec and the 26th of Dec stay with machine yield
    Day_cum >= 44921 & Day_cum < 44927 ~ X3.Y, # Days between the 26th of Dec and the 1st of Jan stay with machine yield
    Day_cum >= 44927 & Day_cum <= 44932 ~ X3.Y_calc, # Days between the 1st of Jan and the 6st of Jan stay with machine yield
    Day_cum > 44932 ~ X3.Y),  # Days after the 7th of Jan stay with machine yield
    X4.chosen_yield = case_when(  # X4 yield
    Day_cum < 44898 ~ 0,  # Days before 3rd December change to 0
    Day_cum >= 44173 ~ X4.Y), # Days after 3rd December keep machine yield
    X3.chosen_ETR = X3.chosen_yield * X3.PAR, # Summer 22_23 ETR X3
    X4.chosen_ETR = X4.chosen_yield * X4.PAR) # Summer 22_23 ETR X4

# Summer 22_23 yield X3 and X4 in data_clean_23

data_clean_23 <- data_clean_23 %>% 
  mutate(X3.chosen_yield = case_when(  # X3 yield
    Day_cum <= 44905 ~ X3.Y,  # Days before the 10th of Dec stay with machine yield
    Day_cum > 44905 & Day_cum <= 44913 ~ X3.Y_calc,  # Days between the 11th of Dec and the 18th of Dec stay with machine yield
    Day_cum > 44913 & Day_cum <= 44918 ~ X3.Y, # Days between the 19th of Dec and the 23th of Dec stay with machine yield
    Day_cum > 44918 & Day_cum < 44921 ~ X3.Y_calc, # Days between the 23th of Dec and the 26th of Dec stay with machine yield
    Day_cum >= 44921 & Day_cum < 44927 ~ X3.Y, # Days between the 26th of Dec and the 1st of Jan stay with machine yield
    Day_cum >= 44927 & Day_cum <= 44932 ~ X3.Y_calc, # Days between the 1st of Jan and the 6st of Jan stay with machine yield
    Day_cum > 44932 ~ X3.Y),  # Days after the 7th of Jan stay with machine yield
    X4.chosen_yield = case_when(  # X4 yield
    Day_cum < 44898 ~ 0,  # Days before 3rd December change to 0
    Day_cum >= 44173 ~ X4.Y), # Days after 3rd December keep machine yield
    X3.chosen_ETR = X3.chosen_yield * X3.PAR, # Summer 22_23 ETR X3
    X4.chosen_ETR = X4.chosen_yield * X4.PAR) # Summer 22_23 ETR X4
```


## 8. Make plots for PAR and Temperature, yield and Fm in each summer, in each sample (check activity under snowcover). Different axis (use for characterising)

### 8.1. Make plot for Austroplaca Soropelta (Sample X3)

1. Summer 2019-2020

Sample X3 (Lichen)

```{r}
(temp_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X3.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \n(ºC) X3 ") +
   theme_graphs_env_cond()+
   theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))

(PAR_plot_19_20_X3 <-summer_19_20 %>% 
    ggplot(aes(Date_Combined, X3.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2019-2020 (day)", y = "PAR X3\n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X3.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(ETR_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X3.ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X3.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  

(combined_plot_19_20_X3 <- (ETR_plot_19_20_X3/Fm_plot_19_20_X3/Yield_plot_19_20_X3/temp_plot_19_20_X3/PAR_plot_19_20_X3) & plot_layout(ncol = 1)) 

ggsave(filename = "graphs_characterise/austroplaca/combined_plot_19_20_X3.png", combined_plot_19_20_X3, width = 54,height = 18, units = "cm", device = "png")  # Save graph

```

2. Summer 2020-2021

Sample X3 (Lichen) **Changed yield!!**

```{r}
(temp_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature (ºC)\nLichen X3") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_20_21_X3 <-summer_20_21 %>% 
    ggplot(aes(Date_Combined, X3.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2020-2021(day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.chosen_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(ETR_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.chosen_ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50))) 

(combined_plot_20_21_X3 <- (ETR_plot_20_21_X3/Fm_plot_20_21_X3/Yield_plot_20_21_X3/temp_plot_20_21_X3/PAR_plot_20_21_X3) & plot_layout(ncol = 1))

ggsave(filename = "graphs_characterise/austroplaca/combined_plot_20_21_X3.png", combined_plot_20_21_X3, width = 54,height = 18, units = "cm", device = "png")  # Save graph

```

3. Summer 2021-2022

Sample X3 (lichen)

```{r}
(temp_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X3 (°C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_21_22_X3 <-summer_21_22 %>% 
    ggplot(aes(Date_Combined, X3.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2021-2022 (day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \n Lichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(ETR_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1000, by = 50))) 

(combined_plot_21_22_X3 <- (ETR_plot_21_22_X3/Fm_plot_21_22_X3/Yield_plot_21_22_X3/temp_plot_21_22_X3/PAR_plot_21_22_X3) & plot_layout(ncol = 1))

ggsave(filename = "graphs_characterise/austroplaca/combined_plot_21_22_X3.png", combined_plot_21_22_X3, width = 54,height = 18, units = "cm", device = "png")  # Save graph

```

4. Summer 2022-2023

Sample X3 (Lichen) **Changed yield!!**

```{r}
(temp_plot_22_23_X3 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X3.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X3 (°C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_22_23_X3 <-summer_22_23 %>% 
    ggplot(aes(Date_Combined, X3.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2022-2023 (day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Fm_plot_22_23_X3 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X3.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  

(Yield_plot_22_23_X3 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X3.chosen_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \n Lichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(ETR_plot_22_23_X3 <- summer_22_23 %>% 
  ggplot(aes(Date_Combined, X3.chosen_ETR))+
  geom_point()+  # Add points for the data
  geom_line()+  # Add a line that joins the points
  labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \n Lichen X3 ") +  
  theme_graphs_env_cond() +
  theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray"))) # Remove axis label and text for the graph

(combined_plot_22_23_X3 <- (ETR_plot_22_23_X3/Fm_plot_22_23_X3/Yield_plot_22_23_X3/temp_plot_22_23_X3/PAR_plot_22_23_X3) & plot_layout(ncol = 1))

ggsave(filename = "graphs_characterise/austroplaca/combined_plot_22_23_X3.png", combined_plot_22_23_X3, width = 54,height = 18, units = "cm", device = "png")  # Save graph
```


### 8.2. Make plot for Bryum Argeteum (Sample X1, X2, X4)

1. Summer 2019-2020

Sample X1 (moss)

```{r}

(temp_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X1 (°C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_19_20_X1 <-summer_19_20 %>% 
    ggplot(aes(Date_Combined, X1.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2019-2020 (day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(ETR_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1000, by = 50)))  


(combined_plot_19_20_X1 <- (ETR_plot_19_20_X1/Fm_plot_19_20_X1/Yield_plot_19_20_X1/temp_plot_19_20_X1/PAR_plot_19_20_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_characterise/bryum/combined_plot_19_20_X1.png", combined_plot_19_20_X1, width = 54,height = 18, units = "cm", device = "png")  # Save graph
```

Sample X2 (moss)

```{r}
(temp_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature (°C)\nMoss X2") +
   theme_graphs_env_cond()+
   theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))

(PAR_plot_19_20_X2 <-summer_19_20 %>% 
    ggplot(aes(Date_Combined, X2.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2019-2020 (day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())
  
(Yield_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(ETR_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1000, by = 50))) 

(combined_plot_19_20_X2 <- (ETR_plot_19_20_X2/Fm_plot_19_20_X2/Yield_plot_19_20_X2/temp_plot_19_20_X2/PAR_plot_19_20_X2) & plot_layout(ncol = 1))

ggsave(filename = "graphs_characterise/bryum/combined_plot_19_20_X2.png", combined_plot_19_20_X2, width = 54,height = 18, units = "cm", device = "png")  # Save graph
```

Sample X4 (Moss)

```{r}
(temp_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X4 (°C)") +
   theme_graphs_env_cond()+
   theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))

(PAR_plot_19_20_X4 <-summer_19_20 %>% 
    ggplot(aes(Date_Combined, X4.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2019-2020 (day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(ETR_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1700, by = 50))) 


(combined_plot_19_20_X4 <- (ETR_plot_19_20_X4/Fm_plot_19_20_X4/Yield_plot_19_20_X4/temp_plot_19_20_X4/PAR_plot_19_20_X4) & plot_layout(ncol = 1)) 

ggsave(filename = "graphs_characterise/bryum/combined_plot_19_20_X4.png", combined_plot_19_20_X4, width = 54,height = 18, units = "cm", device = "png")  # Save graph

```

2. Summer 2020-2021

Sample X1 (Moss)

```{r}
(temp_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X1 (°C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_20_21_X1 <- summer_20_21 %>% 
    ggplot(aes(Date_Combined, X1.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2020-2021 (day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(ETR_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1000, by = 50))) 

(combined_plot_20_21_X1 <- (ETR_plot_20_21_X1/Fm_plot_20_21_X1/Yield_plot_20_21_X1/temp_plot_20_21_X1/PAR_plot_20_21_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_characterise/bryum/combined_plot_20_21_X1.png", combined_plot_20_21_X1, width = 54,height = 18, units = "cm", device = "png")  # Save graph
```

Sample X2 (Moss)

```{r}
(temp_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X2 (°C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_20_21_X2 <-summer_20_21 %>% 
    ggplot(aes(Date_Combined, X2.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2020-2021 (day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(ETR_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1000, by = 50))) 

(combined_plot_20_21_X2 <- (ETR_plot_20_21_X2/Fm_plot_20_21_X2/Yield_plot_20_21_X2/temp_plot_20_21_X2/PAR_plot_20_21_X2) & plot_layout(ncol = 1))

ggsave(filename = "graphs_characterise/bryum/combined_plot_20_21_X2.png", combined_plot_20_21_X2, width = 54,height = 18, units = "cm", device = "png")  # Save graph

```

Sample X4 (moss)

```{r}
(temp_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X4 (°C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_20_21_X4 <-summer_20_21 %>% 
    ggplot(aes(Date_Combined, X4.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2020-2021 (day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(ETR_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nMoss X4") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X4") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1000, by = 50))) 

(combined_plot_20_21_X4 <- (ETR_plot_20_21_X4/Fm_plot_20_21_X4/Yield_plot_20_21_X4/temp_plot_20_21_X4/PAR_plot_20_21_X4) & plot_layout(ncol = 1))

ggsave(filename = "graphs_characterise/bryum/combined_plot_20_21_X4.png", combined_plot_20_21_X4, width = 54,height = 18, units = "cm", device = "png")  # Save graph

```

3. Summer 2021-2022

Sample X1 (moss)

```{r}
(temp_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X1 (°C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_21_22_X1 <-summer_21_22 %>% 
    ggplot(aes(Date_Combined, X1.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2021-2022 (day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(ETR_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nMoss X1") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X1") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1000, by = 50))) 

(combined_plot_21_22_X1 <- (ETR_plot_21_22_X1/Fm_plot_21_22_X1/Yield_plot_21_22_X1/temp_plot_21_22_X1/PAR_plot_21_22_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_characterise/bryum/combined_plot_21_22_X1.png", combined_plot_21_22_X1, width = 54,height = 18, units = "cm", device = "png")  # Save graph

```

Sample X2 (moss)

```{r}
(temp_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X2 (°C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_21_22_X2 <-summer_21_22 %>% 
    ggplot(aes(Date_Combined, X2.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2021-2022 (day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(ETR_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nMoss X2") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X2") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1300, by = 50))) 

(combined_plot_21_22_X2 <- (ETR_plot_21_22_X2/Fm_plot_21_22_X2/Yield_plot_21_22_X2/temp_plot_21_22_X2/PAR_plot_21_22_X2) & plot_layout(ncol = 1))

ggsave(filename = "graphs_characterise/bryum/combined_plot_21_22_X2.png", combined_plot_21_22_X2, width = 54,height = 18, units = "cm", device = "png")  # Save graph

```

Sample X4 (moss)

```{r}
(temp_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X1 (°C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_21_22_X4 <-summer_21_22 %>% 
    ggplot(aes(Date_Combined, X4.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2021-2022 (day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \n Moss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(ETR_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nMoss X4") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X4") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1300, by = 50))) 

(combined_plot_21_22_X4 <- (ETR_plot_21_22_X4/Fm_plot_21_22_X4/Yield_plot_21_22_X4/temp_plot_21_22_X4/PAR_plot_21_22_X4) & plot_layout(ncol = 1))

ggsave(filename = "graphs_characterise/bryum/combined_plot_21_22_X4.png", combined_plot_21_22_X4, width = 54,height = 18, units = "cm", device = "png")  # Save graph

```

4. Summer 2022-2023

Sample X1 (moss)

```{r}
(temp_plot_22_23_X1 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X1.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X1 (°C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_22_23_X1 <- summer_22_23 %>% 
    ggplot(aes(Date_Combined, X1.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2022-2023 (day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_22_23_X1 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(ETR_plot_22_23_X1 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X1.ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nMoss X1") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_22_23_X1 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X1.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X1") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1300, by = 50))) 

(combined_plot_22_23_X1 <- (ETR_plot_22_23_X1/Fm_plot_22_23_X1/Yield_plot_22_23_X1/temp_plot_22_23_X1/PAR_plot_22_23_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_characterise/bryum/combined_plot_22_23_X1.png", combined_plot_22_23_X1, width = 54,height = 18, units = "cm", device = "png")  # Save graph 
```

Sample X2 (moss)

```{r}
(temp_plot_22_23_X2 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X2.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X2 (°C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_22_23_X2 <- summer_22_23 %>% 
    ggplot(aes(Date_Combined, X2.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2022-2023 (day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_22_23_X2 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X2.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(ETR_plot_22_23_X2 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X2.ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nMoss X2") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_22_23_X2 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X2.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X2") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1300, by = 50))) 

(combined_plot_22_23_X2 <- (ETR_plot_22_23_X2/Fm_plot_22_23_X2/Yield_plot_22_23_X2/temp_plot_22_23_X2/PAR_plot_22_23_X2) & plot_layout(ncol = 1))

ggsave(filename = "graphs_characterise/bryum/combined_plot_22_23_X2.png", combined_plot_22_23_X2, width = 54,height = 18, units = "cm", device = "png")  # Save graph 
```
Sample X4 (moss)

```{r}
(temp_plot_22_23_X4 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X4.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X4 (°C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_22_23_X4 <- summer_22_23 %>% 
    ggplot(aes(Date_Combined, X4.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2022-2023 (day)", y = "PAR \n(µmol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_22_23_X4 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X4.chosen_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(ETR_plot_22_23_X4 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X4.chosen_ETR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "ETR\n(μmol e- m−2s−1) \nMoss X4") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Fm_plot_22_23_X4 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X4.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X4") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),  # Remove axis label and text for the graph
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1300, by = 50))) 

(combined_plot_22_23_X4 <- (ETR_plot_22_23_X4/Fm_plot_22_23_X4/Yield_plot_22_23_X4/temp_plot_22_23_X4/PAR_plot_22_23_X4) & plot_layout(ncol = 1))

ggsave(filename = "graphs_characterise/bryum/combined_plot_22_23_X4.png", combined_plot_22_23_X4, width = 54,height = 18, units = "cm", device = "png")  # Save graph 
```

## 9. Run descriptive statistics

### 9.1. Austroplaca (X3)

1. Create columns for activity

```{r}
data_clean <- data_clean %>% 
  mutate(X3.Active = if_else(X3.chosen_yield > 0, TRUE, FALSE))  # If the yield is above 0 the plant is active = TRUE

data_clean_23 <- data_clean_23 %>% 
  mutate(X3.Active = if_else(X3.chosen_yield > 0, TRUE, FALSE)) 

summer_19_20 <- summer_19_20 %>% 
  mutate(X3.Active = if_else(X3.Y > 0, TRUE, FALSE)) 

summer_20_21 <- summer_20_21 %>% 
  mutate(X3.Active = if_else(X3.chosen_yield > 0, TRUE, FALSE)) 

summer_21_22 <- summer_21_22 %>% 
  mutate(X3.Active = if_else(X3.Y > 0, TRUE, FALSE)) 

summer_22_23 <- summer_22_23 %>% 
  mutate(X3.Active = if_else(X3.chosen_yield > 0, TRUE, FALSE)) 
```

2. Active time

```{r}
# Active total time

total_activetime_stats_X3 <- bind_rows(  # put both counts into one dataset
  data_clean %>% count(Condition = X3.chosen_yield > 0, name = "Count_data_clean"),  # Count rows with active time (1 row = 1 hour)
  data_clean_23 %>% count(Condition = X3.chosen_yield > 0, name = "Count_data_clean_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum) %>%  # join rows that have the same condition (True or False)
mutate(Total_time = Count_data_clean + Count_data_clean_23) # add both columns to get the total active time of the year
  
(total_active_hours_X3 <- total_activetime_stats_X3 %>% # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Total_time))

(Percentage_active_hours_X3 <- total_active_hours_X3/(nrow(data_clean) + nrow(data_clean_23)) * 100) # calculate the percentage 
```

```{r}
# Active time each summer

summer_activetime_stats_X3 <-bind_rows(
  summer_19_20 %>% count(Condition = X3.Y > 0, name = "Count_19_20"), # Count rows in summer 20_21 with active time (1 row = 1 hour) // no chosen yield  becaue didn't make any ajustments
  summer_20_21 %>% count(Condition = X3.chosen_yield > 0, name = "Count_20_21"), # Chosen yield because made ajustments
summer_21_22 %>% count(Condition = X3.Y > 0, name = "Count_21_22"),
summer_22_23 %>% count(Condition = X3.chosen_yield > 0, name = "Count_22_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum)  # join rows that have the same condition (True or False)

(total_active_hours_19_20_X3 <- summer_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20))

(total_active_hours_20_21_X3 <- summer_activetime_stats_X3 %>%
  filter(Condition == TRUE) %>%
  select(Count_20_21))

(total_active_hours_21_22_X3 <- summer_activetime_stats_X3 %>%
  filter(Condition == TRUE) %>%
  select(Count_21_22))

(total_active_hours_22_23_X3 <- summer_activetime_stats_X3 %>%
  filter(Condition == TRUE) %>%
  select(Count_22_23))

(Percentage_active_hours_19_20_X3 <- total_active_hours_19_20_X3 /nrow(summer_19_20) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_X3 <- total_active_hours_20_21_X3 /nrow(summer_20_21) * 100)

(Percentage_active_hours_21_22_X3 <- total_active_hours_21_22_X3 /nrow(summer_21_22) * 100)

(Percentage_active_hours_22_23_X3 <- total_active_hours_22_23_X3 /nrow(summer_22_23) * 100)
```

```{r}
# Active time each month

month_activetime_stats_X3 <- bind_rows(
  summer_19_20 %>% filter(Month == 11) %>% count(Condition = X3.Y > 0, name = "Count_19_20_nov"),
  summer_19_20 %>% filter(Month == 12) %>% count(Condition = X3.Y > 0, name = "Count_19_20_dec"),
  summer_19_20 %>% filter(Month == 1) %>% count(Condition = X3.Y > 0, name = "Count_19_20_jan"),
  summer_19_20 %>% filter(Month == 2) %>% count(Condition = X3.Y > 0, name = "Count_19_20_feb"),
  summer_20_21 %>% filter(Month == 11) %>% count(Condition = X3.chosen_yield > 0, name = "Count_20_21_nov"),
  summer_20_21 %>% filter(Month == 12) %>% count(Condition = X3.chosen_yield > 0, name = "Count_20_21_dec"),
  summer_20_21 %>% filter(Month == 1) %>% count(Condition = X3.chosen_yield > 0, name = "Count_20_21_jan"),
  summer_20_21 %>% filter(Month == 2) %>% count(Condition = X3.chosen_yield > 0, name = "Count_20_21_feb"),
  summer_21_22 %>% filter(Month == 11) %>% count(Condition = X3.Y > 0, name = "Count_21_22_nov"),
  summer_21_22 %>% filter(Month == 12) %>% count(Condition = X3.Y > 0, name = "Count_21_22_dec"),
  summer_21_22 %>% filter(Month == 1) %>% count(Condition = X3.Y > 0, name = "Count_21_22_jan"),
  summer_21_22 %>% filter(Month == 2) %>% count(Condition = X3.Y > 0, name = "Count_21_22_feb"),
  summer_22_23 %>% filter(Month == 11) %>% count(Condition = X3.chosen_yield > 0, name = "Count_22_23_nov"),
  summer_22_23 %>% filter(Month == 12) %>% count(Condition = X3.chosen_yield > 0, name = "Count_22_23_dec"),
  summer_22_23 %>% filter(Month == 1) %>% count(Condition = X3.chosen_yield > 0, name = "Count_22_23_jan"),
  summer_22_23 %>% filter(Month == 2) %>% count(Condition = X3.chosen_yield > 0, name = "Count_22_23_feb")) %>% 
  group_by(Condition) %>% 
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum)

(total_active_hours_19_20_nov_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_nov))

(total_active_hours_19_20_dec_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_dec))

(total_active_hours_19_20_jan_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_jan))

(total_active_hours_19_20_feb_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_feb))

(total_active_hours_20_21_nov_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_nov))

(total_active_hours_20_21_dec_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_dec))

(total_active_hours_20_21_jan_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_jan))

(total_active_hours_20_21_feb_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_feb))

(total_active_hours_21_22_nov_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_nov))

(total_active_hours_21_22_dec_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_dec))

(total_active_hours_21_22_jan_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_jan))

(total_active_hours_21_22_feb_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_feb))

(total_active_hours_22_23_nov_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_nov))

(total_active_hours_22_23_dec_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_nov))

(total_active_hours_22_23_jan_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_jan))

(total_active_hours_22_23_feb_X3 <- month_activetime_stats_X3 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_feb))

(Percentage_active_hours_19_20_nov_X3 <- total_active_hours_19_20_nov_X3 /nrow(summer_19_20 %>% filter(Month == 11)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_dec_X3 <- total_active_hours_19_20_dec_X3 /nrow(summer_19_20 %>% filter(Month == 12)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_jan_X3 <- total_active_hours_19_20_nov_X3 /nrow(summer_19_20 %>% filter(Month == 1)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_feb_X3 <- total_active_hours_19_20_nov_X3 /nrow(summer_19_20 %>% filter(Month == 2)) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_nov_X3 <- total_active_hours_20_21_nov_X3 /nrow(summer_20_21 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_20_21_dec_X3 <- total_active_hours_20_21_dec_X3 /nrow(summer_20_21 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_20_21_jan_X3 <- total_active_hours_20_21_jan_X3 /nrow(summer_20_21 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_20_21_feb_X3 <- total_active_hours_20_21_feb_X3 /nrow(summer_20_21 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_21_22_nov_X3 <- total_active_hours_21_22_nov_X3 /nrow(summer_21_22 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_21_22_dec_X3 <- total_active_hours_21_22_dec_X3 /nrow(summer_21_22 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_21_22_jan_X3 <- total_active_hours_21_22_jan_X3 /nrow(summer_21_22 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_21_22_feb_X3 <- total_active_hours_21_22_feb_X3 /nrow(summer_21_22 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_22_23_nov_X3 <- total_active_hours_22_23_nov_X3 /nrow(summer_22_23 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_22_23_dec_X3 <- total_active_hours_22_23_dec_X3 /nrow(summer_22_23 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_22_23_jan_X3 <- total_active_hours_22_23_jan_X3 /nrow(summer_22_23 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_22_23_feb_X3 <- total_active_hours_22_23_feb_X3 /nrow(summer_22_23 %>% filter(Month == 2)) * 100)
```

**3. Thallus Temperature**

3.1. Total measuring and active time

```{r}
# Mean temperature during the whole measuring period ------------------

(mean_Temp_X3_data <- bind_rows(  # Make into a single dataset
  data_clean,  # get the rows in data_clean where the lichen is active
  data_clean_23) %>% # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_temp = mean(X3.Temp)))  # calculate the mean Temp of the active period
   
       # Mean is Na, which means one of the values is NA

(which(is.na(data_clean$X3.Temp))) # the row 20762 is NA
(which(is.na(data_clean_23$X3.Temp))) # the row 2280 is NA

print(data_clean[20762, ]) # there are a lot of NA --> remove observation
data_clean <- na.omit(data_clean, cols = "X3.Temp") # code to remove it

print(data_clean_23[2280, ]) # change NA value in Temp to -5ºC
data_clean_23$X3.Temp <- replace(data_clean_23$X3.Temp, is.na(data_clean_23$X3.Temp), -5) # code to replace it

(mean_Temp_X3_data <- bind_rows(
  data_clean  %>% select(X3.Temp), 
  data_clean_23  %>% select(X3.Temp)) %>% 
  summarise(mean_temp = mean(X3.Temp),
            max_temp = max(X3.Temp),  # get the maximum temperature
            min_temp = min(X3.Temp)))  # get the minimum temperature

# Mean temperature whole active period -------------------

(mean_Temp_active_X3_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X3.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X3.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_temp = mean(X3.Temp),
    max_temp = max(X3.Temp),
    min_temp = min(X3.Temp)))  # calculate the mean Temp of the active period

(mean_Temp_active_X3 <- mean_Temp_active_X3_data %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_temp))


```

3.2. Monthly Temperature

```{r}
# Mean temperature summer 19-20

(mean_Temp_X3_19_20 <- summer_19_20  %>%  # Mean Temp for 19-20
    select(X3.Temp) %>% 
  summarise(mean_temp = mean(X3.Temp),
            max_temp = max(X3.Temp),  # get the maximum temperature
            min_temp = min(X3.Temp)))  # get the minimum temperature

(mean_Temp_active_X3_19_20 <- summer_19_20 %>% # Mean Temp for active 19-20
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X3.Temp),
    max_temp = max(X3.Temp),
    min_temp = min(X3.Temp)))

(mean_Temp_active_X3_19_20 <- mean_Temp_active_X3_19_20 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_temp))

# Mean temperature summer 20-21

(mean_Temp_X3_20_21 <- summer_20_21  %>%  # Mean Temp for 20-21
    select(X3.Temp) %>% 
  summarise(mean_temp = mean(X3.Temp),
            max_temp = max(X3.Temp),  # get the maximum temperature
            min_temp = min(X3.Temp)))  # get the minimum temperature

(mean_Temp_active_X3_20_21 <- summer_20_21 %>% # Mean Temp for active 20-21
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X3.Temp),
    max_temp = max(X3.Temp),
    min_temp = min(X3.Temp)))

(mean_Temp_active_X3_20_21 <- mean_Temp_active_X3_20_21 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_temp))

# Mean temperature summer 21-22

(mean_Temp_X3_21_22 <- summer_21_22  %>%  # Mean Temp for 21-22
    select(X3.Temp) %>% 
  summarise(mean_temp = mean(X3.Temp),
            max_temp = max(X3.Temp),  # get the maximum temperature
            min_temp = min(X3.Temp)))  # get the minimum temperature

(mean_Temp_active_X3_21_22 <- summer_21_22 %>% # Mean Temp for active 21-22
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X3.Temp),
    max_temp = max(X3.Temp),
    min_temp = min(X3.Temp)))

(mean_Temp_active_X3_21_22 <- mean_Temp_active_X3_21_22 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_temp))

# Mean temperature summer 22-23

(mean_Temp_X3_22_23 <- summer_22_23  %>%  # Mean Temp for 22-23
    select(X3.Temp) %>% 
  summarise(mean_temp = mean(X3.Temp),
            max_temp = max(X3.Temp),  # get the maximum temperature
            min_temp = min(X3.Temp)))  # get the minimum temperature

(mean_Temp_active_X3_22_23 <- summer_22_23 %>% # Mean Temp for active 22-23
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X3.Temp),
    max_temp = max(X3.Temp),
    min_temp = min(X3.Temp)))

(mean_Temp_active_X3_22_23 <- mean_Temp_active_X3_22_23 %>%  # extract the mean Temp of the active period
  filter( X3.Active == TRUE) %>% 
  select( mean_temp))


```

3.3. Monthly temperature

```{r}

(month_temp_stats_X3 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X3.Temp),
            max_temp = max(X3.Temp),  # get the maximum temperature
            min_temp = min(X3.Temp)))

write.xlsx(month_temp_stats_X3, file = "stats/austroplaca/month_temp_stats_X3.xlsx") # save table

(month_active_temp_stats_X3 <- bind_rows(  # Monthly stats for active period
  summer_19_20 %>% filter(Month == 11, X1.Y > 0),
  summer_19_20 %>% filter(Month == 12, X1.Y > 0),
  summer_19_20 %>% filter(Month == 1, X1.Y > 0),
  summer_19_20 %>% filter(Month == 2, X1.Y > 0),
  summer_20_21 %>% filter(Month == 11, X1.Y > 0),
  summer_20_21 %>% filter(Month == 12, X1.Y > 0),
  summer_20_21 %>% filter(Month == 1, X1.Y > 0),
  summer_20_21 %>% filter(Month == 2, X1.Y > 0),
  summer_21_22 %>% filter(Month == 11, X1.Y > 0),
  summer_21_22 %>% filter(Month == 12, X1.Y > 0),
  summer_21_22 %>% filter(Month == 1, X1.Y > 0),
  summer_21_22 %>% filter(Month == 2, X1.Y > 0),
  summer_22_23 %>% filter(Month == 11, X1.Y > 0),
  summer_22_23 %>% filter(Month == 12, X1.Y > 0),
  summer_22_23 %>% filter(Month == 1, X1.Y > 0),
  summer_22_23 %>% filter(Month == 2, X1.Y > 0)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X3.Temp),
            max_temp = max(X3.Temp),  # get the maximum temperature
            min_temp = min(X3.Temp)))

write.xlsx(month_active_temp_stats_X3, file = "stats/austroplaca/month_active_temp_stats_X3.xlsx") # save table
```

**4. PAR**

4.1. Active Period

```{r}
# Active period----

(mean_PAR_active_X3_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X3.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X3.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_PAR = mean(X3.PAR),
    max_PAR = max(X3.PAR),
    min_PAR = min(X3.PAR)))  # calculate the mean PAR of the active period

```

4.2. Monthly PAR

```{r}
# Mean PAR summer 19-20

(mean_PAR_X3_19_20 <- summer_19_20 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X3.PAR),
    max_PAR = max(X3.PAR),
    min_PAR = min(X3.PAR)))

# Mean temperature summer 20-21

(mean_PAR_X3_20_21 <- summer_20_21 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X3.PAR),
    max_PAR = max(X3.PAR),
    min_PAR = min(X3.PAR)))

# Mean temperature summer 21-22

(mean_PAR_X3_21_22 <- summer_21_22 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X3.PAR),
    max_PAR = max(X3.PAR),
    min_PAR = min(X3.PAR)))

# Mean temperature summer 22-23

(mean_PAR_active_X3_22_23 <- summer_22_23 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X3.PAR),
    max_PAR = max(X3.PAR),
    min_PAR = min(X3.PAR)))

```

4.3. Monthly PAR

```{r}
(month_PAR_stats_X3 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_PAR = mean(X3.PAR),
            max_PAR = max(X3.PAR),  # get the maximum temperature
            min_PAR = min(X3.PAR)))

write.xlsx(month_PAR_stats_X3, file = "stats/austroplaca/month_PAR_stats_X3.xlsx") # save table

```


**5. YIELD and ETR**

5.1. Total Active period
```{r}
# Active period----

(mean_yield_active_X3_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X3.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X3.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_Y = mean(X3.chosen_yield),
    max_Y = max(X3.chosen_yield),
    min_Y = min(X3.chosen_yield)))  # calculate the mean yield of the active period

(mean_ETR_active_X3_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X3.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X3.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_ETR = mean(X3.chosen_ETR),
    max_ETR = max(X3.chosen_ETR),
    min_ETR = min(X3.chosen_ETR)))  # calculate the mean ETR of the active period

```

5.2 Summerly yield/ ETR

```{r}
# Mean YIED/ETR summer 19-20

(mean_yield_X3_19_20 <- summer_19_20 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X3.Y),
    max_Y = max(X3.Y),
    min_Y = min(X3.Y)))

(mean_ETR_X3_19_20 <- summer_19_20 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X3.ETR),
    max_ETR = max(X3.ETR),
    min_ETR = min(X3.ETR)))

# Mean YIED/ETR summer 20-21

(mean_yield_X3_20_21 <- summer_20_21 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X3.chosen_yield),
    max_Y = max(X3.chosen_yield),
    min_Y = min(X3.chosen_yield)))

(mean_ETR_X3_20_21 <- summer_20_21 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X3.chosen_ETR),
    max_ETR = max(X3.chosen_ETR),
    min_ETR = min(X3.chosen_ETR)))

# Mean YIED/ETR summer 21-22

(mean_yield_X3_21_22 <- summer_21_22 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X3.Y),
    max_Y = max(X3.Y),
    min_Y = min(X3.Y)))

(mean_ETR_X3_21_22 <- summer_21_22 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X3.ETR),
    max_ETR = max(X3.ETR),
    min_ETR = min(X3.ETR)))

# Mean YIED/ETR summer 22-23

(mean_yield_X3_22_23 <- summer_22_23 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X3.chosen_yield),
    max_Y = max(X3.chosen_yield),
    min_Y = min(X3.chosen_yield)))

(mean_ETR_X3_22_23 <- summer_22_23 %>% 
  group_by(X3.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X3.chosen_ETR),
    max_ETR = max(X3.chosen_ETR),
    min_ETR = min(X3.chosen_ETR)))

```

5.3. Monthly yield

```{r}
(month_Y_stats_X3 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_Y= mean(X3.Y),
            max_Y = max(X3.Y),  # get the maximum temperature
            min_Y = min(X3.Y)))

write.xlsx(month_Y_stats_X3, file = "stats/austroplaca/month_Y_stats_X3.xlsx") # save table


(month_ETR_stats_X3 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_ETR= mean(X3.ETR),
            max_ETR = max(X3.ETR),  # get the maximum temperature
            min_ETR = min(X3.ETR)))

write.xlsx(month_ETR_stats_X3, file = "stats/austroplaca/month_ETR_stats_X3.xlsx") # save table
```

### 9.2. Bryum (X1)

1. Create columns for activity

```{r}
data_clean <- data_clean %>% 
  mutate(X1.Active = if_else(X1.Y > 0, TRUE, FALSE))  # If the yield is above 0 the plant is active = TRUE

data_clean_23 <- data_clean_23 %>% 
  mutate(X1.Active = if_else(X1.Y > 0, TRUE, FALSE)) 

summer_19_20 <- summer_19_20 %>% 
  mutate(X1.Active = if_else(X1.Y > 0, TRUE, FALSE)) 

summer_20_21 <- summer_20_21 %>% 
  mutate(X1.Active = if_else(X1.Y > 0, TRUE, FALSE)) 

summer_21_22 <- summer_21_22 %>% 
  mutate(X1.Active = if_else(X1.Y > 0, TRUE, FALSE)) 

summer_22_23 <- summer_22_23 %>% 
  mutate(X1.Active = if_else(X1.Y > 0, TRUE, FALSE)) 
```

2. Active time

2.1. Active total time

```{r}
# Active total time

total_activetime_stats_X1 <- bind_rows(  # put both counts into one dataset
  data_clean %>% count(Condition = X1.Y > 0, name = "Count_data_clean"),  # Count rows with active time (1 row = 1 hour)
  data_clean_23 %>% count(Condition = X1.Y > 0, name = "Count_data_clean_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum) %>%  # join rows that have the same condition (True or False)
mutate(Total_time = Count_data_clean + Count_data_clean_23) # add both columns to get the total active time of the year
  
(total_active_hours_X1 <- total_activetime_stats_X1 %>% # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Total_time))

(Percentage_active_days_X1 <- total_active_hours_X1/(nrow(data_clean) + nrow(data_clean_23)) * 100) # calculate the percentage 
```

2.2. Active time each summer

```{r}
# Active time each summer

summer_activetime_stats_X1 <-bind_rows(
  summer_19_20 %>% count(Condition = X1.Y > 0, name = "Count_19_20"), # Count rows in summer 20_21 with active time (1 row = 1 hour) // no chosen yield  becaue didn't make any ajustments
  summer_20_21 %>% count(Condition = X1.Y > 0, name = "Count_20_21"), # Chosen yield because made ajustments
summer_21_22 %>% count(Condition = X1.Y > 0, name = "Count_21_22"),
summer_22_23 %>% count(Condition = X1.Y > 0, name = "Count_22_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum)  # join rows that have the same condition (True or False)

# filter from the dataset the total number of active hours---

(total_active_hours_19_20_X1 <- summer_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20))

(total_active_hours_20_21_X1 <- summer_activetime_stats_X1 %>%
  filter(Condition == TRUE) %>%
  select(Count_20_21))

(total_active_hours_21_22_X1 <- summer_activetime_stats_X1 %>%
  filter(Condition == TRUE) %>%
  select(Count_21_22))

(total_active_hours_22_23_X1 <- summer_activetime_stats_X1 %>%
  filter(Condition == TRUE) %>%
  select(Count_22_23))

# put active hours as a percentage

(Percentage_active_hours_19_20_X1 <- total_active_hours_19_20_X1 /nrow(summer_19_20) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_X1 <- total_active_hours_20_21_X1 /nrow(summer_20_21) * 100)

(Percentage_active_hours_21_22_X1 <- total_active_hours_21_22_X1 /nrow(summer_21_22) * 100)

(Percentage_active_hours_22_23_X1 <- total_active_hours_22_23_X1 /nrow(summer_22_23) * 100)
```

2.3. Active time each month

```{r}
# Active time each month

month_activetime_stats_X1 <- bind_rows(
  summer_19_20 %>% filter(Month == 11) %>% count(Condition = X1.Y > 0, name = "Count_19_20_nov"),
  summer_19_20 %>% filter(Month == 12) %>% count(Condition = X1.Y > 0, name = "Count_19_20_dec"),
  summer_19_20 %>% filter(Month == 1) %>% count(Condition = X1.Y > 0, name = "Count_19_20_jan"),
  summer_19_20 %>% filter(Month == 2) %>% count(Condition = X1.Y > 0, name = "Count_19_20_feb"),
  summer_20_21 %>% filter(Month == 11) %>% count(Condition = X1.Y > 0, name = "Count_20_21_nov"),
  summer_20_21 %>% filter(Month == 12) %>% count(Condition = X1.Y > 0, name = "Count_20_21_dec"),
  summer_20_21 %>% filter(Month == 1) %>% count(Condition = X1.Y > 0, name = "Count_20_21_jan"),
  summer_20_21 %>% filter(Month == 2) %>% count(Condition = X1.Y > 0, name = "Count_20_21_feb"),
  summer_21_22 %>% filter(Month == 11) %>% count(Condition = X1.Y > 0, name = "Count_21_22_nov"),
  summer_21_22 %>% filter(Month == 12) %>% count(Condition = X1.Y > 0, name = "Count_21_22_dec"),
  summer_21_22 %>% filter(Month == 1) %>% count(Condition = X1.Y > 0, name = "Count_21_22_jan"),
  summer_21_22 %>% filter(Month == 2) %>% count(Condition = X1.Y > 0, name = "Count_21_22_feb"),
  summer_22_23 %>% filter(Month == 11) %>% count(Condition = X1.Y > 0, name = "Count_22_23_nov"),
  summer_22_23 %>% filter(Month == 12) %>% count(Condition = X1.Y > 0, name = "Count_22_23_dec"),
  summer_22_23 %>% filter(Month == 1) %>% count(Condition = X1.Y > 0, name = "Count_22_23_jan"),
  summer_22_23 %>% filter(Month == 2) %>% count(Condition = X1.Y > 0, name = "Count_22_23_feb")) %>% 
  group_by(Condition) %>% 
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum)

# filter from the dataset the total number of active hours

(total_active_hours_19_20_nov_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_nov))

(total_active_hours_19_20_dec_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_dec))

(total_active_hours_19_20_jan_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_jan))

(total_active_hours_19_20_feb_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_feb))

(total_active_hours_20_21_nov_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_nov))

(total_active_hours_20_21_dec_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_dec))

(total_active_hours_20_21_jan_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_jan))

(total_active_hours_20_21_feb_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_feb))

(total_active_hours_21_22_nov_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_nov))

(total_active_hours_21_22_dec_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_dec))

(total_active_hours_21_22_jan_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_jan))

(total_active_hours_21_22_feb_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_feb))

(total_active_hours_22_23_nov_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_nov))

(total_active_hours_22_23_dec_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_nov))

(total_active_hours_22_23_jan_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_jan))

(total_active_hours_22_23_feb_X1 <- month_activetime_stats_X1 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_22_23_feb))

# put active hours as a percentage

(Percentage_active_hours_19_20_nov_X1 <- total_active_hours_19_20_nov_X1 /nrow(summer_19_20 %>% filter(Month == 11)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_dec_X1 <- total_active_hours_19_20_dec_X1 /nrow(summer_19_20 %>% filter(Month == 12)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_jan_X1 <- total_active_hours_19_20_nov_X1 /nrow(summer_19_20 %>% filter(Month == 1)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_feb_X1 <- total_active_hours_19_20_nov_X1 /nrow(summer_19_20 %>% filter(Month == 2)) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_nov_X1 <- total_active_hours_20_21_nov_X1 /nrow(summer_20_21 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_20_21_dec_X1 <- total_active_hours_20_21_dec_X1 /nrow(summer_20_21 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_20_21_jan_X1 <- total_active_hours_20_21_jan_X1 /nrow(summer_20_21 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_20_21_feb_X1 <- total_active_hours_20_21_feb_X1 /nrow(summer_20_21 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_21_22_nov_X1 <- total_active_hours_21_22_nov_X1 /nrow(summer_21_22 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_21_22_dec_X1 <- total_active_hours_21_22_dec_X1 /nrow(summer_21_22 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_21_22_jan_X1 <- total_active_hours_21_22_jan_X1 /nrow(summer_21_22 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_21_22_feb_X1 <- total_active_hours_21_22_feb_X1 /nrow(summer_21_22 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_22_23_nov_X1 <- total_active_hours_22_23_nov_X1 /nrow(summer_22_23 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_22_23_dec_X1 <- total_active_hours_22_23_dec_X1 /nrow(summer_22_23 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_22_23_jan_X1 <- total_active_hours_22_23_jan_X1 /nrow(summer_22_23 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_22_23_feb_X1 <- total_active_hours_22_23_feb_X1 /nrow(summer_22_23 %>% filter(Month == 2)) * 100)
```

**3. Thallus Temperature**

3.1. Total measuring and active time

```{r}
# Mean temperature during the whole measuring period ------------------

(mean_Temp_X1_data <- bind_rows(
  data_clean  %>% select(X1.Temp), 
  data_clean_23  %>% select(X1.Temp)) %>% 
  summarise(mean_temp = mean(X1.Temp),
            max_temp = max(X1.Temp),  # get the maximum temperature
            min_temp = min(X1.Temp)))  # get the minimum temperature

# Mean temperature whole active period-------------------

(mean_Temp_active_X1_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X1.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X1.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_temp = mean(X1.Temp),
    max_temp = max(X1.Temp),
    min_temp = min(X1.Temp)))  # calculate the mean Temp of the active period

(mean_Temp_active_X1 <- mean_Temp_active_X1_data %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))


```

3.2. Summer Temperature

```{r}
# Mean temperature summer 19-20

(mean_Temp_X1_19_20 <- summer_19_20  %>%  # Mean Temp for 19-20
    select(X1.Temp) %>% 
  summarise(mean_temp = mean(X1.Temp),
            max_temp = max(X1.Temp),  # get the maximum temperature
            min_temp = min(X1.Temp)))  # get the minimum temperature

(mean_Temp_active_X1_19_20 <- summer_19_20 %>%  # Mean Temp for active 19-20
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X1.Temp),
    max_temp = max(X1.Temp),
    min_temp = min(X1.Temp)))

(mean_Temp_active_X1_19_20 <- mean_Temp_active_X1_19_20 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

# Mean temperature summer 20-21

(mean_Temp_X1_20_21 <- summer_20_21  %>%  # Mean Temp for 20-21
    select(X1.Temp) %>% 
  summarise(mean_temp = mean(X1.Temp),
            max_temp = max(X1.Temp),  # get the maximum temperature
            min_temp = min(X1.Temp)))  # get the minimum temperature

(mean_Temp_active_X1_20_21 <- summer_20_21 %>% # Mean Temp for active 20-21
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X1.Temp),
    max_temp = max(X1.Temp),
    min_temp = min(X1.Temp)))

(mean_Temp_active_X1_20_21 <- mean_Temp_active_X1_20_21 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

# Mean temperature summer 21-22

(mean_Temp_X1_21_22 <- summer_21_22  %>%  # Mean Temp for 21-22
    select(X1.Temp) %>% 
  summarise(mean_temp = mean(X1.Temp),
            max_temp = max(X1.Temp),  # get the maximum temperature
            min_temp = min(X1.Temp)))  # get the minimum temperature

(mean_Temp_active_X1_21_22 <- summer_21_22 %>% # Mean Temp for active 21-22
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X1.Temp),
    max_temp = max(X1.Temp),
    min_temp = min(X1.Temp)))

(mean_Temp_active_X1_21_22 <- mean_Temp_active_X1_21_22 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))

# Mean temperature summer 22-23

(mean_Temp_X1_22_23 <- summer_22_23  %>%  # Mean Temp for 22-23
    select(X1.Temp) %>% 
  summarise(mean_temp = mean(X1.Temp),
            max_temp = max(X1.Temp),  # get the maximum temperature
            min_temp = min(X1.Temp)))  # get the minimum temperature

(mean_Temp_active_X1_22_23 <- summer_22_23 %>% # Mean Temp for active 22-23
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X1.Temp),
    max_temp = max(X1.Temp),
    min_temp = min(X1.Temp)))

(mean_Temp_active_X1_22_23 <- mean_Temp_active_X1_22_23 %>%  # extract the mean Temp of the active period
  filter( X1.Active == TRUE) %>% 
  select( mean_temp))


```

3.3. Monthly temperature

```{r}

(month_temp_stats_X1 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X1.Temp),
            max_temp = max(X1.Temp),  # get the maximum temperature
            min_temp = min(X1.Temp)))

write.xlsx(month_temp_stats_X1, file = "stats/bryum/month_temp_stats_X1.xlsx") # save table

(month_active_temp_stats_X1 <- bind_rows(  # Monthly stats for active period
  summer_19_20 %>% filter(Month == 11, X1.Active == TRUE),
  summer_19_20 %>% filter(Month == 12, X1.Active == TRUE),
  summer_19_20 %>% filter(Month == 1, X1.Active == TRUE),
  summer_19_20 %>% filter(Month == 2, X1.Active == TRUE),
  summer_20_21 %>% filter(Month == 11, X1.Active == TRUE),
  summer_20_21 %>% filter(Month == 12, X1.Active == TRUE),
  summer_20_21 %>% filter(Month == 1, X1.Active == TRUE),
  summer_20_21 %>% filter(Month == 2, X1.Active == TRUE),
  summer_21_22 %>% filter(Month == 11, X1.Active == TRUE),
  summer_21_22 %>% filter(Month == 12, X1.Active == TRUE),
  summer_21_22 %>% filter(Month == 1, X1.Active == TRUE),
  summer_21_22 %>% filter(Month == 2, X1.Active == TRUE),
  summer_22_23 %>% filter(Month == 11, X1.Active == TRUE),
  summer_22_23 %>% filter(Month == 12, X1.Active == TRUE),
  summer_22_23 %>% filter(Month == 1, X1.Active == TRUE),
  summer_22_23 %>% filter(Month == 2, X1.Active == TRUE)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X1.Temp),
            max_temp = max(X1.Temp),  # get the maximum temperature
            min_temp = min(X1.Temp)))

write.xlsx(month_active_temp_stats_X1, file = "stats/bryum/month_active_temp_stats_X1.xlsx") # save table

```

**4. PAR**

```{r}
# Active period----

(mean_PAR_active_X1_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X1.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X1.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_PAR = mean(X1.PAR),
    max_PAR = max(X1.PAR),
    min_PAR = min(X1.PAR)))  # calculate the mean PAR of the active period

```

4.2. Summerly PAR

```{r}
# Mean PAR summer 19-20

(mean_PAR_X1_19_20 <- summer_19_20 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X1.PAR),
    max_PAR = max(X1.PAR),
    min_PAR = min(X1.PAR)))

# Mean PAR summer 20-21

(mean_PAR_X1_20_21 <- summer_20_21 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X1.PAR),
    max_PAR = max(X1.PAR),
    min_PAR = min(X1.PAR)))

# Mean PAR summer 21-22

(mean_PAR_X1_21_22 <- summer_21_22 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X1.PAR),
    max_PAR = max(X1.PAR),
    min_PAR = min(X1.PAR)))

# Mean PAR summer 22-23

(mean_PAR_X1_22_23 <- summer_22_23 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X1.PAR),
    max_PAR = max(X1.PAR),
    min_PAR = min(X1.PAR)))

```

4.3. Monthly PAR

```{r}
(month_PAR_stats_X1 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_PAR = mean(X1.PAR),
            max_PAR = max(X1.PAR),  # get the maximum temperature
            min_PAR = min(X1.PAR)))

write.xlsx(month_PAR_stats_X1, file = "stats/bryum/month_PAR_stats_X1.xlsx") # save table

```


**5. YIELD and ETR**

```{r}
# Active period----

(mean_yield_active_X1_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X1.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X1.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_Y = mean(X1.Y),
    max_Y = max(X1.Y),
    min_Y = min(X1.Y)))  # calculate the mean yield of the active period

(mean_ETR_active_X1_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X1.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X1.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_ETR = mean(X1.ETR),
    max_ETR = max(X1.ETR),
    min_ETR = min(X1.ETR)))  # calculate the mean ETR of the active period

```

5.2 Summer yield/ ETR

```{r}
# Mean YIED/ETR summer 19-20

(mean_yield_X1_19_20 <- summer_19_20 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X1.Y),
    max_Y = max(X1.Y),
    min_Y = min(X1.Y)))

(mean_ETR_X1_19_20 <- summer_19_20 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X1.ETR),
    max_ETR = max(X1.ETR),
    min_ETR = min(X1.ETR)))

# Mean YIED/ETR summer 20-21

(mean_yield_X1_20_21 <- summer_20_21 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X1.Y),
    max_Y = max(X1.Y),
    min_Y = min(X1.Y)))

(mean_ETR_X1_20_21 <- summer_20_21 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X1.ETR),
    max_ETR = max(X1.ETR),
    min_ETR = min(X1.ETR)))

# Mean YIED/ETR summer 21-22

(mean_yield_X1_21_22 <- summer_21_22 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X1.Y),
    max_Y = max(X1.Y),
    min_Y = min(X1.Y)))

(mean_ETR_X1_21_22 <- summer_21_22 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X1.ETR),
    max_ETR = max(X1.ETR),
    min_ETR = min(X1.ETR)))

# Mean YIED/ETR summer 22-23

(mean_yield_X1_22_23 <- summer_22_23 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X1.Y),
    max_Y = max(X1.Y),
    min_Y = min(X1.Y)))

(mean_ETR_X1_22_23 <- summer_22_23 %>% 
  group_by(X1.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X1.ETR),
    max_ETR = max(X1.ETR),
    min_ETR = min(X1.ETR)))

```
5.3. Monthly

```{r}
(month_Y_stats_X1 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_Y= mean(X1.Y),
            max_Y = max(X1.Y),  # get the maximum temperature
            min_Y = min(X1.Y)))

write.xlsx(month_Y_stats_X1, file = "stats/bryum/month_Y_stats_X1.xlsx") # save table

(month_ETR_stats_X1 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_ETR= mean(X1.ETR),
            max_ETR = max(X1.ETR),  # get the maximum temperature
            min_ETR = min(X1.ETR)))

write.xlsx(month_ETR_stats_X1, file = "stats/bryum/month_ETR_stats_X1.xlsx") # save table
```
### 9.3. Bryum (X2)

1. Create columns for activity

```{r}
data_clean <- data_clean %>% 
  mutate(X2.Active = if_else(X2.Y > 0, TRUE, FALSE))  # If the yield is above 0 the plant is active = TRUE

data_clean_23 <- data_clean_23 %>% 
  mutate(X2.Active = if_else(X2.Y > 0, TRUE, FALSE)) 

summer_19_20 <- summer_19_20 %>% 
  mutate(X2.Active = if_else(X2.Y > 0, TRUE, FALSE)) 

summer_20_21 <- summer_20_21 %>% 
  mutate(X2.Active = if_else(X2.Y > 0, TRUE, FALSE)) 

summer_21_22 <- summer_21_22 %>% 
  mutate(X2.Active = if_else(X2.Y > 0, TRUE, FALSE)) 

summer_22_23 <- summer_22_23 %>% 
  mutate(X2.Active = if_else(X2.Y > 0, TRUE, FALSE)) 
```

2. Active time

2.1. Active total time

```{r}
# Active total time

(total_activetime_stats_X2 <- bind_rows(  # put both counts into one dataset
  data_clean %>% count(Condition = X2.Y > 0, name = "Count_data_clean"),  # Count rows with active time (1 row = 1 hour)
  data_clean_23 %>% count(Condition = X2.Y > 0, name = "Count_data_clean_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum) %>%  # join rows that have the same condition (True or False)
mutate(Total_time = Count_data_clean + Count_data_clean_23)) # add both columns to get the total active time of the year
  
(total_active_hours_X2 <- total_activetime_stats_X2 %>% # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Total_time))

(Percentage_active_days_X2 <- total_active_hours_X2/(nrow(data_clean) + nrow(data_clean_23)) * 100) # calculate the percentage 
```

2.2. Active time each summer

```{r}
# Active time each summer

summer_activetime_stats_X2 <-bind_rows(
  summer_19_20 %>% count(Condition = X2.Y > 0, name = "Count_19_20"), # Count rows in summer 20_21 with active time (1 row = 1 hour) // no chosen yield  becaue didn't make any ajustments
  summer_20_21 %>% count(Condition = X2.Y > 0, name = "Count_20_21"), # Chosen yield because made ajustments
  summer_21_22 %>% count(Condition = X2.Y > 0, name = "Count_21_22"),
  summer_22_23 %>% count(Condition = X2.Y > 0, name = "Count_22_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum)  # join rows that have the same condition (True or False)

(total_active_hours_19_20_X2 <- summer_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20))

(total_active_hours_20_21_X2 <- summer_activetime_stats_X2 %>%
  filter(Condition == TRUE) %>%
  select(Count_20_21))

(total_active_hours_21_22_X2 <- summer_activetime_stats_X2 %>%
  filter(Condition == TRUE) %>%
  select(Count_21_22))

(total_active_hours_22_23_X2 <- summer_activetime_stats_X2 %>%
  filter(Condition == TRUE) %>%
  select(Count_22_23))

(Percentage_active_hours_19_20_X2 <- total_active_hours_19_20_X2 /nrow(summer_19_20) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_X2 <- total_active_hours_20_21_X2 /nrow(summer_20_21) * 100)

(Percentage_active_hours_21_22_X2 <- total_active_hours_21_22_X2 /nrow(summer_21_22) * 100)

(Percentage_active_hours_22_23_X2 <- total_active_hours_22_23_X2 /nrow(summer_22_23) * 100)
```

2.3. Active time each month

```{r}
# Active time each month

(month_activetime_stats_X2 <- bind_rows(
  summer_19_20 %>% filter(Month == 11) %>% count(Condition = X2.Y > 0, name = "Count_19_20_nov"),
  summer_19_20 %>% filter(Month == 12) %>% count(Condition = X2.Y > 0, name = "Count_19_20_dec"),
  summer_19_20 %>% filter(Month == 1) %>% count(Condition = X2.Y > 0, name = "Count_19_20_jan"),
  summer_19_20 %>% filter(Month == 2) %>% count(Condition = X2.Y > 0, name = "Count_19_20_feb"),
  summer_20_21 %>% filter(Month == 11) %>% count(Condition = X2.Y > 0, name = "Count_20_21_nov"),
  summer_20_21 %>% filter(Month == 12) %>% count(Condition = X2.Y > 0, name = "Count_20_21_dec"),
  summer_20_21 %>% filter(Month == 1) %>% count(Condition = X2.Y > 0, name = "Count_20_21_jan"),
  summer_20_21 %>% filter(Month == 2) %>% count(Condition = X2.Y > 0, name = "Count_20_21_feb"),
  summer_21_22 %>% filter(Month == 11) %>% count(Condition = X2.Y > 0, name = "Count_21_22_nov"),
  summer_21_22 %>% filter(Month == 12) %>% count(Condition = X2.Y > 0, name = "Count_21_22_dec"),
  summer_21_22 %>% filter(Month == 1) %>% count(Condition = X2.Y > 0, name = "Count_21_22_jan"),
  summer_21_22 %>% filter(Month == 2) %>% count(Condition = X2.Y > 0, name = "Count_21_22_feb"),
  summer_22_23 %>% filter(Month == 11) %>% count(Condition = X2.Y > 0, name = "Count_22_23_nov"),
  summer_22_23 %>% filter(Month == 12) %>% count(Condition = X2.Y > 0, name = "Count_22_23_dec"),
  summer_22_23 %>% filter(Month == 1) %>% count(Condition = X2.Y > 0, name = "Count_22_23_jan"),
  summer_22_23 %>% filter(Month == 2) %>% count(Condition = X2.Y > 0, name = "Count_22_23_feb")) %>% 
  group_by(Condition) %>% 
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum) %>% 
   filter(Condition == TRUE))


(total_active_hours_19_20_nov_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_nov))

(total_active_hours_19_20_dec_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_dec))

(total_active_hours_19_20_jan_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_jan))

(total_active_hours_19_20_feb_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20_feb))

(total_active_hours_20_21_nov_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_nov))

(total_active_hours_20_21_dec_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_dec))

(total_active_hours_20_21_jan_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_jan))

(total_active_hours_20_21_feb_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_20_21_feb))

(total_active_hours_21_22_nov_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_nov))

(total_active_hours_21_22_dec_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_21_22_dec))

(total_active_hours_21_22_jan_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  select(Count_21_22_jan))

(total_active_hours_21_22_feb_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  select(Count_21_22_feb))

(total_active_hours_22_23_nov_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_nov))

(total_active_hours_22_23_dec_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_nov))

(total_active_hours_22_23_jan_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_jan))

(total_active_hours_22_23_feb_X2 <- month_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_feb))

(Percentage_active_hours_19_20_nov_X2 <- total_active_hours_19_20_nov_X2 /nrow(summer_19_20 %>% filter(Month == 11)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_dec_X2 <- total_active_hours_19_20_dec_X2 /nrow(summer_19_20 %>% filter(Month == 12)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_jan_X2 <- total_active_hours_19_20_nov_X2 /nrow(summer_19_20 %>% filter(Month == 1)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_feb_X2 <- total_active_hours_19_20_nov_X2 /nrow(summer_19_20 %>% filter(Month == 2)) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_nov_X2 <- total_active_hours_20_21_nov_X2 /nrow(summer_20_21 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_20_21_dec_X2 <- total_active_hours_20_21_dec_X2 /nrow(summer_20_21 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_20_21_jan_X2 <- total_active_hours_20_21_jan_X2 /nrow(summer_20_21 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_20_21_feb_X2 <- total_active_hours_20_21_feb_X2 /nrow(summer_20_21 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_21_22_nov_X2 <- total_active_hours_21_22_nov_X2 /nrow(summer_21_22 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_21_22_dec_X2 <- total_active_hours_21_22_dec_X2 /nrow(summer_21_22 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_21_22_jan_X2 <- total_active_hours_21_22_jan_X2 /nrow(summer_21_22 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_21_22_feb_X2 <- total_active_hours_21_22_feb_X2 /nrow(summer_21_22 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_22_23_nov_X2 <- total_active_hours_22_23_nov_X2 /nrow(summer_22_23 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_22_23_dec_X2 <- total_active_hours_22_23_dec_X2 /nrow(summer_22_23 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_22_23_jan_X2 <- total_active_hours_22_23_jan_X2 /nrow(summer_22_23 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_22_23_feb_X2 <- total_active_hours_22_23_feb_X2 /nrow(summer_22_23 %>% filter(Month == 2)) * 100)
```

**3. Thallus Temperature**

3.1. Total measuring and active time

```{r}
# Mean temperature during the whole measuring period ------------------

(mean_Temp_X2_data <- bind_rows(
  data_clean  %>% select(X2.Temp), 
  data_clean_23  %>% select(X2.Temp)) %>% 
  summarise(mean_temp = mean(X2.Temp),
            max_temp = max(X2.Temp),  # get the maximum temperature
            min_temp = min(X2.Temp)))  # get the minimum temperature

# Mean temperature whole active period-------------------

(mean_Temp_active_X2_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X2.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X2.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_temp = mean(X2.Temp),
    max_temp = max(X2.Temp),
    min_temp = min(X2.Temp)))  # calculate the mean Temp of the active period

(mean_Temp_active_X2 <- mean_Temp_active_X2_data %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_temp))


```

3.2. Summer Temperature

```{r}
# Mean temperature summer 19-20

(mean_Temp_X2_19_20 <- summer_19_20  %>%  # Mean Temp for 19-20
    select(X2.Temp) %>% 
  summarise(mean_temp = mean(X2.Temp),
            max_temp = max(X2.Temp),  # get the maximum temperature
            min_temp = min(X2.Temp)))  # get the minimum temperature

(mean_Temp_active_X2_19_20 <- summer_19_20 %>%  # Mean Temp for active 19-20
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X2.Temp),
    max_temp = max(X2.Temp),
    min_temp = min(X2.Temp)))

(mean_Temp_active_X2_19_20 <- mean_Temp_active_X2_19_20 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_temp))

# Mean temperature summer 20-21

(mean_Temp_X2_20_21 <- summer_20_21  %>%  # Mean Temp for 20-21
    select(X2.Temp) %>% 
  summarise(mean_temp = mean(X2.Temp),
            max_temp = max(X2.Temp),  # get the maximum temperature
            min_temp = min(X2.Temp)))  # get the minimum temperature

(mean_Temp_active_X2_20_21 <- summer_20_21 %>% # Mean Temp for active 20-21
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X2.Temp),
    max_temp = max(X2.Temp),
    min_temp = min(X2.Temp)))

(mean_Temp_active_X2_20_21 <- mean_Temp_active_X2_20_21 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE ) %>% 
  select( mean_temp))

# Mean temperature summer 21-22

(mean_Temp_X2_21_22 <- summer_21_22  %>%  # Mean Temp for 21-22
    select(X2.Temp) %>% 
  summarise(mean_temp = mean(X2.Temp),
            max_temp = max(X2.Temp),  # get the maximum temperature
            min_temp = min(X2.Temp)))  # get the minimum temperature

(mean_Temp_active_X2_21_22 <- summer_21_22 %>% # Mean Temp for active 21-22
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X2.Temp),
    max_temp = max(X2.Temp),
    min_temp = min(X2.Temp)))

(mean_Temp_active_X2_21_22 <- mean_Temp_active_X2_21_22 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_temp))

# Mean temperature summer 22-23

(mean_Temp_X2_22_23 <- summer_22_23  %>%  # Mean Temp for 22-23
    select(X2.Temp) %>% 
  summarise(mean_temp = mean(X2.Temp),
            max_temp = max(X2.Temp),  # get the maximum temperature
            min_temp = min(X2.Temp)))  # get the minimum temperature

(mean_Temp_active_X2_22_23 <- summer_22_23 %>% # Mean Temp for active 22-23
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X2.Temp),
    max_temp = max(X2.Temp),
    min_temp = min(X2.Temp)))

(mean_Temp_active_X2_22_23 <- mean_Temp_active_X2_22_23 %>%  # extract the mean Temp of the active period
  filter( X2.Active == TRUE) %>% 
  select( mean_temp))


```

3.3. Monthly temperature

```{r}

(month_temp_stats_X2 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X2.Temp),
            max_temp = max(X2.Temp),  # get the maximum temperature
            min_temp = min(X2.Temp)))

(month_active_temp_stats_X2 <- bind_rows(  # Monthly stats for active period
  summer_19_20 %>% filter(Month == 11, X2.Y > 0),
  summer_19_20 %>% filter(Month == 12, X2.Y > 0),
  summer_19_20 %>% filter(Month == 1, X2.Y > 0),
  summer_19_20 %>% filter(Month == 2, X2.Y > 0),
  summer_20_21 %>% filter(Month == 11, X2.Y > 0),
  summer_20_21 %>% filter(Month == 12, X2.Y > 0),
  summer_20_21 %>% filter(Month == 1, X2.Y > 0),
  summer_20_21 %>% filter(Month == 2, X2.Y > 0),
  summer_21_22 %>% filter(Month == 11, X2.Y > 0),
  summer_21_22 %>% filter(Month == 12, X2.Y > 0),
  summer_21_22 %>% filter(Month == 1, X2.Y > 0),
  summer_21_22 %>% filter(Month == 2, X2.Y > 0),
  summer_22_23 %>% filter(Month == 11, X2.Y > 0),
  summer_22_23 %>% filter(Month == 12, X2.Y > 0),
  summer_22_23 %>% filter(Month == 1, X2.Y > 0),
  summer_22_23 %>% filter(Month == 2, X2.Y > 0)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X2.Temp),
            max_temp = max(X2.Temp),  # get the maximum temperature
            min_temp = min(X2.Temp)))

```

**4. PAR**

```{r}
# Active period----

(mean_PAR_active_X2_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X2.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X2.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_PAR = mean(X2.PAR),
    max_PAR = max(X2.PAR),
    min_PAR = min(X2.PAR)))  # calculate the mean PAR of the active period

```

4.2. Summerly PAR

```{r}
# Mean PAR summer 19-20

(mean_PAR_X2_19_20 <- summer_19_20 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X2.PAR),
    max_PAR = max(X2.PAR),
    min_PAR = min(X2.PAR)))

# Mean temperature summer 20-21

(mean_PAR_X2_20_21 <- summer_20_21 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X2.PAR),
    max_PAR = max(X2.PAR),
    min_PAR = min(X2.PAR)))

# Mean temperature summer 21-22

(mean_PAR_X2_21_22 <- summer_21_22 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X2.PAR),
    max_PAR = max(X2.PAR),
    min_PAR = min(X2.PAR)))

# Mean temperature summer 22-23

(mean_PAR_X2_22_23 <- summer_22_23 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X2.PAR),
    max_PAR = max(X2.PAR),
    min_PAR = min(X2.PAR)))

```

4.3. Monthly PAR

```{r}
(month_PAR_stats_X2 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_PAR = mean(X2.PAR),
            max_PAR = max(X2.PAR),  # get the maximum temperature
            min_PAR = min(X2.PAR)))
```


**5. YIELD and ETR**

```{r}
# Active period----

(mean_yield_active_X2_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X2.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X2.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_Y = mean(X2.Y),
    max_Y = max(X2.Y),
    min_Y = min(X2.Y)))  # calculate the mean yield of the active period

(mean_ETR_active_X2_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X2.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X2.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_ETR = mean(X2.ETR),
    max_ETR = max(X2.ETR),
    min_ETR = min(X2.ETR)))  # calculate the mean ETR of the active period

```

5.2 Summer yield/ ETR

```{r}
# Mean YIED/ETR summer 19-20

(mean_yield_X2_19_20 <- summer_19_20 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X2.Y),
    max_Y = max(X2.Y),
    min_Y = min(X2.Y)))

(mean_ETR_X2_19_20 <- summer_19_20 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X2.ETR),
    max_ETR = max(X2.ETR),
    min_ETR = min(X2.ETR)))

# Mean YIED/ETR summer 20-21

(mean_yield_X2_20_21 <- summer_20_21 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X2.Y),
    max_Y = max(X2.Y),
    min_Y = min(X2.Y)))

(mean_ETR_X2_20_21 <- summer_20_21 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X2.ETR),
    max_ETR = max(X2.ETR),
    min_ETR = min(X2.ETR)))

# Mean YIED/ETR summer 21-22

(mean_yield_X2_21_22 <- summer_21_22 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X2.Y),
    max_Y = max(X2.Y),
    min_Y = min(X2.Y)))

(mean_ETR_X2_21_22 <- summer_21_22 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X2.ETR),
    max_ETR = max(X2.ETR),
    min_ETR = min(X2.ETR)))

# Mean YIED/ETR summer 22-23

(mean_yield_X2_22_23 <- summer_22_23 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X2.Y),
    max_Y = max(X2.Y),
    min_Y = min(X2.Y)))

(mean_ETR_X2_22_23 <- summer_22_23 %>% 
  group_by(X2.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X2.ETR),
    max_ETR = max(X2.ETR),
    min_ETR = min(X2.ETR)))

```

5.3. Monthly

```{r}
(month_Y_stats_X2 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_Y= mean(X2.Y),
            max_Y = max(X2.Y),  # get the maximum temperature
            min_Y = min(X2.Y)))

(month_ETR_stats_X2 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_ETR= mean(X2.ETR),
            max_ETR = max(X2.ETR),  # get the maximum temperature
            min_ETR = min(X2.ETR)))
```

### 9.4. Bryum (X4)

1. Create columns for activity

```{r}
data_clean <- data_clean %>% 
  mutate(X4.Active = if_else(X4.Y > 0, TRUE, FALSE))  # If the yield is above 0 the plant is active = TRUE

data_clean_23 <- data_clean_23 %>% 
  mutate(X4.Active = if_else(X4.Y > 0, TRUE, FALSE)) 

summer_19_20 <- summer_19_20 %>% 
  mutate(X4.Active = if_else(X4.Y > 0, TRUE, FALSE)) 

summer_20_21 <- summer_20_21 %>% 
  mutate(X4.Active = if_else(X4.Y > 0, TRUE, FALSE)) 

summer_21_22 <- summer_21_22 %>% 
  mutate(X4.Active = if_else(X4.Y > 0, TRUE, FALSE)) 

summer_22_23 <- summer_22_23 %>% 
  mutate(X4.Active = if_else(X4.chosen_yield > 0, TRUE, FALSE)) 
```

2. Active time

2.1. Active total time

```{r}
# Active total time

(total_activetime_stats_X4 <- bind_rows(  # put both counts into one dataset
  data_clean %>% count(Condition = X4.Active == TRUE, name = "Count_data_clean"),  # Count rows with active time (1 row = 1 hour)
  data_clean_23 %>% count(Condition = X4.Active == TRUE, name = "Count_data_clean_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum) %>%  # join rows that have the same condition (True or False)
mutate(Total_time = Count_data_clean + Count_data_clean_23)) # add both columns to get the total active time of the year
  
(total_active_hours_X4 <- total_activetime_stats_X4 %>% # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Total_time))

(Percentage_active_days_X4 <- total_active_hours_X4/(nrow(data_clean) + nrow(data_clean_23)) * 100) # calculate the percentage 
```

2.2. Active time each summer

```{r}
# Active time each summer

(summer_activetime_stats_X4 <-bind_rows(
  summer_19_20 %>% count(Condition = X4.Active == TRUE, name = "Count_19_20"), # Count rows in summer 20_21 with active time (1 row = 1 hour) // no chosen yield  becaue didn't make any ajustments
  summer_20_21 %>% count(Condition = X4.Active == TRUE, name = "Count_20_21"), # Chosen yield because made ajustments
  summer_21_22 %>% count(Condition = X4.Active == TRUE, name = "Count_21_22"),
  summer_22_23 %>% count(Condition = X4.Active == TRUE, name = "Count_22_23")) %>% 
group_by(Condition) %>%  # Group the data by the unique values in column "Condition"
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum))  # join rows that have the same condition (True or False)

(total_active_hours_19_20_X4 <- summer_activetime_stats_X2 %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20))

(total_active_hours_20_21_X4 <- summer_activetime_stats_X2 %>%
  filter(Condition == TRUE) %>%
  select(Count_20_21))

(total_active_hours_21_22_X4 <- summer_activetime_stats_X2 %>%
  filter(Condition == TRUE) %>%
  select(Count_21_22))

(total_active_hours_22_23_X4 <- summer_activetime_stats_X2 %>%
  filter(Condition == TRUE) %>%
  select(Count_22_23))

(Percentage_active_hours_19_20_X4 <- total_active_hours_19_20_X4 /nrow(summer_19_20) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_X4 <- total_active_hours_20_21_X4 /nrow(summer_20_21) * 100)

(Percentage_active_hours_21_22_X4 <- total_active_hours_21_22_X4 /nrow(summer_21_22) * 100)

(Percentage_active_hours_22_23_X4 <- total_active_hours_22_23_X4 /nrow(summer_22_23) * 100)
```

2.3. Active time each month

```{r}
# Active time each month

(month_activetime_stats_X4 <- bind_rows(
  summer_19_20 %>% filter(Month == 11) %>% count(Condition = X4.Active == TRUE, name = "Count_19_20_nov"),
  summer_19_20 %>% filter(Month == 12) %>% count(Condition = X4.Active == TRUE, name = "Count_19_20_dec"),
  summer_19_20 %>% filter(Month == 1) %>% count(Condition = X4.Active == TRUE, name = "Count_19_20_jan"),
  summer_19_20 %>% filter(Month == 2) %>% count(Condition = X4.Active == TRUE, name = "Count_19_20_feb"),
  summer_20_21 %>% filter(Month == 11) %>% count(Condition = X4.Active == TRUE, name = "Count_20_21_nov"),
  summer_20_21 %>% filter(Month == 12) %>% count(Condition = X4.Active == TRUE, name = "Count_20_21_dec"),
  summer_20_21 %>% filter(Month == 1) %>% count(Condition = X4.Active == TRUE, name = "Count_20_21_jan"),
  summer_20_21 %>% filter(Month == 2) %>% count(Condition = X4.Active == TRUE, name = "Count_20_21_feb"),
  summer_21_22 %>% filter(Month == 11) %>% count(Condition = X4.Active == TRUE, name = "Count_21_22_nov"),
  summer_21_22 %>% filter(Month == 12) %>% count(Condition = X4.Active == TRUE, name = "Count_21_22_dec"),
  summer_21_22 %>% filter(Month == 1) %>% count(Condition = X4.Active == TRUE, name = "Count_21_22_jan"),
  summer_21_22 %>% filter(Month == 2) %>% count(Condition = X4.Active == TRUE, name = "Count_21_22_feb"),
  summer_22_23 %>% filter(Month == 11) %>% count(Condition = X4.Active == TRUE, name = "Count_22_23_nov"),
  summer_22_23 %>% filter(Month == 12) %>% count(Condition = X4.Active == TRUE, name = "Count_22_23_dec"),
  summer_22_23 %>% filter(Month == 1) %>% count(Condition = X4.Active == TRUE, name = "Count_22_23_jan"),
  summer_22_23 %>% filter(Month == 2) %>% count(Condition = X4.Active == TRUE, name = "Count_22_23_feb")) %>% 
  group_by(Condition) %>% 
    mutate_all(~ifelse(is.na(.), 0, .)) %>% 
 summarise_all(sum) %>% 
   filter(Condition == TRUE))


(total_active_hours_19_20_nov_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_19_20_nov))

(total_active_hours_19_20_dec_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_19_20_dec))

(total_active_hours_19_20_jan_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_19_20_jan))

(total_active_hours_19_20_feb_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_19_20_feb))

(total_active_hours_20_21_nov_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_20_21_nov))

(total_active_hours_20_21_dec_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_20_21_dec))

(total_active_hours_20_21_jan_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_20_21_jan))

(total_active_hours_20_21_feb_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_20_21_feb))

(total_active_hours_21_22_nov_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_21_22_nov))

(total_active_hours_21_22_dec_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_21_22_dec))

(total_active_hours_21_22_jan_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_21_22_jan))

(total_active_hours_21_22_feb_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_21_22_feb))

(total_active_hours_22_23_nov_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_nov))

(total_active_hours_22_23_dec_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_nov))

(total_active_hours_22_23_jan_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_jan))

(total_active_hours_22_23_feb_X4 <- month_activetime_stats_X4 %>%  # filter from the dataset the total number of active hours
  select(Count_22_23_feb))

(Percentage_active_hours_19_20_nov_X4 <- total_active_hours_19_20_nov_X4 /nrow(summer_19_20 %>% filter(Month == 11)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_dec_X4 <- total_active_hours_19_20_dec_X4 /nrow(summer_19_20 %>% filter(Month == 12)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_jan_X4 <- total_active_hours_19_20_nov_X4 /nrow(summer_19_20 %>% filter(Month == 1)) * 100) # put active hours as a percentage

(Percentage_active_hours_19_20_feb_X4 <- total_active_hours_19_20_nov_X4 /nrow(summer_19_20 %>% filter(Month == 2)) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_nov_X4 <- total_active_hours_20_21_nov_X4 /nrow(summer_20_21 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_20_21_dec_X4 <- total_active_hours_20_21_dec_X4 /nrow(summer_20_21 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_20_21_jan_X4 <- total_active_hours_20_21_jan_X4 /nrow(summer_20_21 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_20_21_feb_X4 <- total_active_hours_20_21_feb_X4 /nrow(summer_20_21 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_21_22_nov_X4 <- total_active_hours_21_22_nov_X4 /nrow(summer_21_22 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_21_22_dec_X4 <- total_active_hours_21_22_dec_X4 /nrow(summer_21_22 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_21_22_jan_X4 <- total_active_hours_21_22_jan_X4 /nrow(summer_21_22 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_21_22_feb_X4 <- total_active_hours_21_22_feb_X4 /nrow(summer_21_22 %>% filter(Month == 2)) * 100)

(Percentage_active_hours_22_23_nov_X4 <- total_active_hours_22_23_nov_X4 /nrow(summer_22_23 %>% filter(Month == 11)) * 100)

(Percentage_active_hours_22_23_dec_X4 <- total_active_hours_22_23_dec_X4 /nrow(summer_22_23 %>% filter(Month == 12)) * 100)

(Percentage_active_hours_22_23_jan_X4 <- total_active_hours_22_23_jan_X4 /nrow(summer_22_23 %>% filter(Month == 1)) * 100)

(Percentage_active_hours_22_23_feb_X4 <- total_active_hours_22_23_feb_X4 /nrow(summer_22_23 %>% filter(Month == 2)) * 100)
```

**3. Thallus Temperature**

3.1. Total measuring and active time

```{r}
# Mean temperature during the whole measuring period ------------------

(mean_Temp_X4_data <- bind_rows(
  data_clean  %>% select(X4.Temp), 
  data_clean_23  %>% select(X4.Temp)) %>% 
  summarise(mean_temp = mean(X4.Temp),
            max_temp = max(X4.Temp),  # get the maximum temperature
            min_temp = min(X4.Temp)))  # get the minimum temperature

# Mean temperature whole active period-------------------

(mean_Temp_active_X4_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X4.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X4.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_temp = mean(X4.Temp),
    max_temp = max(X4.Temp),
    min_temp = min(X4.Temp)))  # calculate the mean Temp of the active period

(mean_Temp_active_X4 <- mean_Temp_active_X4_data %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_temp))


```

3.2. Summer Temperature

```{r}
# Mean temperature summer 19-20

(mean_Temp_X4_19_20 <- summer_19_20  %>%  # Mean Temp for 19-20
    select(X4.Temp) %>% 
  summarise(mean_temp = mean(X4.Temp),
            max_temp = max(X4.Temp),  # get the maximum temperature
            min_temp = min(X4.Temp)))  # get the minimum temperature

(mean_Temp_active_X4_19_20 <- summer_19_20 %>%  # Mean Temp for active 19-20
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X4.Temp),
    max_temp = max(X4.Temp),
    min_temp = min(X4.Temp)))

(mean_Temp_active_X4_19_20 <- mean_Temp_active_X4_19_20 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_temp))

# Mean temperature summer 20-21

(mean_Temp_X4_20_21 <- summer_20_21  %>%  # Mean Temp for 20-21
    select(X4.Temp) %>% 
  summarise(mean_temp = mean(X4.Temp),
            max_temp = max(X4.Temp),  # get the maximum temperature
            min_temp = min(X4.Temp)))  # get the minimum temperature

(mean_Temp_active_X4_20_21 <- summer_20_21 %>% # Mean Temp for active 20-21
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X4.Temp),
    max_temp = max(X4.Temp),
    min_temp = min(X4.Temp)))

(mean_Temp_active_X4_20_21 <- mean_Temp_active_X4_20_21 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE ) %>% 
  select( mean_temp))

# Mean temperature summer 21-22

(mean_Temp_X4_21_22 <- summer_21_22  %>%  # Mean Temp for 21-22
    select(X4.Temp) %>% 
  summarise(mean_temp = mean(X4.Temp),
            max_temp = max(X4.Temp),  # get the maximum temperature
            min_temp = min(X4.Temp)))  # get the minimum temperature

(mean_Temp_active_X4_21_22 <- summer_21_22 %>% # Mean Temp for active 21-22
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X4.Temp),
    max_temp = max(X4.Temp),
    min_temp = min(X4.Temp)))

(mean_Temp_active_X4_21_22 <- mean_Temp_active_X4_21_22 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_temp))

# Mean temperature summer 22-23

(mean_Temp_X4_22_23 <- summer_22_23  %>%  # Mean Temp for 22-23
    select(X4.Temp) %>% 
  summarise(mean_temp = mean(X4.Temp),
            max_temp = max(X4.Temp),  # get the maximum temperature
            min_temp = min(X4.Temp)))  # get the minimum temperature

(mean_Temp_active_X4_22_23 <- summer_22_23 %>% # Mean Temp for active 22-23
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_temp = mean(X4.Temp),
    max_temp = max(X4.Temp),
    min_temp = min(X4.Temp)))

(mean_Temp_active_X4_22_23 <- mean_Temp_active_X4_22_23 %>%  # extract the mean Temp of the active period
  filter( X4.Active == TRUE) %>% 
  select( mean_temp))


```

3.3. Monthly temperature

```{r}

(month_temp_stats_X4 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X4.Temp),
            max_temp = max(X4.Temp),  # get the maximum temperature
            min_temp = min(X4.Temp)))

(month_active_temp_stats_X4 <- bind_rows(  # Monthly stats for active period
  summer_19_20 %>% filter(Month == 11, X1.Y > 0),
  summer_19_20 %>% filter(Month == 12, X1.Y > 0),
  summer_19_20 %>% filter(Month == 1, X1.Y > 0),
  summer_19_20 %>% filter(Month == 2, X1.Y > 0),
  summer_20_21 %>% filter(Month == 11, X1.Y > 0),
  summer_20_21 %>% filter(Month == 12, X1.Y > 0),
  summer_20_21 %>% filter(Month == 1, X1.Y > 0),
  summer_20_21 %>% filter(Month == 2, X1.Y > 0),
  summer_21_22 %>% filter(Month == 11, X1.Y > 0),
  summer_21_22 %>% filter(Month == 12, X1.Y > 0),
  summer_21_22 %>% filter(Month == 1, X1.Y > 0),
  summer_21_22 %>% filter(Month == 2, X1.Y > 0),
  summer_22_23 %>% filter(Month == 11, X1.Y > 0),
  summer_22_23 %>% filter(Month == 12, X1.Y > 0),
  summer_22_23 %>% filter(Month == 1, X1.Y > 0),
  summer_22_23 %>% filter(Month == 2, X1.Y > 0)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_temp = mean(X4.Temp),
            max_temp = max(X4.Temp),  # get the maximum temperature
            min_temp = min(X4.Temp)))

```

**4. PAR**

```{r}
# Active period----

(mean_PAR_active_X4_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X4.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X4.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_PAR = mean(X4.PAR),
    max_PAR = max(X4.PAR),
    min_PAR = min(X4.PAR)))  # calculate the mean PAR of the active period

```

4.2. Summerly PAR

```{r}
# Mean PAR summer 19-20

(mean_PAR_X4_19_20 <- summer_19_20 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X4.PAR),
    max_PAR = max(X4.PAR),
    min_PAR = min(X4.PAR)))

# Mean temperature summer 20-21

(mean_PAR_X4_20_21 <- summer_20_21 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X4.PAR),
    max_PAR = max(X4.PAR),
    min_PAR = min(X4.PAR)))

# Mean temperature summer 21-22

(mean_PAR_X4_21_22 <- summer_21_22 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X4.PAR),
    max_PAR = max(X4.PAR),
    min_PAR = min(X4.PAR)))

# Mean temperature summer 22-23

(mean_PAR_X4_22_23 <- summer_22_23 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_PAR = mean(X4.PAR),
    max_PAR = max(X4.PAR),
    min_PAR = min(X4.PAR)))

```

4.3. Monthly PAR

```{r}
(month_PAR_stats_X4 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_PAR = mean(X4.PAR),
            max_PAR = max(X4.PAR),  # get the maximum temperature
            min_PAR = min(X4.PAR)))
```


**5. YIELD and ETR**

```{r}
# Active period----

(mean_yield_active_X4_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X4.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X4.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_Y = mean(X4.Y),
    max_Y = max(X4.Y),
    min_Y = min(X4.Y)))  # calculate the mean yield of the active period

(mean_ETR_active_X4_data <- bind_rows(  # Make into a single dataset
  data_clean %>% 
    group_by(X4.Active),  # get the rows in data_clean where the lichen is active
  data_clean_23 %>% 
    group_by(X2.Active)) %>%  # get the rows in data_clean_23 where the lichen is active
  summarise( n = n(),
    mean_ETR = mean(X4.ETR),
    max_ETR = max(X4.ETR),
    min_ETR = min(X4.ETR)))  # calculate the mean ETR of the active period

```

5.2 Summer yield/ ETR

```{r}
# Mean YIED/ETR summer 19-20

(mean_yield_X4_19_20 <- summer_19_20 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X4.Y),
    max_Y = max(X4.Y),
    min_Y = min(X4.Y)))

(mean_ETR_X4_19_20 <- summer_19_20 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X4.ETR),
    max_ETR = max(X4.ETR),
    min_ETR = min(X4.ETR)))

# Mean YIED/ETR summer 20-21

(mean_yield_X4_20_21 <- summer_20_21 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X4.Y),
    max_Y = max(X4.Y),
    min_Y = min(X4.Y)))

(mean_ETR_X4_20_21 <- summer_20_21 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X4.ETR),
    max_ETR = max(X4.ETR),
    min_ETR = min(X4.ETR)))

# Mean YIED/ETR summer 21-22

(mean_yield_X4_21_22 <- summer_21_22 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X4.Y),
    max_Y = max(X4.Y),
    min_Y = min(X4.Y)))

(mean_ETR_X4_21_22 <- summer_21_22 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X4.ETR),
    max_ETR = max(X4.ETR),
    min_ETR = min(X4.ETR)))

# Mean YIED/ETR summer 22-23

(mean_yield_X4_22_23 <- summer_22_23 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_Y = mean(X4.Y),
    max_Y = max(X4.Y),
    min_Y = min(X4.Y)))

(mean_ETR_X4_22_23 <- summer_22_23 %>% 
  group_by(X4.Active) %>% 
  summarise( n = n(),
    mean_ETR = mean(X4.ETR),
    max_ETR = max(X4.ETR),
    min_ETR = min(X4.ETR)))

```

5.3. Monthly

```{r}
(month_Y_stats_X4 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_Y= mean(X4.Y),
            max_Y = max(X4.Y),  # get the maximum temperature
            min_Y = min(X4.Y)))

(month_ETR_stats_X4 <- bind_rows(  # Monthly stats fro total measuring period
  summer_19_20 %>% filter(Month == 11),
  summer_19_20 %>% filter(Month == 12),
  summer_19_20 %>% filter(Month == 1),
  summer_19_20 %>% filter(Month == 2),
  summer_20_21 %>% filter(Month == 11),
  summer_20_21 %>% filter(Month == 12),
  summer_20_21 %>% filter(Month == 1),
  summer_20_21 %>% filter(Month == 2),
  summer_21_22 %>% filter(Month == 11),
  summer_21_22 %>% filter(Month == 12),
  summer_21_22 %>% filter(Month == 1),
  summer_21_22 %>% filter(Month == 2),
  summer_22_23 %>% filter(Month == 11),
  summer_22_23 %>% filter(Month == 12),
  summer_22_23 %>% filter(Month == 1),
  summer_22_23 %>% filter(Month == 2)) %>% 
   group_by(Year, Month) %>% 
 summarise(mean_ETR= mean(X4.ETR),
            max_ETR = max(X4.ETR),  # get the maximum temperature
            min_ETR = min(X4.ETR)))
```


### 9.5. Average Bryum

1. Active time

```{r}
(list_act_time <- list(total_activetime_stats_X1,total_activetime_stats_X2, total_activetime_stats_X4)) # put all datasets in a list
(total_activetime_stats_moss <- Reduce(`+`, list_act_time)/length(list_act_time)) # average them 

(total_active_hours_moss <- total_activetime_stats_moss %>% # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Total_time))

(percentage_active_days_moss <- total_active_hours_moss/(nrow(data_clean) + nrow(data_clean_23)) * 100)
```

1.2 Active time each summer

```{r}
(list_act_time_summer <- list(summer_activetime_stats_X1,summer_activetime_stats_X2, summer_activetime_stats_X3)) # put all datasets in a list
(summer_activetime_stats_moss <- Reduce(`+`, list_act_time_summer)/length(list_act_time)) # average them 
```

1.3 Active time each month

```{r}
(list_act_time_summer <- list(summer_activetime_stats_X1,summer_activetime_stats_X2, summer_activetime_stats_X3)) # put all datasets in a list
(summer_activetime_stats_moss <- Reduce(`+`, list_act_time_summer)/length(list_act_time)) # average them 

(total_active_hours_19_20_moss <- summer_activetime_stats_moss %>%  # filter from the dataset the total number of active hours
  filter(Condition == TRUE) %>%
  select(Count_19_20))

(total_active_hours_20_21_moss <- summer_activetime_stats_moss %>%
  filter(Condition == TRUE) %>%
  select(Count_20_21))

(total_active_hours_21_22_moss <- summer_activetime_stats_moss %>%
  filter(Condition == TRUE) %>%
  select(Count_21_22))

(total_active_hours_22_23_moss <- summer_activetime_stats_moss %>%
  filter(Condition == TRUE) %>%
  select(Count_22_23))

(Percentage_active_hours_19_20_moss <- total_active_hours_19_20_moss /nrow(summer_19_20) * 100) # put active hours as a percentage

(Percentage_active_hours_20_21_moss <- total_active_hours_20_21_moss /nrow(summer_20_21) * 100)

(Percentage_active_hours_21_22_moss <- total_active_hours_21_22_moss /nrow(summer_21_22) * 100)

(Percentage_active_hours_22_23_moss <- total_active_hours_22_23_moss /nrow(summer_22_23) * 100)

```

**3. Thallus Temperature**

3.1. Total measuring and active time

```{r}
# Mean temperature during the whole measuring period ------------------

(list_measuring_temp_moss <-list(mean_Temp_X1_data, mean_Temp_X2_data, mean_Temp_X4_data)) # put all datasets in a list
(mean_Temp_moss_data <- Reduce(`+`, list_measuring_temp_moss)/length(list_measuring_temp_moss)) # average them 

# Mean temperature whole active period-------------------

(list_active_temp_moss <-list(mean_Temp_active_X1_data, mean_Temp_active_X2_data, mean_Temp_active_X4_data)) # put all datasets in a list
(mean_Temp_active_moss_data <- Reduce(`+`, list_active_temp_moss)/length(list_active_temp_moss)) # average them 

```

3.2. Summer Temperature

```{r}
# Mean temperature summer 19-20

(list_measuring_temp_moss_19_20 <-list(mean_Temp_X1_19_20, mean_Temp_X2_19_20, mean_Temp_X4_19_20)) # put all measuring datasets in a list
(mean_Temp_moss_data_19_20 <- Reduce(`+`, list_measuring_temp_moss_19_20)/length(list_measuring_temp_moss_19_20)) # average them 

(list_active_temp_moss_19_20 <-list(mean_Temp_active_X1_19_20, mean_Temp_active_X2_19_20, mean_Temp_active_X4_19_20)) # put all active datasets in a list
(mean_active_Temp_moss_data_19_20 <- Reduce(`+`, list_active_temp_moss_19_20)/length(list_active_temp_moss_19_20)) # average them 

# Mean temperature summer 20-21

(list_measuring_temp_moss_20_21 <-list(mean_Temp_X1_20_21, mean_Temp_X2_20_21, mean_Temp_X4_20_21)) # put all measuring datasets in a list
(mean_Temp_moss_data_20_21 <- Reduce(`+`, list_measuring_temp_moss_20_21)/length(list_measuring_temp_moss_20_21)) # average them 

(list_active_temp_moss_20_21 <-list(mean_Temp_active_X1_20_21, mean_Temp_active_X2_20_21, mean_Temp_active_X4_20_21)) # put all active datasets in a list
(mean_Temp_moss_data_20_21 <- Reduce(`+`, list_active_temp_moss_20_21)/length(list_active_temp_moss_20_21)) # average them 

# Mean temperature summer 21-22

(list_measuring_temp_moss_21_22 <-list(mean_Temp_X1_21_22, mean_Temp_X2_21_22, mean_Temp_X4_21_22)) # put all measuring datasets in a list
(mean_Temp_moss_data_21_22 <- Reduce(`+`, list_measuring_temp_moss_21_22)/length(list_measuring_temp_moss_21_22)) # average them 

(list_active_temp_moss_21_22 <-list(mean_Temp_active_X1_21_22, mean_Temp_active_X2_21_22, mean_Temp_active_X4_21_22)) # put all active datasets in a list
(mean_Temp_moss_data_21_22 <- Reduce(`+`, list_active_temp_moss_21_22)/length(list_active_temp_moss_21_22)) # average them 

# Mean temperature summer 22-23

(list_measuring_temp_moss_22_23 <-list(mean_Temp_X1_22_23, mean_Temp_X2_22_23, mean_Temp_X4_22_23)) # put all measuring datasets in a list
(mean_Temp_moss_data_22_23 <- Reduce(`+`, list_measuring_temp_moss_22_23)/length(list_measuring_temp_moss_22_23)) # average them 

(list_active_temp_moss_22_23 <-list(mean_Temp_active_X1_22_23, mean_Temp_active_X2_22_23, mean_Temp_active_X4_22_23)) # put all active datasets in a list
(mean_Temp_moss_data_22_23 <- Reduce(`+`, list_active_temp_moss_22_23)/length(list_active_temp_moss_22_23)) # average them 

```

3.3. Month Temperature

```{r}
(list_measuring_month_temp_moss <-list(month_temp_stats_X1, month_temp_stats_X2, month_temp_stats_X4)) # put all datasets in a list
(mean_measuring_Temp_moss_data <- Reduce(`+`, list_measuring_month_temp_moss)/length(list_measuring_month_temp_moss)) # average them 

```

**4.PAR**

```{r}
(list_measuring_PAR_moss <-list(mean_PAR_active_X1_data, mean_PAR_active_X2_data, mean_PAR_active_X4_data)) # put all datasets in a list
(mean_measuring_PAR_moss <- Reduce(`+`, list_measuring_PAR_moss)/length(list_measuring_PAR_moss)) # average them 

```

4.2. Summerly PAR

```{r}
(list_measuring_PAR_moss_19_20 <-list(mean_PAR_X1_19_20, mean_PAR_X2_19_20, mean_PAR_X4_19_20)) # put all datasets in a list
(mean_measuring_PAR_moss_19_20 <- Reduce(`+`, list_measuring_PAR_moss_19_20)/length(list_measuring_PAR_moss_19_20)) # average them 

(list_measuring_PAR_moss_20_21 <-list(mean_PAR_X1_20_21, mean_PAR_X2_20_21, mean_PAR_X4_20_21)) # put all datasets in a list
(mean_measuring_PAR_moss_20_21 <- Reduce(`+`, list_measuring_PAR_moss_20_21)/length(list_measuring_PAR_moss_20_21)) # average them 

(list_measuring_PAR_moss_21_22 <-list(mean_PAR_X1_21_22, mean_PAR_X2_21_22, mean_PAR_X4_21_22)) # put all datasets in a list
(mean_measuring_PAR_moss_21_22 <- Reduce(`+`, list_measuring_PAR_moss_21_22)/length(list_measuring_PAR_moss_21_22)) # average them 

(list_measuring_PAR_moss_22_23 <-list(mean_PAR_X1_22_23, mean_PAR_X2_22_23, mean_PAR_X4_22_23)) # put all datasets in a list
(mean_measuring_PAR_moss_22_23 <- Reduce(`+`, list_measuring_PAR_moss_22_23)/length(list_measuring_PAR_moss_22_23)) # average them 
```

4.3. Monthly PAR

```{r}
(list_measuring_monthly_PAR_moss <-list(month_PAR_stats_X1, month_PAR_stats_X2, month_PAR_stats_X4)) # put all datasets in a list
(mean_measuring_monthly_PAR_moss <- Reduce(`+`, list_measuring_monthly_PAR_moss)/length(list_measuring_monthly_PAR_moss)) # average them 

```

**5. YIELD and ETR**

```{r}
# Active period----

(list_measuring_active_yield_moss <-list(mean_yield_active_X1_data, mean_yield_active_X2_data, mean_yield_active_X4_data)) # put all datasets in a list
(mean_measuring_active_yield_moss <- Reduce(`+`, list_measuring_active_yield_moss)/length(list_measuring_active_yield_moss)) # average them 

(list_measuring_active_ETR_moss <-list(mean_ETR_active_X1_data, mean_ETR_active_X2_data, mean_ETR_active_X4_data)) # put all datasets in a list
(mean_measuring_active_ETR_moss <- Reduce(`+`, list_measuring_active_yield_moss)/length(list_measuring_active_yield_moss)) # average them 

```

5.2 Summer yield/ ETR

```{r}
# Mean YIED/ETR summer 19-20

(list_measuring_active_yield_moss_19_20 <-list(mean_yield_X4_19_20, mean_yield_X4_19_20, mean_yield_X4_19_20)) # put all datasets in a list
(mean_measuring_active_yield_moss_19_20 <- Reduce(`+`, list_measuring_active_yield_moss_19_20)/length(list_measuring_active_yield_moss_19_20)) # average them 

(list_measuring_active_ETR_moss_19_20 <-list(mean_ETR_X4_19_20, mean_ETR_X4_19_20, mean_ETR_X4_19_20)) # put all datasets in a list
(mean_measuring_active_ETR_moss_19_20 <- Reduce(`+`, list_measuring_active_ETR_moss_19_20)/length(list_measuring_active_ETR_moss_19_20)) # average them 

# Mean YIED/ETR summer 20-21

(list_measuring_active_yield_moss_20_21 <-list(mean_yield_X1_20_21, mean_yield_X2_20_21, mean_yield_X4_20_21)) # put all datasets in a list
(mean_measuring_active_yield_moss_20_21 <- Reduce(`+`, list_measuring_active_yield_moss_20_21)/length(list_measuring_active_yield_moss_20_21)) # average them 

(list_measuring_active_ETR_moss_20_21 <-list(mean_ETR_X4_20_21, mean_ETR_X4_20_21, mean_ETR_X4_20_21)) # put all datasets in a list
(mean_measuring_active_ETR_moss_20_21 <- Reduce(`+`, list_measuring_active_ETR_moss_20_21)/length(list_measuring_active_ETR_moss_20_21)) # average them 

# Mean YIED/ETR summer 21-22

(list_measuring_active_yield_moss_21_22 <-list(mean_yield_X1_21_22, mean_yield_X2_21_22, mean_yield_X4_21_22)) # put all datasets in a list
(mean_measuring_active_yield_moss_21_22 <- Reduce(`+`, list_measuring_active_yield_moss_21_22)/length(list_measuring_active_yield_moss_21_22)) # average them 

(list_measuring_active_ETR_moss_21_22 <-list(mean_ETR_X4_21_22, mean_ETR_X4_21_22, mean_ETR_X4_21_22)) # put all datasets in a list
(mean_measuring_active_ETR_moss_21_22 <- Reduce(`+`, list_measuring_active_ETR_moss_21_22)/length(list_measuring_active_ETR_moss_21_22)) # average them 

# Mean YIED/ETR summer 22-23

(list_measuring_active_yield_moss_22_23 <-list(mean_yield_X1_22_23, mean_yield_X2_22_23, mean_yield_X4_22_23)) # put all datasets in a list
(mean_measuring_active_yield_moss_22_23 <- Reduce(`+`, list_measuring_active_yield_moss_22_23)/length(list_measuring_active_yield_moss_22_23)) # average them 

(list_measuring_active_ETR_moss_22_23 <-list(mean_ETR_X4_22_23, mean_ETR_X4_22_23, mean_ETR_X4_22_23)) # put all datasets in a list
(mean_measuring_active_ETR_moss_22_23 <- Reduce(`+`, list_measuring_active_ETR_moss_22_23)/length(list_measuring_active_ETR_moss_22_23)) # average them 

```

5.3. Monthly

```{r}
# Yield
(list_measuring_active_yield_moss_monthly <-list(month_Y_stats_X1, month_Y_stats_X2, month_Y_stats_X4)) # put all datasets in a list
(mean_measuring_active_yield_moss_monthly <- Reduce(`+`, list_measuring_active_yield_moss_monthly)/length(list_measuring_active_yield_moss_monthly)) # average them 

# ETR

(list_measuring_active_ETR_moss_monthly <-list(month_ETR_stats_X1, month_ETR_stats_X2, month_ETR_stats_X4)) # put all datasets in a list
(mean_measuring_active_ETR_moss_monthly <- Reduce(`+`, list_measuring_active_ETR_moss_monthly)/length(list_measuring_active_ETR_moss_monthly)) # average them

```


### 9.6. Meteorological

1. Import and take a look at data
```{r}
data_met <- read_csv("data_meteorology_complete.csv")
skimr::skim(data_met)  # see a summary of the whole data
str(data_met)  # see the structure of each variable
tail(data_met)  # view the last 6 rows of data
head(data_met)  # view the first 6 rows of data
```
3. Structure data so it is useful

```{r}
# Clean Names and remove unnecessary columns

data_met$DateTime <- paste(data_met$Date.UTC, data_met$Time.UTC)

# Check whether there are NAs (affect calculations)

(colSums(is.na(data_met[, c("Tmean", "Tmax", "Tmin", "Rhmean")]))) # COunt number of NAs in each column
# remove NAs

# Some of the dates have data from 2 stations. Average both to get 1 useful value
data_met <- data_met %>% 
   filter(!is.na(Tmean) & !is.na(Tmax) & !is.na(Tmin) & !is.na(Rhmean)) %>% # remove NAs before grouping
  group_by(DateTime) %>% # Group by the measurements that have the same date and time
  summarise(Tmean = mean(Tmean),
            Tmax = mean(Tmax),
            Tmin = mean(Tmin),
            Rhmean = mean(Rhmean),
            Date.UTC = unique(as.Date(Date.UTC)),
            Time.UTC = unique(hms::as_hms(Time.UTC))) %>% 
  ungroup()

# check wether there are any NAs
(which(is.na(data_met$Tmean) | is.na(data_met$Tmax) | is.na(data_met$Tmin) | is.na(data_met$Rhmean))) # Gives row of NAs
# No more NAs

```

3.2. Create column for year and month

```{r}
data_met$DateTime <- as.POSIXct(data_met$DateTime, format="%d/%m/%Y %H:%M:%S", tz="UTC") # put the object as a date

data_met<- data_met %>%  # create new columns with month, year,
  mutate(Month = month(DateTime), # day, minute                     
         Year = year(DateTime),
         Day = day(DateTime),
         Hour = hour(DateTime), 
         Minute = minute(DateTime))

```

3.3. Mean temperature of the whole measuring period

```{r}
(mean_air_t_measuring_per <- data_met %>% 
  summarise(MeanT = mean(Tmean),
            MaxT =  max(Tmax),
            MinT = min(Tmin),
            Max_meanT = max(Tmean),
            Min_meanT = min(Tmean),
            mean_maxT = mean(Tmax),
            mean_minT = mean(Tmin)))

```

3.4. Mean temperature per summer

```{r}

data_met <- data_met %>% # Create a column specifying the summer
  mutate(Summer = case_when(
    Year == 2019 & Month %in% c(11,12) |  Year == 2020 & Month %in% c(1,2) ~ "Summer_19_20",
    Year == 2020 & Month %in% c(11,12) |  Year == 2021 & Month %in% c(1,2) ~ "Summer_20_21",
    Year == 2021 & Month %in% c(11,12) |  Year == 2022 & Month %in% c(1,2) ~ "Summer_21_22",
    Year == 2022 & Month %in% c(11,12) |  Year == 2023 & Month %in% c(1,2) ~ "Summer_22_23"))

(mean_air_t_summer <- data_met %>% 
  group_by(Summer) %>% 
  summarise(MeanT = mean(Tmean),
            MaxT =  max(Tmax),
            MinT = min(Tmin),
            Max_meanT = max(Tmean),
            Min_meanT = min(Tmean),
            mean_maxT = mean(Tmax),
            mean_minT = mean(Tmin)))
```

3.5. Mean temperature per month

```{r}

data_met <- data_met %>% # Create a column specifying the month-year
  mutate(Year_month = paste(Year, Month, sep = "-"))

mean_air_t_month <- data_met %>% 
  filter(!is.na(Summer)) %>%  # remove the values that are not in any summer. They aren't part of measuring period
 group_by(Year_month) %>% 
  summarise(MeanT = mean(Tmean),
            MaxT =  max(Tmax),
            MinT = min(Tmin),
            Max_meanT = max(Tmean),
            Min_meanT = min(Tmean),
            mean_maxT = mean(Tmax),
            mean_minT = mean(Tmin),
            Month = unique(Month),
            Year = unique(Year)) %>% 
  arrange(Year, Month, .by_group = TRUE) # arrange variables chronologically

write.xlsx(mean_air_t_month, file = "stats/met/mean_air_t_month.xlsx") # save table

```

3.6. Mean RH of the whole measuring period

```{r}
(mean_air_Rh_measuring_per <- data_met %>% 
  summarise(MeanRh = mean(Rhmean),
            Max_meanRh = max(Rhmean),
            Min_meanRh = min(Rhmean)))

```

3.4. Mean RH per summer

```{r}

data_met <- data_met %>% # Create a column specifying the summer
  mutate(Summer = case_when(
    Year == 2019 & Month %in% c(11,12) |  Year == 2020 & Month %in% c(1,2) ~ "Summer_19_20",
    Year == 2020 & Month %in% c(11,12) |  Year == 2021 & Month %in% c(1,2) ~ "Summer_20_21",
    Year == 2021 & Month %in% c(11,12) |  Year == 2022 & Month %in% c(1,2) ~ "Summer_21_22",
    Year == 2022 & Month %in% c(11,12) |  Year == 2023 & Month %in% c(1,2) ~ "Summer_22_23"))

(mean_air_rh_summer <- data_met %>% 
  group_by(Summer) %>% 
  summarise(MeanRh = mean(Rhmean),
            Max_meanRh = max(Rhmean),
            Min_meanRh = min(Rhmean)))
```

3.5. Mean RH per month

```{r}

data_met <- data_met %>% # Create a column specifying the month-year
  mutate(Year_month = paste(Year, Month, sep = "-"))

mean_air_rh_month <- data_met %>% 
  filter(!is.na(Summer)) %>%  # remove the values that are not in any summer. They aren't part of measuring period
 group_by(Year_month) %>% 
  summarise(MeanRh = mean(Rhmean),
            Max_meanRh = max(Rhmean),
            Min_meanRh = min(Rhmean),
            Month = unique(Month),
            Year = unique(Year)) %>% 
  arrange(Year, Month, .by_group = TRUE) # arrange variables chronologically

write.xlsx(mean_air_rh_month, file = "stats/met/mean_air_rh_month.xlsx") # save table
```

## 11. Plot data for all the measuring period

### 11.1. Graph for PAR year round (This need to be changed to include 2022-2023)

```{r}
(PAR_year_round_19_22 <- data_clean %>%
  mutate(mean_PAR = rowMeans(select(., c("X1.PAR", "X2.PAR", "X3.PAR", "X4.PAR")), na.rm = TRUE)) %>%  # calculate mean PAR across all samples
  ggplot(aes(Date, mean_PAR)) +  # plot it
  geom_line() +
  theme_graphs_env_cond() +
  scale_x_datetime(date_breaks = "1 month", date_labels = "%m %Y") +
  ylab("PAR\n(µmol m-2 s^-1)"))

ggsave(filename = "graphs_env_conditions/PAR_year_round_19_22.png", PAR_year_round_19_22, width = 54,height = 18, units = "cm", device = "png")  # Save graph

```

### 11.2. Graph for yield year round

```{r}

# (yield_year_round_19_22 <- data_clean %>%  # not in use
#  ggplot() +
# geom_point(aes(Date, X1.Y, color = "Bryum argemteum"), alpha = 0.4) +
#  geom_point(aes(Date, X2.Y, color = "Bryum argemteum"), alpha = 0.4) + 
#  geom_point(aes(Date, X3.Y, color = "Austroplaca soropelta"), alpha = 0.7) +
#  geom_point(aes(Date, X4.Y, color = "Bryum argemteum"), alpha = 0.4) +
#  theme_graphs_env_cond() +
#  scale_x_datetime(date_breaks = "1 month", date_labels = "%m %Y") +
#  scale_color_manual(values = c("Bryum argemteum" = "#119683", "Austroplaca soropelta" = "#ff914d")) +
#  labs(color = "Species") + # This adds a legend for the colors
#   ylab("Yield"))  # This sets the y-axis label to "Yield"

(yield_year_round_19_22 <- rbind(data_clean)%>%
  ggplot() +
  geom_line(aes(Date, X1.Y, color = "Bryum argemteum"), alpha = 0.4) +
  geom_line(aes(Date, X2.Y, color = "Bryum argemteum"), alpha = 0.4) + 
  geom_line(aes(Date, X3.Y, color = "Austroplaca soropelta"), alpha = 0.7) +
  geom_line(aes(Date, X4.Y, color = "Bryum argemteum"), alpha = 0.4) +
  theme_graphs_env_cond() +
  scale_x_datetime(date_breaks = "1 month", date_labels = "%m %Y") +
  scale_color_manual(values = c("Bryum argemteum" = "#119683", "Austroplaca soropelta" = "#ff914d")) +
  labs(color = "Species") + # This adds a legend for the colors
   ylab("Yield"))  # This sets the y-axis label to "Yield"

(yield_year_round_19_22 <- rbind(data_clean_23)%>%
  ggplot() +
  geom_line(aes(Date, X1.Y, color = "Bryum argemteum"), alpha = 0.4) +
  geom_line(aes(Date, X2.Y, color = "Bryum argemteum"), alpha = 0.4) + 
  geom_line(aes(Date, X3.chosen_yield, color = "Austroplaca soropelta"), alpha = 0.7) +
  geom_line(aes(Date, X4.chosen_yield, color = "Bryum argemteum"), alpha = 0.4) +
  theme_graphs_env_cond() +
  scale_x_datetime(date_breaks = "1 month", date_labels = "%m %Y") +
  scale_color_manual(values = c("Bryum argemteum" = "#119683", "Austroplaca soropelta" = "#ff914d")) +
  labs(color = "Species") + # This adds a legend for the colors
   ylab("Yield"))  # This sets the y-axis label to "Yield"

ggsave(filename = "graphs_year_round/yield_year_round_19_22.png", yield_year_round_19_22, width = 54,height = 18, units = "cm",device = "png")  # Save graph
```

### 11.3. Graph for T year round
```{r}
(temp_year_round_19_22 <- data_clean %>%
  mutate(mean_Temp = rowMeans(select(., c("X1.Temp", "X2.Temp", "X3.Temp", "X4.Temp")), na.rm = TRUE)) %>%  # calcualte mean PAR across all samples
  ggplot(aes(Date, mean_Temp)) +
  geom_line() +
  theme_graphs_env_cond() +
  scale_x_datetime(date_breaks = "1 month", date_labels = "%m %Y") +
  ylab("Temperature ºC"))

ggsave(filename = "graphs_env_conditions/temp_year_round_19_22.png", temp_year_round_19_22, width = 54,height = 18, units = "cm", device = "png")  # Save graph
```


## 12. Plot data for the heatwave March 2022


