---
title: "code_data_changed_yield"
author: "Ainhoa"
date: "2023-12-18"
output: html_document
editor_options: 
  chunk_output_type: console
---

1.  Set working directory

```{r}
setwd("~/Library/CloudStorage/OneDrive-UniversityofEdinburgh/dissertation/dissertation/dissertation")
```

2.  Load packages

```{r, message=FALSE}
library(skimr)  # summary
library(tidyverse)
library(lubridate)  # dates management
library(gridExtra)  # arrange plots
library(patchwork)  # combine plots
```
2.2. Creates functions

- Function for graph asthetics

```{r, echo= TRUE, results="hide"}
theme_graphs_env_cond <- function(){
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90))+
   theme(axis.text = element_text(size = 11),  # Adjust the size as needed
          axis.title = element_text(size = 18),
        legend.text = element_text(size=14))
  }
```

3.  Load the data and see its structure

```{r}
data <- read_csv("Data_set_PAM_ScottBase_with_ calc_yield.csv") # load data until 22
data_23 <- read_csv("Datset_until_11-23_paste.csv") # load data until nov-23
skimr::skim(data)  # see a summary of the whole data
skimr::skim(data_23)
str(data)  # see the structure of each variable
str(data_23)
tail(data)  # view the last 6 rows of data
tail(data_23)
head(data)  # view the first 6 rows of data
head(data_23)
```

Data of sensors 1,2 and 4 are for the moss and 3 is for the lichen. Data is from Jan 2019 to Feb 2022. I am going to consider summer form 1 Nov to 15 Feb. I currently have data for 3 summers: 2019-2020, 2020-2021, 2021-2022.
20th-nov-2023
Added the data for summer 22-23. Find in section 5.2

## 4. Format data in a way that is going to be useful to me

4.1. Remove weird times and dates and divide the useful ones

```{r}
data_clean <- data[, -c(2:13)] %>%   # create a new data set without columns 2 to 13
  mutate(Day_cum = as.numeric(data$Date)) # maintain cumulative date but change column name to more informative one and make it numeric

data_clean <- data_clean %>% 
  mutate(Date = parse_date_time(Datetime, 'dmy HM'))   # indicate the format the date is wanted

print(data_clean[is.na(data_clean$Date), ])  # Check for rows with parsing issues\
#  Row 584 is problematic

data_clean[584, 1]<-"10/02/2019 10:08"  # Change the value to the correct one 

data_clean <- data_clean %>% 
  mutate(Date = parse_date_time(Datetime, 'dmy HM'))   # repeat with all the lines working

data_clean <- data_clean %>%  # create new columns with month, year,
  mutate(Month = month(Date), # day, minute                     
         Year = year(Date),
         Day = day(Date),
         Hour = hour(Date), 
         Minute = minute(Date))

data_clean[584,]  # check it worked

```

4.2. Check the new data

```{r, echo= TRUE, results='hide'}
str(data_clean)
skimr::skim(data_clean)
```
4.3. Rename coulmns so it is easy to use

```{r}

colnames(data_clean) <- if_else(grepl("^\\d", colnames(data_clean)), paste0("X", colnames(data_clean)), colnames(data_clean)) # Add an X in front of numeric columns so it is easier to type the names

data_clean <- data_clean %>%  # Rename certain columns to make them friendlier to use
  rename(X4.calc_yield = `:calc_yield`,
         X1.F = `X1:F`,
         X1.Fm = `X1.Fm'`,
         X2.Fm = `X2.Fm'`,
         X3.Fm =`X3.Fm'`,
         X4.Fm = `X4.Fm'`)

```
4.4. Need to change some variables of format

```{r, warning = FALSE, eval=FALSE}
# eval= False --> don't run this chunk --> no needed
 data_clean <- data_clean %>%
 mutate(X1.PAR = as.numeric(X1.PAR),  # Change PAR of X1, X2 and X3 to numeric
         X2.PAR = as.numeric(X2.PAR), 
         X3.PAR = as.numeric(X3.PAR), 
         X4.PAR = as.numeric(X4.PAR),
         X3.F = as.numeric(X3.F),  # Change F and Fm to numeric
         X3.Fm = as.numeric(X3.Fm),
         X3.Temp = as.numeric(X3.Temp),  # Change Temp 3 to numeric
         X1.diff = as.numeric(X1.diff),  # Change all diff to numeric
         X2.diff = as.numeric(X2.diff),
         X3.diff = as.numeric(X3.diff),
         X4.diff = as.numeric(X4.diff))
         #Month = as.factor(Month),  # Change day, month and year to categories -> is it a great idea?
         #Year = as.factor(Year), 
         #Day = as.factor(Day))
```

4.5. Create column for month (in letters) and day-month 

```{r}
data_clean <- data_clean %>% 
  mutate(Month_Name = as.factor(case_when(  # Make a column with the names of the months and make them a factor
  Month == 1 ~ "Jan",  # case_when from dplyr package
  Month == 2 ~ "Feb",
  Month == 3 ~ "Mar",
  Month == 4 ~ "Apr",
  Month == 5 ~ "May",
  Month == 6 ~ "Jun",
  Month == 7 ~ "Jul",
  Month == 8 ~ "Aug",
  Month == 9 ~ "Sep",
  Month == 10 ~ "Oct",
  Month == 11 ~ "Nov",
  Month == 12 ~ "Dec"))) %>% 
  mutate(Date_Combined = as.factor(  # Make a column with the day and month name separated by -
    paste(Month_Name, Day, sep = "-")))  # Make the column a factor

```

4.6. Fix Day_cum

```{r}
print(data_clean[is.na(data_clean$Day_cum), ])  # Check for rows with NAs in Day_cum

# From 25/01/2022 the date format changes and it is not cummulative anymore

data_clean <- data_clean %>%
  mutate(Date_no_time = paste(year(Date), month(Date), day(Date), sep = "-")) %>%  # Create acolumn with the date but without the time
  mutate(Day_cum = if_else(No. >= 26510, 44586 + as.numeric(difftime(Date_no_time, as.Date("2022-01-25"), units = "days")), Day_cum)) %>%  # Fix the format of Day_cum after the 25/01/2022
  # Difftime weeks the time passed between 2 days in the units indicated
  select(-Date_no_time)  # Remove Date_no_time from the data set
  
print(data_clean[is.na(data_clean$Day_cum), ])  # Check for rows with NAs in Day_cum

head(data_clean$Date_Combined)  # Check it worked
tail(data_clean$Date_Combined)


```

4.7. Create a column for average moss values of yield, PAR, F, Fm, Temp, ETR and diff

```{r}
data_clean <- data_clean %>% 
  mutate(av_moss_yield = rowMeans(data_clean[, c("X1.Y", "X2.Y", "X4.Y")]),  # rowMeans gets the mean of each row in the data frame and stores the result in a new column
         av_moss_PAR = rowMeans(data_clean[, c("X1.PAR", "X2.PAR", "X4.PAR")]),
         av_moss_F = rowMeans(data_clean[, c("X1.F", "X2.F", "X4.F")]),
         av_moss_Fm = rowMeans(data_clean[, c("X1.Fm", "X2.Fm", "X4.Fm")]),
         av_moss_temp = rowMeans(data_clean[, c("X1.Temp", "X2.Temp", "X4.Temp")]),
         av_moss_ETR = rowMeans(data_clean[, c("X1.ETR", "X2.ETR", "X4.ETR")]),
         av_moss_diff = rowMeans(data_clean[, c("X1.diff", "X2.diff", "X4.diff")]))
```

## 5. Subset data for summers 2019-2020, 2020-2021, 2021-2022

**Summer 2019-2020**

This includes the data from the 1-Nov 2019 to the 15 of Feb 2020

```{r}
summer_19_20 <- data_clean %>% 
  filter(Year == 2019 & Month %in% c(11,12) |  # Filter all data points in Nov, Dec 2019 and Jan, Feb 2020
           Year == 2020 & Month %in% c(1,2)) %>% 
  filter(!(Month == 2 & Day > 15))  # remove days over the 15th of Feb

# Check our data

head(summer_19_20)  # First 6 rows 
tail(summer_19_20)  # Last 6 rows

summer_19_20$Date_Combined <- reorder(summer_19_20$Date_Combined, summer_19_20$Day_cum)  # reorder the factors of Date_Combined according to the values of Day_cum. Do it for each subset individually because factors repeat for each year

levels(summer_19_20$Date_Combined)
```

**Summer 2020-2021**

This includes the data from the 1-Nov 2020 to the 15 of Feb 2021

```{r}
summer_20_21 <- data_clean %>% 
  filter(Year == 2020 & Month %in% c(11,12) |  # Filter all data points in Nov, Dec 2029 and Jan, Feb 2021
           Year == 2021 & Month %in% c(1,2)) %>% 
  filter(!(Month == 2 & Day > 15))  # remove days over the 15th of Feb

# Check our data

head(summer_20_21)  # First 6 rows 
tail(summer_20_21)  # Last 6 rows

summer_20_21$Date_Combined <- reorder(summer_20_21$Date_Combined, summer_20_21$Day_cum)  # reorder the factors of Date_Combined according to the values of Day_cum. Do it for each subset individually because factors repeat for each year

levels(summer_20_21$Date_Combined)
```

**Summer 2021-2022**

This includes the data from the 1-Nov 2021 to the 15 of Feb 2022.

\* I only have the data until the 3rd of Feb yet

```{r}
summer_21_22 <- data_clean %>% 
  filter(Year == 2021 & Month %in% c(11,12) |  # Filter all data points in Nov, Dec 2021 and Jan, Feb 2022
           Year == 2022 & Month %in% c(1,2)) %>% 
  filter(!(Month == 2 & Day > 15))  # remove days over the 15th of Feb

# Check our data

head(summer_21_22)  # First 6 rows 
tail(summer_21_22)  # Last 6 rows

summer_21_22$Date_Combined <- reorder(summer_21_22$Date_Combined, summer_21_22$Day_cum)  # reorder the factors of Date_Combined according to the values of Day_cum. Do it for each subset individually because factors repeat for each year

levels(summer_21_22$Date_Combined)
```

## 5.2 Format data set 2022-2023 and subset summer 2021-2022 and 2022-2023 

5.2.1 Remove the weird times and divide the useful ones

```{r}
data_clean_23 <- data_23[, -c(1:3,6,8,9)] %>%   # create a new data set without columns 1, 2, 3, 6, 8, 9
  mutate(Day_cum = floor(`Excel date`)) %>%  # maintain cumulative date but change column name to more informative one and truncate it to remove decimals (floor function)
  select(-`Excel date`)  # remove Excel date from the final product

data_clean_23<- data_clean_23 %>% 
  mutate(Date = parse_date_time(Date, 'dmy'))   # indicate the format the date is wanted

nrow(data_clean_23[is.na(data_clean_23$Date), ])  # Check for rows with parsing issues\

#  No problematic rows

data_clean_23 <- data_clean_23 %>%  # create new columns with month, year,
  mutate(Month = month(Date), # day, minute                     
         Year = year(Date),
         Day = day(Date),
         Hour = hour(Time), 
         Minute = minute(Time))

```

5.2.2. Check the new data

```{r, echo= TRUE, results='hide'}
str(data_clean_23)
skimr::skim(data_clean_23)
```
5.2.3. Rename columns so it is easy to use

```{r}

colnames(data_clean_23) <- if_else(grepl("^\\d", colnames(data_clean_23)), paste0("X", colnames(data_clean_23)), colnames(data_clean_23)) # Add an X in front of numeric columns so it is easier to type the names

data_clean_23 <- data_clean_23 %>%  # Rename certain columns to make them friendlier to use
  rename(X2.Y = X2.Y...23,
         X2.Y_calc = X2.Y...25)

```

5.2.4. Create column for month (in letters) and day-month 

```{r}
data_clean_23 <- data_clean_23 %>% 
  mutate(Month_Name = as.factor(case_when(  # Make a column with the names of the months and make them a factor
  Month == 1 ~ "Jan",  # case_when from dplyr package
  Month == 2 ~ "Feb",
  Month == 3 ~ "Mar",
  Month == 4 ~ "Apr",
  Month == 5 ~ "May",
  Month == 6 ~ "Jun",
  Month == 7 ~ "Jul",
  Month == 8 ~ "Aug",
  Month == 9 ~ "Sep",
  Month == 10 ~ "Oct",
  Month == 11 ~ "Nov",
  Month == 12 ~ "Dec"))) %>% 
  mutate(Date_Combined = as.factor(  # Make a column with the day and month name separated by -
    paste(Month_Name, Day, sep = "-")))  # Make the column a factor

```

5.2.5. Fix Day_cum

```{r}
nrow(data_clean_23[is.na(data_clean_23$Day_cum), ])   # Check for rows with NAs in Day_cum

# There is 0, so no need to check anything
```

5.2.6. Create difference columns

```{r}
data_clean_23 <- data_clean_23 %>% 
  mutate(X1.diff = X1.Fm - X1.F,
         X2.diff = X2.Fm - X2.F,
         X3.diff = X3.Fm - X3.F,
         X4.diff = X4.Fm - X4.F)
```

5.2.7. Create a column for average moss values of yield, PAR, F, Fm, Temp, ETR and diff

```{r}
data_clean_23 <- data_clean_23 %>% 
  mutate(av_moss_yield = rowMeans(data_clean_23[, c("X1.Y", "X2.Y", "X4.Y")]),  # rowMeans gets the mean of each row in the data frame and stores the result in a new column
         av_moss_PAR = rowMeans(data_clean_23[, c("X1.PAR", "X2.PAR", "X4.PAR")]),
         av_moss_F = rowMeans(data_clean_23[, c("X1.F", "X2.F", "X4.F")]),
         av_moss_Fm = rowMeans(data_clean_23[, c("X1.Fm", "X2.Fm", "X4.Fm")]),
         av_moss_temp = rowMeans(data_clean_23[, c("X1.Temp", "X2.Temp", "X4.Temp")]),
         av_moss_ETR = rowMeans(data_clean_23[, c("X1.ETR", "X2.ETR", "X4.ETR")]),
         av_moss_diff = rowMeans(data_clean_23[, c("X1.diff", "X2.diff", "X4.diff")]))
```

5.2.8. Subset **Summer 2022-2023**

```{r}
summer_22_23 <- data_clean_23 %>% 
  filter(Year == 2022 & Month %in% c(11,12) |  # Filter all data points in Nov, Dec 2022 and Jan, Feb 20223
           Year == 2023 & Month %in% c(1,2)) %>% 
  filter(!(Month == 2 & Day > 15))  # remove days over the 15th of Feb

# Check our data

head(summer_22_23)  # First 6 rows 
tail(summer_22_23)  # Last 6 rows

summer_22_23$Date_Combined <- reorder(summer_22_23$Date_Combined, summer_22_23$Day_cum)  # reorder the factors of Date_Combined according to the values of Day_cum. Do it for each subset individually because factors repeat for each year

levels(summer_22_23$Date_Combined)
```

## 6. Make plots with yield, Calc_yield, Fm and Ft to see what is the correct measure

1. Summer 2019-2020

Sample X1 (moss)

```{r}
(Yield_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X1 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_19_20_X1 <- (Ft_plot_19_20_X1/Diff_plot_19_20_X1/Yield_plot_19_20_X1/Yield_calc_plot_19_20_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_19_20_X1.png", ana_yield_19_20_X1, device = "png")  # Save graph
```

Sample X2 (moss)

```{r}
(Yield_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X2 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_19_20_X2 <- (Ft_plot_19_20_X2/Diff_plot_19_20_X2/Yield_plot_19_20_X2/Yield_calc_plot_19_20_X2) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_19_20_X2.png", ana_yield_19_20_X2, device = "png")  # Save graph
```

Sample X3 (lichen)

```{r}
(Yield_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X3.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X3.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X3.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nLichen X3 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_19_20_X3 <- (Ft_plot_19_20_X3/Diff_plot_19_20_X3/Yield_plot_19_20_X3/Yield_calc_plot_19_20_X3) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_19_20_X3.png", ana_yield_19_20_X3, device = "png")  # Save graph
```

Sample X4 (moss)

```{r}
(Yield_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X2 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_19_20_X4 <- (Ft_plot_19_20_X4/Diff_plot_19_20_X4/Yield_plot_19_20_X4/Yield_calc_plot_19_20_X4) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_19_20_X4.png", ana_yield_19_20_X4, device = "png")  # Save graph
```
2. Summer 2020-2021

Sample X1 (moss)

There is one row containing missing values in X1.diff and X1.yield_calc
```{r}
print(summer_20_21[is.na(summer_20_21$X1.diff),]) 
print(summer_20_21[is.na(summer_20_21$X1.calc_yield),]) 

# Solve line 2342 (6-feb)

summer_20_21[2342,8 ]<- 5  # Change the value to the correct one 
summer_20_21[2342,9 ]<- 5/67 # Change the value to the correct one 


# Check it is solved
print(summer_20_21[2342,])
```
Repeat Sample X1 (moss)

```{r}
(Yield_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X1 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_20_21_X1 <- (Ft_plot_20_21_X1/Diff_plot_20_21_X1/Yield_plot_20_21_X1/Yield_calc_plot_20_21_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_20_21_X1.png", ana_yield_20_21_X1, device = "png")  # Save graph

```
Sample X2 (moss)

```{r}
(Yield_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X2 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_20_21_X2 <- (Ft_plot_20_21_X2/Diff_plot_20_21_X2/Yield_plot_20_21_X2/Yield_calc_plot_20_21_X2) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_20_21_X2.png", ana_yield_20_21_X2, device = "png")  # Save graph
```
Sample X3 (lichen)

```{r}
(Yield_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nLichen X3 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_20_21_X3 <- (Ft_plot_20_21_X3/Diff_plot_20_21_X3/Yield_plot_20_21_X3/Yield_calc_plot_20_21_X3) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_20_21_X3.png", ana_yield_20_21_X3, device = "png")  # Save graph
```
Sample X4 (moss)

```{r}
(Yield_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X4 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_20_21_X4 <- (Ft_plot_20_21_X4/Diff_plot_20_21_X4/Yield_plot_20_21_X4/Yield_calc_plot_20_21_X4) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_20_21_X4.png", ana_yield_20_21_X4, device = "png")  # Save graph
```
3. Summer 2021-2022

Sample X1 (moss)

```{r}
(Yield_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X1 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_21_22_X1 <- (Fm_plot_21_22_X1/Ft_plot_21_22_X1/Diff_plot_21_22_X1/Yield_plot_21_22_X1/Yield_calc_plot_21_22_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_21_22_X1.png", ana_yield_21_22_X1, device = "png")  # Save graph
```
Sample X2 (moss)

```{r}
(Yield_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X2 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_21_22_X2 <- (Fm_plot_21_22_X2/Ft_plot_21_22_X2/Diff_plot_21_22_X2/Yield_plot_21_22_X2/Yield_calc_plot_21_22_X2) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_21_22_X2.png", ana_yield_21_22_X2, device = "png")  # Save graph
```

Sample X3 (Lichen)

```{r}
(Yield_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nLichen X3") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nLichen X3") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nLichen X3 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_21_22_X3 <- (Fm_plot_21_22_X3/Ft_plot_21_22_X3/Diff_plot_21_22_X3/Yield_plot_21_22_X3/Yield_calc_plot_21_22_X3) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_21_22_X3.png", ana_yield_21_22_X3, device = "png")  # Save graph
```

Sample X4 (moss)

```{r}
(Yield_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X4") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X4") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X4") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X4 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_21_22_X4 <- (Fm_plot_21_22_X4/Ft_plot_21_22_X4/Diff_plot_21_22_X4/Yield_plot_21_22_X4/Yield_calc_plot_21_22_X4) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_21_22_X4.png", ana_yield_21_22_X4, device = "png")  # Save graph
```

4. Summer 2022-2023

Sample X1 (moss)

```{r}
(Yield_plot_22_23_X1 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_22_23_X1 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X1.Y_calc)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_22_23_X1 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X1.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_22_23_X1 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X1.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_22_23_X1 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X1.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X1 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_22_23_X1 <- (Fm_plot_22_23_X1/Ft_plot_22_23_X1/Diff_plot_22_23_X1/Yield_plot_22_23_X1/Yield_calc_plot_22_23_X1) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_22_23_X1.png", ana_yield_22_23_X1, device = "png")  # Save graph
```

Sample X2 (moss)

```{r}
(Yield_plot_22_23_X2 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X2.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_22_23_X2 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X2.Y_calc)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X2") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_22_23_X2 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X2.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_22_23_X2 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X2.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_22_23_X2 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X2.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X2 ") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_22_23_X2 <- (Fm_plot_22_23_X2/Ft_plot_22_23_X2/Diff_plot_22_23_X2/Yield_plot_22_23_X2/Yield_calc_plot_22_23_X2) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_22_23_X2.png", ana_yield_22_23_X2, device = "png")  # Save graph
```

Sample X3 (Lichen)

There is one row containing NA value in Y_calc

```{r}
print(summer_22_23[is.na(summer_22_23$X3.Y_calc),]) 


# Solve line 2280 (3-feb)

## There is no temperature measurement for that line either--> It is a better approach to remove it

summer_22_23 <- summer_22_23[summer_22_23$No. != 1848, ]
  
```

Repeat Sample X3 (lichen)

```{r}
(Yield_plot_22_23_X3 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X3.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_22_23_X3 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X3.Y_calc)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_22_23_X3 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X3.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_22_23_X3 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X3.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_22_23_X3 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X3.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nLichen X3") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_22_23_X3 <- (Fm_plot_22_23_X3/Ft_plot_22_23_X3/Diff_plot_22_23_X3/Yield_plot_22_23_X3/Yield_calc_plot_22_23_X3) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_22_23_X3.png", ana_yield_22_23_X3, device = "png")  # Save graph
```
Sample X4 (moss)

```{r}
(Yield_plot_22_23_X4 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X4.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")))  # Remove axis label and text for the graph)

(Yield_calc_plot_22_23_X4 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X4.Y_calc)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield_calc \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(panel.grid.major.y = element_line(color = "gray")))

(Ft_plot_22_23_X4 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X4.F)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Ft \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1500, by = 50)))  # Remove axis label and text for the graph

(Fm_plot_22_23_X4 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X4.Fm)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Fm \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 1500, by = 50)))  # Remove axis label and text for the graph

(Diff_plot_22_23_X4 <- summer_22_23 %>% 
   ggplot(aes(Date_Combined, X4.diff)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Difference\nflourescence (a.u.) \nMoss X4") +  # a.u. means arbitrary unit
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major.y = element_line(color = "gray")) +
    scale_y_continuous(breaks = seq(0, 500, by = 50)))


(ana_yield_22_23_X4 <- (Fm_plot_22_23_X4/Ft_plot_22_23_X4/Diff_plot_22_23_X4/Yield_plot_22_23_X4/Yield_calc_plot_22_23_X4) & plot_layout(ncol = 1))

ggsave(filename = "graphs_yield/ana_yield_22_23_X4.png", ana_yield_22_23_X4, device = "png")  # Save graph
```



## 7. Make plots for PAR and Temperature in each summer, in each sample (check activity under snowcover)

1. Summer 2019-2020

Sample X1 (moss)

```{r}

(temp_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X1 (C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_19_20_X1 <-summer_19_20 %>% 
    ggplot(aes(Date_Combined, X1.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2019-2020 (day)", y = "PAR \n(mol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.Y)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(Yield_calc_plot_19_20_X1 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X1.calc_yield)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond())

(combined_plot_19_20_X1 <- (Yield_plot_19_20_X1/temp_plot_19_20_X1/PAR_plot_19_20_X1) & plot_layout(ncol = 1))

```

Sample X2 (moss)

```{r}
(temp_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X2 (C)") +
   theme_graphs_env_cond()+
   theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))

(PAR_plot_19_20_X2 <-summer_19_20 %>% 
    ggplot(aes(Date_Combined, X2.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2019-2020 (day)", y = "PAR \n(mol m-2 s^-1)") +
   theme_graphs_env_cond())
  
(Yield_plot_19_20_X2 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X2.Y..II.)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(combined_plot_19_20_X2 <- (Yield_plot_19_20_X2/temp_plot_19_20_X2/PAR_plot_19_20_X2) & plot_layout(ncol = 1))

```

Sample X3 (Lichen)

```{r}
(temp_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X3.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nLichen X3 (C)") +
   theme_graphs_env_cond()+
   theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))

(PAR_plot_19_20_X3 <-summer_19_20 %>% 
    ggplot(aes(Date_Combined, X3.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2019-2020 (day)", y = "PAR \n(mol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_19_20_X3 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X3.Y..II.)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)
  
(combined_plot_19_20_X3 <- (Yield_plot_19_20_X2/temp_plot_19_20_X3/PAR_plot_19_20_X3) & plot_layout(ncol = 1)) 

```

Sample X4 (Moss)

```{r}
(temp_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X4 (C)") +
   theme_graphs_env_cond()+
   theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))

(PAR_plot_19_20_X4 <-summer_19_20 %>% 
    ggplot(aes(Date_Combined, X4.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2019-2020 (day)", y = "PAR \n(mol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_19_20_X4 <- summer_19_20 %>% 
   ggplot(aes(Date_Combined, X4.Y..II.)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X4 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)
  
(combined_plot_19_20_X4 <- (Yield_plot_19_20_X4/temp_plot_19_20_X4/PAR_plot_19_20_X4) & plot_layout(ncol = 1)) 


```

2. Summer 2020-2021

Sample X1 (Moss)

```{r}
(temp_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X1 (C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_20_21_X1 <- summer_20_21 %>% 
    ggplot(aes(Date_Combined, X1.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2020-2021 (day)", y = "PAR \n(mol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_20_21_X1 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X1.Y..II.)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(combined_plot_20_21_X1 <- (Yield_plot_20_21_X1/temp_plot_20_21_X1/PAR_plot_20_21_X1) & plot_layout(ncol = 1))
```

Sample X2 (Moss)

```{r}
(temp_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X2 (C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_20_21_X2 <-summer_20_21 %>% 
    ggplot(aes(Date_Combined, X2.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2020-2021 (day)", y = "PAR \n(mol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_20_21_X2 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X2.Y..II.)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(combined_plot_20_21_X2 <- (Yield_plot_20_21_X2/temp_plot_20_21_X2/PAR_plot_20_21_X2) & plot_layout(ncol = 1))
```

Sample X3 (Lichen)

```{r}
(temp_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nLichen X3 (C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_20_21_X3 <-summer_20_21 %>% 
    ggplot(aes(Date_Combined, X3.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2020-2021(day)", y = "PAR \n(mol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_20_21_X3 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X3.Y..II.)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nLichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph)

(combined_plot_20_21_X3 <- (Yield_plot_20_21_X3/temp_plot_20_21_X3/PAR_plot_20_21_X3) & plot_layout(ncol = 1))
```
Sample X4 (moss)

```{r}
(temp_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X4 (C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_20_21_X4 <-summer_20_21 %>% 
    ggplot(aes(Date_Combined, X4.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2020-2021 (day)", y = "PAR \n(mol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_20_21_X4 <- summer_20_21 %>% 
   ggplot(aes(Date_Combined, X4.Y..II.)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(combined_plot_20_21_X4 <- (Yield_plot_20_21_X4/temp_plot_20_21_X4/PAR_plot_20_21_X4) & plot_layout(ncol = 1))
```

3. Summer 2021-2022

Sample X1 (moss)

```{r}
(temp_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X1 (C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_21_22_X1 <-summer_21_22 %>% 
    ggplot(aes(Date_Combined, X1.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2021-2022 (day)", y = "PAR \n(mol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_21_22_X1 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X1.Y..II.)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X1 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(combined_plot_21_22_X1 <- (Yield_plot_21_22_X1/temp_plot_21_22_X1/PAR_plot_21_22_X1) & plot_layout(ncol = 1))
```

Sample X2 (moss)

```{r}
(temp_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X2 (C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_21_22_X2 <-summer_21_22 %>% 
    ggplot(aes(Date_Combined, X2.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2021-2022 (day)", y = "PAR \n(mol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_21_22_X2 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X2.Y..II.)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \nMoss X2 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(combined_plot_21_22_X2 <- (Yield_plot_21_22_X2/temp_plot_21_22_X2/PAR_plot_21_22_X2) & plot_layout(ncol = 1))
```

Sample X3 (lichen)

```{r}
(temp_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X3 (C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_21_22_X3 <-summer_21_22 %>% 
    ggplot(aes(Date_Combined, X3.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2021-2022 (day)", y = "PAR \n(mol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_21_22_X3 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X3.Y..II.)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \n Lichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(combined_plot_21_22_X3 <- (Yield_plot_21_22_X3/temp_plot_21_22_X3/PAR_plot_21_22_X3) & plot_layout(ncol = 1))
```

Sample X4 (moss)

```{r}
(temp_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.Temp)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   geom_hline(yintercept = 0, color = "blue", linetype = "dashed") +
   labs(x = "\nDate (day)", y = "Temperature \nMoss X1 (C)") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(PAR_plot_21_22_X4 <-summer_21_22 %>% 
    ggplot(aes(Date_Combined, X4.PAR)) +
   geom_point()+  # Add points for the data
   geom_line()+  # add a line that joins the points
   labs(x = "\nDate 2021-2022 (day)", y = "PAR \n(mol m-2 s^-1)") +
   theme_graphs_env_cond())

(Yield_plot_21_22_X4 <- summer_21_22 %>% 
   ggplot(aes(Date_Combined, X4.Y..II.)) +
   geom_point()+  # Add points for the data
   geom_line()+  # Add a line that joins the points
   labs(x = "\nDate (day)", y = "Yield \n Lichen X3 ") +
   theme_graphs_env_cond() +
    theme(axis.text.x = element_blank(),
        axis.title.x = element_blank()))  # Remove axis label and text for the graph

(combined_plot_21_22_X4 <- (Yield_plot_21_22_X4/temp_plot_21_22_X4/PAR_plot_21_22_X4) & plot_layout(ncol = 1))
```


## 8. Plot data for the heatwave March 2022







